var AutoSuggest,sa_storage,__extends,EventKeyCodes,Bing,sa_inst;(function(n){var t;(function(n){var t,i,r,u,f,e;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={})),function(n){n.AutoSuggest="AS"}(i=n.CrumbNames||(n.CrumbNames={})),function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.BaseQuery="bq";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.ElTokenValue="elv";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang";n.ZeroInputSerp="zis";n.GhShown="ghsh";n.GhAccepted="ghacc";n.GhPrefixLength="ghpl";n.LonqQueryParam="lq";n.ParallelSuggestionCall="enpsc";n.ASCodeVersion="ascv";n.Csr="csr";n.AsCsrVersion="sm"}(r=n.QueryParams||(n.QueryParams={})),function(n){n.ImpressionGuid="X-MSEdge-IG"}(u=n.Headers||(n.Headers={})),function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"}(f=n.Options||(n.Options={})),function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.InstData="h";n.AriaLabel="aria-label";n.RequestGuid="rg";n.AdQuery="adq";n.GhostingText="ghtxt"}(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(n){var t;(function(n){function a(n){return n?n[n[i]!==undefined?i:f]:undefined}function u(n,t){n&&t!==null&&t!==undefined&&(n[n[i]!==undefined?i:f]=t)}function v(n){return _w.getComputedStyle?_w.getComputedStyle(n,null):n.currentStyle}function y(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)"),i=n.match(r);return i?i[1]:null}function p(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else{var r=n.createTextRange();r.moveEnd("sentence",-1e5);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}}function w(n,t){for(var r,i,u=0;i=t[u];++u)r=n.getAttribute(i),r&&(n[i]=r)}function b(n){var t=sj_ev(n);return{x:t.clientX,y:t.clientY}}function k(n,t){return function(i){var r=sj_ev(i),u=r.relatedTarget||(r.type=="mouseout"?r.toElement:r.fromElement);t===u||e(u,t)||n.call(t,r)}}function d(n,t){var i=0,r=_d.selection;if(n.selectionStart!=null)i=n.selectionStart;else if(r&&n.createTextRange){t&&n.focus();var u=n.createTextRange(),f=u.duplicate(),e=r.createRange();t&&u.moveToBookmark(e.getBookmark());f.setEndPoint("EndToStart",e);i=f.text.length}return i}function g(n,t){n&&(n.className=n.className.replace(t,""))}function nt(n,t){var u,i,r,f;if(n){for(u=n.className.split(" "),i=0,r=u;i<r.length;i++)if(f=r[i],f===t)return;n.className.length>0&&(n.className+=" ");n.className+=t}}function tt(n,t){return n?n.replace(c,function(n,i){return t[i]}):n}function it(n,t){var i=t.replace(/\s+$/g,"");return t[t.length-1]==" "&&n.length>0&&ot(t,i,n[0])?i:t}function e(n,t){if(!n||!t||t===n)return!1;while(n&&t!==n)n=n.parentElement;return t==n}function rt(n,t,i){var r=h.exec(t);if(!r||!r[1])throw new Error("Given text format doesn't contain link markup");u(i,r[1]);u(n,sa_loc.SearchRemoved);n.innerHTML=n.innerHTML.replace("%e"+i.innerHTML+"%E",et(i))}function ut(n,t,i,r){var u,f;return i===void 0&&(i=null),r===void 0&&(r=!1),u=_d.createElement("span"),u.textContent=t,u.style.visibility="hidden",i&&(u.style.fontSize=i),r&&(u.style.fontWeight="bold"),n.appendChild(u),f=u.offsetWidth,n.removeChild(u),f}function r(n,t,i){try{return n()}catch(r){return i&&i(),t}}function ft(n){return n?"Bearer ".concat(n):""}function et(n){var t=sj_ce("div");return t.appendChild(n),t.innerHTML}function ot(n,t,i){return n==i.substr(0,n.length)||t==i}function t(n){var t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function st(){var n=new Date,i=-n.getTimezoneOffset(),r=i>=0?"+":"-";return n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+"T"+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"."+t(n.getMilliseconds())+r+t(i/60)+":"+t(i%60)}function ht(t,i,r,u,f,e,s,h){var v,y,b,a,k,d,p,l,c,w,g;return!t||!i||!r?"":(b=encodeURIComponent(i),a={triggeringMode:"Explicit",intent:r},u&&(a.entityId=u),e&&(a.itemId=e),f&&(a.contentSource=f),k=JSON.stringify(a),d=encodeURIComponent(k),s=(v=s!==null&&s!==void 0?s:_G&&_G.IG)!==null&&v!==void 0?v:"",p=(y=_G&&_G.IG)!==null&&y!==void 0?y:"",c=t.bfbSearchUrl,p||(c=c===null||c===void 0?void 0:c.replace("&asig={3}","")),s||(c=c===null||c===void 0?void 0:c.replace("&cvid={4}","")),h&&(c=c===null||c===void 0?void 0:c.concat("&sc="+h+"-"+i.length)),l=n.formatString(c,[b,d,t.bfbfrmcde,p,s]),r==="External"&&f&&(l===null||l===void 0?void 0:l.indexOf("/work"))>-1&&(w=o(f),w&&(g="#Connectors-".concat(w),l=l+g)),l)}function ct(n){var t="/search";return n&&n.substr(0,t.length)===t?"/work"+n:n}function o(n){var t,e=undefined,i;try{if(s()&&(i=_w.sessionStorage.getItem("connectorsVerticalSettings"),i)){var r=JSON.parse(i),u=r===null||r===void 0?void 0:r.data,f=u===null||u===void 0?void 0:u.find(function(t){var i;if((i=t.Entities)!==null&&i!==void 0)return i.some(function(t){var i;if((i=t===null||t===void 0?void 0:t.ContentSources)!==null&&i!==void 0)return i.some(function(t){return(t===null||t===void 0?void 0:t.Id)&&(t===null||t===void 0?void 0:t.Id.toString().toLowerCase())==n.toLowerCase()})})});e=(t=f===null||f===void 0?void 0:f.Id)===null||t===void 0?void 0:t.toLowerCase()}}catch(o){}return e}function lt(n){return r(function(){return _w.localStorage?_w.localStorage.getItem(n):null},null)}function at(n,t,i){var u=new Date,f={value:t,expiry:i?i:u.getTime()+l};return r(function(){_w.localStorage?_w.localStorage.setItem(n,JSON.stringify(f)):null},null)}function vt(n){return r(function(){_w.localStorage?_w.localStorage.removeItem(n):null},null)}function yt(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function s(){return!!("sessionStorage"in _w&&_w.sessionStorage)}var i="textContent",f="innerText",h=/%e([^%]+)%E/,c=/{([0-9]+)}/g,l=6048e5;n.GetTextContent=a;n.SetTextContent=u;n.GetComputedStyle=v;n.GetQueryStringParam=y;n.SetSelectionRange=p;n.RewriteAttribsToProps=w;n.GetMouseCoords=b;n.MouseEnterLeave=k;n.getCursorPosition=d;n.RemoveClassName=g;n.AddClassName=nt;n.formatString=tt;n.TrimmedQueryFromSuggestions=it;n.isChildOf=e;n.SetTextContentWithLink=rt;n.CalcWidth=ut;n.safeExecute=r;n.getBearerTokenHeader=ft;n.getDateWithTimezone=st;n.buildBfbSearchUrl=ht;n.getMSBWorkVerticalSearchUrl=ct;n.getConnectorUrlSuffixFromStorage=o;n.getItem=lt;n.setItem=at;n.removeItem=vt;n.checkIfValidNumber=yt;n.isStorageSupported=s})(t=n.Utils||(n.Utils={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function n(){this._eventRegistry=[]}return n.prototype.registerEvents=function(n){this._eventRegistry.push(n)},n.prototype.raiseEvent=function(n){for(var i,r,f,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];for(i=0,r=this._eventRegistry;i<r.length;i++)f=r[i],f.raise(n,u)},n.prototype.clearEvents=function(){this._eventRegistry=[]},n}(),t;n.EventRegisterer=i;t=function(){function n(n){this._eventParent=n;this.events=[]}return n.prototype.add=function(n,t){this.events[n]=t},n.prototype.proxy=function(n){for(var i,r,e,u=this,f=[],t=1;t<arguments.length;t++)f[t-1]=arguments[t];for(i=0,r=f;i<r.length;i++)e=r[i],function(t){u.events[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.splice(0,0,t);n.apply(u._eventParent,r)}}(e)},n.prototype.raise=function(n,t){var i=this.events[n];i&&i.apply(this._eventParent,t)},n}();n.EventRegistration=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function n(){this.EventType="ClientInst";this._keystrokesInstrumentationData={}}return n.prototype.beginRequest=function(n){var t=this._keystrokesInstrumentationData[n];if(t)throw"Duplicate beginRequest for request sequence "+n;this._keystrokesInstrumentationData[n]={Layout:[],DataSources:{},ImpressionGuid:null,Rendered:!1,RequestBegin:sb_gt(),RequestEnd:{}}},n.prototype.updateRendered=function(n){var t=this._keystrokesInstrumentationData[n];t&&(t.Rendered=!0)},n.prototype.instrumentDataSource=function(n,i,r,u,f){var h=this._keystrokesInstrumentationData[r],o,s,c,e;if(h){for(o=[],s=0,c=i;s<c.length;s++)e=c[s],o.push({T:"D."+e.stype,K:e.instItem.getKValue(),Val:e.stype,AppNS:e.instItem.getAppNS(),E:"1"});h.DataSources[n]={T:"D.".concat(n,"Suggestions"),AppNS:t.DEFAULT_APP_NAMESPACE,SC:o.length,DS:o,State:f};u&&(h.DataSources[n].ExtraInfo=u)}else throw"No instrumentation found for request sequence "+r;},n.prototype.createMSBMasterImpression=function(){},n.prototype.finalizeKeystroke=function(n){var i=this._keystrokesInstrumentationData[n],r,u,e,f,o,s;if(i&&i.ImpressionGuid){Object.keys(i.DataSources).length>0&&(i.Rendered&&(r=_ge("sa_baw"),r&&typeof DsLManager!="undefined"&&(u=DsLManager.CreateLayoutNode(r,t.DEFAULT_APP_NAMESPACE,!0,!0,!1),u&&(i.Layout=u))),typeof Log2!="undefined"&&(e=Object.keys(i.DataSources).map(function(n){return i.DataSources[n]}),Log2.LogEvent(this.EventType,null,null,e,i.Layout,i.ImpressionGuid,null,null)));for(f in i.RequestEnd)o={l:i.RequestEnd[f]-i.RequestBegin},typeof Log2!="undefined"&&(s=f+"PerfInst",Log2.LogEvent(this.EventType,o,s,null,null,i.ImpressionGuid,null,null));delete this._keystrokesInstrumentationData[n]}},n.prototype.updateImpressionGuid=function(n,t){var i=this._keystrokesInstrumentationData[t];i&&(i.ImpressionGuid=n)},n.prototype.logASNetworkCallLatency=function(){var t=performance.getEntries(),i,n;if(typeof t!="undefined"&&t&&t.length>0)for(i=(t===null||t===void 0?void 0:t.length)-1;i>=0;i--)if(n=t[i],n.name.toString().indexOf("/AS/Suggestions")!=-1&&n.responseEnd!==0&&n.duration!==0)return"Latency="+(n.responseEnd-n.connectStart).toString().split(".")[0]+",Diff="+(n.responseEnd-n.responseStart).toString().split(".")[0];return""},n.prototype.instrumentResponseReceived=function(n,t,i){i===void 0&&(i=sb_gt());var r=this._keystrokesInstrumentationData[t];r&&(r.RequestEnd[n]=i)},n}(),t;n.WebClientInstrumentation=i;t=function(){function n(n){this._kValue=n}return n.createInstrumentedItem=function(t){return new n(n.generateKValue(t))},n.prototype.getKValue=function(){return this._kValue},n.prototype.getHValue=function(){return"ID="+n.DEFAULT_APP_NAMESPACE+","+this._kValue+".1"},n.prototype.getAppNS=function(){return n.DEFAULT_APP_NAMESPACE},n.generateKValue=function(n){var i=n,t=this._keystrokesKValues[i];return t>0||(t=1e3),this._keystrokesKValues[i]=++t,t},n.DEFAULT_APP_NAMESPACE="autosuggest",n._keystrokesKValues={},n}();n.InstrumentedItem=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createMSBMasterImpression=function(n){var t=this._keystrokesInstrumentationData[n],i;t&&(t.ImpressionGuid=this.generateGuid(),i={pageName:"Page.Work.AS.Suggestion",rawQuery:"",isQuery:!1,form:null,impressionUrl:_w.location.origin+_w.location.pathname,impressionGuid:t.ImpressionGuid,appName:"autosuggest",dataSources:[],layoutNodes:[],enrichedClientInfo:{FDPartnerEntry:"autosuggest"}},Log2.LogMasterPageImpression(i))},t.prototype.generateGuid=function(){var n="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});return n.toLocaleUpperCase()},t}(n.WebClientInstrumentation);n.MSBWebClientInstrumentation=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(n){this.config=n}return t.prototype.parse=function(t,i,r,u){var l=[],a,e,c,v,h,y;if(!i){u(l,a);return}try{e=JSON.parse(i)}catch(p){_w.onerror&&_w.onerror(p.toString(),null,null)}if(e&&e.results)for(e.debug&&e.debug.traceId&&(a={TraceId:e.debug.traceId}),c=0,v=e.results;c<v.length;c++){var f=v[c],o=void 0,s=void 0;switch(f.domain){case"Person":h=f;h&&h.identifiers&&h.identifiers.uniqueName&&(o=n.Utils.buildBfbSearchUrl(this.config,h.query,"Person",h.identifiers.uniqueName),s=2);break;case"Bookmark":o=n.Utils.buildBfbSearchUrl(this.config,f.query,"Bookmark");s=1;break;case"Qna":o=n.Utils.buildBfbSearchUrl(this.config,f.query,"Qna");s=3;break;case"Building":o=n.Utils.buildBfbSearchUrl(this.config,f.query,"Building");s=4}o&&s&&(y={query:f.query,url:o,stype:f.domain,instItem:n.InstrumentedItem.createInstrumentedItem(r),id:f.id,annotation:f.title,icon:s},l.push(y))}u(l,a)},t}();n.BingAtWorkSuggestionsParserV3=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t=function(){function n(n,t){this.ariaLogger=null;this.ariaConfig={source:t};this.sharedConfig=n;this.ariaLogger=this.tryCreateAriaLogger(n);this.ariaContext={};this.initPerf();this.qfLogger=_w.QfLogger}return n.prototype.getConversationId=function(){return this.conversationId},n.prototype.is3sQfLoggerExists=function(){return this.qfLogger&&this.qfLogger.logger?!0:!1},n.prototype.setContext=function(n){this.ariaContext.tenantId=this.ariaContext.tenantId||n.tenantId;this.ariaContext.traceId=this.ariaContext.traceId||n.traceId},n.prototype.logShown=function(n,t){n!=null&&(t=t||{},t.T=String(n),t.hasOwnProperty("eventId")||(t.eventId="AutoSuggest_Impression"));this.log("Shown_Events",61,t)},n.prototype.logClicked=function(n,t){n!=null&&(t=t||{},t.T=String(n),t.hasOwnProperty("eventId")||(t.eventId="AutoSuggest_Click"));this.log("Clicked_Events",61,t)},n.prototype.logPerf=function(n){var i,t,r;this.isPerfAvl&&(i=this.getPerfEntries(n),i&&i.length&&(t=i[i.length-1],this.lastFetch!=t.fetchStart&&(r={N:t.name,P:t.name,ET:t.entryType,IT:t.initiatorType,FETCH_S:t.fetchStart,REQ_S:t.requestStart,RES_S:t.responseStart,RES_E:t.responseEnd,D:t.duration,TSZ:t.transferSize},this.log("Perf_Events",61,r),this.lastFetch=t.fetchStart)))},n.prototype.createQfLoggerContext=function(){var n;return this.is3sQfLoggerExists()?(n=this.qfLogger)===null||n===void 0?void 0:n.CreateQFLoggerContext():undefined},n.prototype.createAndUpdateConversationId=function(){var n,t;return this.conversationId=((n=this.qfLogger)===null||n===void 0?void 0:n.CreateAndUpdateConversationId)?(t=this.qfLogger)===null||t===void 0?void 0:t.CreateAndUpdateConversationId():"",this.conversationId},n.prototype.log3sRenderedEvent=function(n,t){var i;if(this.is3sQfLoggerExists())try{(i=this.qfLogger)===null||i===void 0?void 0:i.LogQfRenderedAndClientLayout(n,t)}catch(r){_w.dbg&&{}}},n.prototype.log3SClickedEvent=function(n,t,i,r,u){var f,e;if(this.is3sQfLoggerExists())try{this.conversationId&&n!=="SearchBox_Focus"&&!this.sharedConfig.bingAtWorkSessionCvid&&(BingAtWork===null||BingAtWork===void 0?void 0:BingAtWork.writeConversationId(this.conversationId));t?(f=this.qfLogger)===null||f===void 0?void 0:f.LogActionClicked(n,t,i,r,u):(e=this.qfLogger)===null||e===void 0?void 0:e.LogActionClicked(n)}catch(o){_w.dbg&&{}}},n.prototype.getPerfEntries=function(n){var t=n&&this.perfRegxs&&this.perfRegxs[n]?this.perfRegxs[n]:this.perfRegexp;return t?performance.getEntries().filter(function(n){return n.name.match(t)}):null},n.prototype.initPerfPattern=function(n){var t,i;if(n){this.perfRegxs={};for(t in n)i=n[t],this.perfRegxs[t]=new RegExp(i)}},n.prototype.initPerf=function(){performance&&performance.getEntries?(this.isPerfAvl=!0,this.sharedConfig.msShTlPfPt?this.initPerfPattern(this.sharedConfig.msShTlPfPt):this.perfRegexp=new RegExp(this.sharedConfig.bingAtWorkUrl)):_w.dbg&&{}},n.prototype.log=function(n,t,i){var r,f,e,o;if(this.ariaLogger||(this.ariaLogger=this.tryCreateAriaLogger(this.sharedConfig)),this.ariaLogger){var s=_G.IG,h=_G.Mkt,u={eventType:"Client_Events",name:n,properties:{SC:{value:t},S:{value:this.ariaConfig.source||""},IG:{value:s||""},MKT:{value:h||""},TNID:{value:this.ariaContext.tenantId||""},TID:{value:this.ariaContext.traceId||""},dataCenter:{value:this.sharedConfig.bfbAriaDataCenter||""},clientType:{value:this.sharedConfig.msbClient||""},ENV:{value:this.sharedConfig.msbEnvironment||""},canvas:{value:this.sharedConfig.msbCanvas||""},isSnr:{value:!0},conversationId:{value:this.conversationId?this.conversationId:""}}};if(i)for(r=0,f=Object.getOwnPropertyNames(i);r<f.length;r++)e=f[r],o=i[e],u.properties[e]={value:o!=null?o:""};this.ariaLogger.logEvent(u);_w.dbg&&{}}},n.prototype.tryCreateAriaLogger=function(n){try{return AriaTelemetry.getLogger(n.bawAriaTenantToken)}catch(t){return _w.dbg&&{},null}},n.prototype.getLogicalId=function(n){if(n)return n;var t="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)});return _G.LogicalId=t.toLocaleUpperCase()},n}();n.BingAtWorkWebTelemetry=t}(AutoSuggest||(AutoSuggest={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var r,h,c,s;(function(n){n.Web="Web";n.BingAtWork="BAW";n.Substrate="SSUE";n.MicrosoftSearchInBing="MSB";n.MicrosoftSearchInBingCached="MSBC";n.MSBEngagment="MSBE";n.RichRequery="RR";n.SubstrateSuggestionsForEnterprise="SSUE"})(r=t.DataSources||(t.DataSources={})),function(n){n.RelatedSearch="RS";n.PeopleAlsoAsk="PAA";n.PeopleAlsoSearchFor="PASF";n.PeopleAlsoSearchForExploreMore="PASFEM";n.TrendingNowOnRight="TRR"}(h=t.SearchTypeUtils||(t.SearchTypeUtils={})),function(n){n.Bookmarks="Bookmarks";n.People="People"}(c=t.BingAtWorkDataTypes||(t.BingAtWorkDataTypes={}));t.suggestionParentClass="sa_prnt";t.ZisRankableBanners=["BC","TR","SH","SP"];var i=AutoSuggest.Service.QueryParams,e="ajax.unload",l="msb:qf:rdy",u="NONPROM",f="PROM",o=[i.SuggestionPosition,i.Ghosting,i.LonqQueryParam,i.AsCsrVersion],a=o.concat([i.PartialQuery,i.SuggestionCount,i.SuggestionType,i.SkipValue,i.ConversationId,i.GhShown,i.GhAccepted,i.GhPrefixLength,i.LonqQueryParam]);t.searchBoxFocusEventId="SearchBox_Focus";t.msbVerticalClient="BingVertical";s=function(s){function h(n,t,i,r,u,f,e,o,h,c,l,a){var v=s.call(this)||this;return v.canvas=n,v._dataProvider=t,v._bingAtWorkDataProvider=i,v._substrateDataProvider=r,v._msbDataProvider=u,v._msbEngagementDataProvider=f,v._instrumentation=e,v._bingAtWorkSuggestionsParser=o,v._substrateSuggestionsParser=h,v._msbSuggestionsParser=c,v._bingAtWorkWebTelemetry=l,v.internalEventTrigger=a,v.hasPrefixQueryBeenUpdated=!1,v.currentQuery="",v.pscQuery="",v.data={},v.ghostInstValue=0,v.networkLatencyInfo="",v.ghostingShown=0,v.ghostingAccepted=0,v.ghostingPrefixLength="",v.isLongQuery=!1,v.preactComponentsLoaded=!1,v._cursorPosition=0,v._queryWithCurrentSuggestions="",v._receivedAtLeastOnceValidResponse=!1,v._isDisposed=!1,v._requestSequence=-1,v._isBawPayloadAdded=!1,v._originalQuery="",v._previousLocationCache=null,v._emptyWebSuggestionsResponse="<span><\/span>",v.msbNtpKeyStrokeMaxRetry=0,v._cacheZisEarly=!1,v.isMsbCachingBundleReady=!1,v}return __extends(h,s),h.prototype.init=function(n,i,r){var u=this,s,c,l,a,v,e,y,w,b,f,k,d,g,o,p;for(this._originalQuery=r.value,this.config=n,this._container=i,this.registerAjaxSerpUnloadEvent(),this.previousQuery=r===null||r===void 0?void 0:r.value,e=0,y=h.ScopeExtensions;e<y.length;e++)w=y[e],w.init(this);h.ScopeExtensions=[];b=function(t,i,r,f,e,o,s,h){return u.dataProviderCallbackFunc(t,i,r,f,e,n.msbClient,s,h)};this._dataProvider.init(n,n.u,b);this.canvas.init(this,n,i,r);f=new t.EventRegistration(this);f.proxy(this.raiseEvent,10,12,11);this._bingAtWorkDataProvider&&(k=function(n,t,i,r,f,e){return u.onBingAtWorkResponseReceived(n,t,i,e)},this._bingAtWorkDataProvider.init(n,this.config.bingAtWorkUrl,k));this._substrateDataProvider&&(d=function(n,t,i){return u.onSubstrateResponseReceived(n,t,i)},this._substrateDataProvider.init(n,"",d));this._msbDataProvider&&(o=function(t,i,r,f,e,o,s){return u.onSearchBoxFocusWithRetry(1,r,function(){return u.onMsbResponseReceived(t,i,r,f,e,o,s,n.msbClient)})},g=function(n,t,i,r,f,e,o){return u.onMsbResponseReceived(n,t,i,r,f,e,o)},this._msbDataProvider.init(o,this._bingAtWorkWebTelemetry,g));this._msbEngagementDataProvider&&(o=function(n,t){return u.onSearchBoxFocusWithRetry(1,t,function(){return u.onMsbEngagementResponseReceived(n,t)})},this._msbEngagementDataProvider.init(o));f.add(4,function(n,t,i){u.raiseEvent(4,n,t,i)});f.add(20,function(n,t){t.className.indexOf("as_qb")!=-1&&(u.raiseEvent(13,n.query+" ",!1),_w.Log&&Log.Log&&Log.Log("Select","QueryBuilder","Click",!1,"ImpressionGuid",u.data.Inst.IG))});f.add(25,function(n){u.raiseEvent(13,n.query+" ",!1);_w.Log&&Log.Log&&Log.Log("Select","MobileNextWordSuggestion","Click",!1,"ImpressionGuid",u.data.Inst.IG)});this.canvas.registerEvents(f);this.raiseEvent(6,this);n.isEdgeNtp&&this.isMsbEnabled(n.enabledDataSources)&&(this.msbNtpKeyStrokeMaxRetry=n.msbKsTnsTryMax||0,this.raiseEvent(21));(n.msbqc||this.config.isNtpClientqfEnabled)&&this.initMsbQfCaching();this.internalEventTrigger&&(p=new t.EventRegistration(this),p.add(33,function(n){u.raiseEvent(13,n+" ",!1);_w.Log&&Log.Log&&Log.Log("Select","QueryBuilder","Click",!1,"ImpressionGuid",u.data.Inst.IG)}),this.internalEventTrigger.registerEvents(p));performance&&performance.getEntries&&this.LogPerformanceTiming(["AutosuggestBootstrapLoaded","AutosuggestJSBundleLoaded"]);((c=(s=window.BingAtWork)===null||s===void 0?void 0:s.context)===null||c===void 0?void 0:c.isSharedSerpWorkBundlesEnabled)&&((a=(l=window.BingAtWork)===null||l===void 0?void 0:l.context)===null||a===void 0?void 0:a.isOnWorkVertical)&&((v=window.BingAtWork)===null||v===void 0?void 0:v.initAutoSuggest())},h.prototype.initMsbQfCaching=function(){for(var i=this,t=!1,n=0;n<this.config.enabledDataSources.length;++n)if(this.config.enabledDataSources[n]===r.MicrosoftSearchInBing){this.config.enabledDataSources.splice(n,null,r.MicrosoftSearchInBingCached);t=!0;break}t||this.config.enabledDataSources.push(r.MicrosoftSearchInBingCached);sj_evt.bind(l,function(){return i.isMsbCachingBundleReady=!0},!0)},h.prototype.isMsbEnabled=function(n){var i,t,u,f;if(!n)return!1;for(i=!1,t=0,u=n;t<u.length;t++)if(f=u[t],f===r.BingAtWork||f===r.MicrosoftSearchInBing){i=!0;break}return i},h.prototype.raiseGhostingEventFired=function(n,t){this.raiseEvent(31,n,t)},h.prototype.raiseGhostedTextLength=function(n,t){this.raiseEvent(26,n,t)},h.prototype.raiseGhostingAccepted=function(n,t,i){this.raiseEvent(27,n,t,i)},h.prototype.raiseUpdateGhostedText=function(n,t,i,r){this.raiseEvent(14,n,t,i,r)},h.prototype.raiseUpdateTextAndRequery=function(n,t){this.raiseEvent(13,n,t)},h.prototype.raiseUpdateText=function(n,t){t===void 0&&(t=!0);this.raiseEvent(12,n,t)},h.prototype.raiseTextChanged=function(n,t){this.raiseEvent(18,n,t)},h.prototype.onBfbNavigateCallback=function(n,t,i,r,e,o){if(this._bingAtWorkWebTelemetry){var s={LogicalId:_G.LogicalId?_G.LogicalId:"",N:r?r.length:0,QTYP:t,TT:i?f:u,eventId:"QueryFormulation_Click"};this._bingAtWorkWebTelemetry.logClicked(n,s);this._bingAtWorkWebTelemetry.log3SClickedEvent("QueryFormulation_Click",e,t,o,n)}},h.prototype.onHighConfidencePromoted=function(n){if(this._bingAtWorkWebTelemetry&&this.config.enableQfHcLog){var t=this._bingAtWorkWebTelemetry.getLogicalId(),i={LogicalId:t,N:this.currentQuery.length,TT:n?f:u,eventId:"QueryFormulation_HighConfidence_Impression"};this._bingAtWorkWebTelemetry.logShown("",i)}},h.prototype.onBfbSearchBoxAction=function(n){this._bingAtWorkWebTelemetry&&(n===t.searchBoxFocusEventId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId&&this._bingAtWorkWebTelemetry.createAndUpdateConversationId(),this._bingAtWorkWebTelemetry.log3SClickedEvent&&this._bingAtWorkWebTelemetry.log3SClickedEvent(n))},h.prototype.onSubstrateNavigateCallback=function(n){this._substrateDataProvider&&this._substrateDataProvider.instrumentClick(n)},h.prototype.setData=function(n){this.data=n},h.prototype.dataProviderCallbackFunc=function(i,u,f,e,o,s,h,c){var p,w,a,v,b,k,y,l,d;(this._previousLocationCache=o||this._previousLocationCache,!this._isDisposed&&(this.canvas.searchBoxHasFocus()||this.config.mnw))&&(this._cacheZisEarly||(t.CachedResponseUtils&&t.CachedResponseUtils.checkCachedResponseAndLog&&(i=t.CachedResponseUtils.checkCachedResponseAndLog(i,e)),s!==t.msbVerticalClient&&this.raiseEvent(8),i!=null&&(this.config.aspsc&&e.indexOf("enpsc=1")!==-1?sj_evt.fire("AS.PSCResponseRecieved",i,this.currentQuery,u,f!=this.currentQuery):(this.raiseEvent(9,f,u,r.Web,h),this._queryWithCurrentSuggestions=f,this.config.ascsr?sj_evt.fire("AS.ResponseRecieved",i,this.currentQuery,u,f!=this.currentQuery):this.canvas.render(i,this.currentQuery,u,r.Web,f!=this.currentQuery),this._receivedAtLeastOnceValidResponse=!0,this.config.enbleClientPerfTelemetry&&this._instrumentation&&this._instrumentation.logASNetworkCallLatency&&typeof performance!="undefined"&&performance&&performance.getEntries&&(p=this._instrumentation.logASNetworkCallLatency(),p!==""&&this.appendLatency(p)),w=_ge("sa_msbblockheader"),a=_ge("sa_msbblockheaderwithtenantname"),a&&w&&(v=w,b=n.AS.BingAtWorkTemplateManager.getTenantDisplayName(),b&&(k=a.innerHTML.replace("{0}",b),k.length<=70&&(v=a,v.innerHTML=k)),v.style.display="block",y=_ge("as_msbblkhdrnew"),l=n.AS.BingAtWorkTemplateManager.getTenantThemeColors(),l&&l.length>2&&(y===null||y===void 0?void 0:y.setAttribute("style","background-color : #"+l[1]+"; color : #"+l[2]+";"))),this._instrumentation&&(d=this.data&&this.data.Inst?this.data.Inst.IG:null,this._instrumentation.updateImpressionGuid(d,u)),c&&_w.Log&&Log.Log&&Log.Log("PrefetchCache","AS","PerfInst",!1)))))},h.prototype.onSubstrateResponseReceived=function(n,i,u){var f=this,e,o;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&i<this._requestSequence||(e=sb_gt(),o=function(n,o){var s=t.BingAtWorkTemplateManager.generateHtml(f.config,n,u);n.length&&(f._instrumentation.instrumentResponseReceived(r.Substrate,i,e),f._bingAtWorkWebTelemetry&&f._bingAtWorkWebTelemetry.logPerf("SSUESuggestions"));f._instrumentation.instrumentDataSource(r.Substrate,n,i,o);f.config.msbSusR&&(f._substrateDataProvider.updateTraceId(o.TraceID),f.canvas.render(s,f.currentQuery,i,r.Substrate),s&&(f._instrumentation.updateRendered(i),f._bingAtWorkWebTelemetry&&(f._bingAtWorkWebTelemetry.setContext({traceId:o.TraceID,tenantId:f.config.bawTenantId,uid:f.config.bawUserId}),n.forEach(function(n){f._bingAtWorkWebTelemetry.logShown(n.id)}))))},this._substrateSuggestionsParser.parse(u,n,i,o)))},h.prototype.onMsbEngagementResponseReceived=function(n,i){if(!this._isDisposed&&this.canvas.searchBoxHasFocus()&&i==this.currentQuery&&(!this.config.handleDuplicateFetch||!(n<this._requestSequence))&&!this.config.disableBAWZISSuggestions){var u=t.BingAtWorkTemplateManager.generateMSBEngagementHtml(this.config,i,this.config.msbengagementformcode);u&&this.canvas.render(u,this.currentQuery,n,r.MSBEngagment)}},h.prototype.onMsbResponseReceived=function(n,i,e,o,s,h,c,l){var a=this,y;if((l===t.msbVerticalClient&&o&&this.raiseEvent(8),!this._isDisposed&&this.canvas.searchBoxHasFocus()&&e==this.currentQuery)&&(!this.config.handleDuplicateFetch||!(i<this._requestSequence))){var p=sb_gt(),v=o?r.MicrosoftSearchInBingCached:r.MicrosoftSearchInBing,w=function(n,r,h){var l,k,w,y,b,d,g;if(n&&n.length&&a._instrumentation.instrumentResponseReceived(v,i,p),a._instrumentation.instrumentDataSource(v,n,i,r,c),!(a.config.ascsr&&a.config.enableCSRForBAW)&&(l=void 0,l=a.config.promoteUserHistoryForAADUser&&v==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(a.config,n,e,a.config.isMsbInline,h===null||h===void 0?void 0:h.LogicalId):a.config.webMsbQFRanking&&v==="MSBC"?t.BingAtWorkTemplateManager.generateMsbHtml(a.config,n,e,a.config.isMsbInline,h===null||h===void 0?void 0:h.LogicalId):t.BingAtWorkTemplateManager.generateHtml(a.config,n,e,a.config.isMsbInline),a.canvas.render(l,a.currentQuery,i,v),l&&(a.config.isEdgeNtp||(a.config.zisHistoryAfterPn&&n!==undefined&&(n===null||n===void 0?void 0:n.length)>=0&&a.raiseEvent(34,e,n.length,i),a._instrumentation.updateRendered(i)),a._bingAtWorkWebTelemetry))){if(a._bingAtWorkWebTelemetry.setContext({traceId:r?r.TraceID:"",tenantId:a.config.bawTenantId,uid:a.config.bawUserId}),s=s||a._bingAtWorkWebTelemetry.getLogicalId(),k=JSON.stringify(n.map(function(n){return n.stype})),w={LogicalId:s,N:a.currentQuery.length,QTYP:k,TT:u,QTYPE:a.currentQuery.length==0?"zqf":o?"cache":"backfill"},a.config.isLowConfidenceWeb)for(y=0,b=n;y<b.length;y++)if(d=b[y],d.confidence=="High"){w.TT=f;break}g=JSON.stringify(n.map(function(n){return n.id}));a._bingAtWorkWebTelemetry.logShown(g,w);a._bingAtWorkWebTelemetry.log3sRenderedEvent(h,n)}};(y=this._msbSuggestionsParser)===null||y===void 0?void 0:y.parse(n,i,w,h,this.currentQuery,e!=this.currentQuery)}},h.prototype.onBingAtWorkResponseReceived=function(n,i,u,f){var e=this,o,s;!this._isDisposed&&this.canvas.searchBoxHasFocus()&&u==this.currentQuery&&(this.config.handleDuplicateFetch&&i<this._requestSequence||(o=sb_gt(),this.config.isEdgeNtp&&(this.raiseEvent(8),f==401&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))),s=function(n,f){var s=t.BingAtWorkTemplateManager.generateHtml(e.config,n,u,e.config.isMsbInline);n.length&&(e.config.isEdgeNtp?e.raiseEvent(9,u,i,r.BingAtWork):(e._instrumentation&&e._instrumentation.instrumentResponseReceived(r.BingAtWork,i,o),e._bingAtWorkWebTelemetry&&e._bingAtWorkWebTelemetry.logPerf("BAWSuggestions")));e._instrumentation&&e._instrumentation.instrumentDataSource(r.BingAtWork,n,i,f);e.canvas.render(s,e.currentQuery,i,r.BingAtWork);s&&(!e.config.isEdgeNtp&&e._instrumentation&&e._instrumentation.updateRendered(i),e._bingAtWorkWebTelemetry&&(e._bingAtWorkWebTelemetry.setContext({traceId:f.TraceID,tenantId:e.config.bawTenantId}),n.forEach(function(n){e._bingAtWorkWebTelemetry.logShown(n.id)})))},this._bingAtWorkSuggestionsParser.parse(u,n,i,s)))},h.prototype.getAllSuggestionInstUrl=function(n,t){for(var u,f,o=this.getInstrumentationKeys(t),i=[],r=0,e=o;r<e.length;r++)u=e[r],f=this.getSuggestionInstValue(u,!0,n),f!==null&&(i=i.concat(["&",u,"=",f]));return i.join("")},h.prototype.getAllSuggestionInstObject=function(n,t,i){var s,f,r,e,u,o;for(i===void 0&&(i=null),s=this.getInstrumentationKeys(t),f={},r=0,e=s;r<e.length;r++)(u=e[r],o=this.getSuggestionInstValue(u,!1,n),this.config.longquery&&this.isLongQuery&&u==="pq"&&i!==null&&i.length>500)||o!==null&&(f[u]=o);return f},h.prototype.getInstrumentationKeys=function(n){return n?a:o},h.prototype.getSuggestionInstValue=function(n,t,r){var u;r=r||this.canvas.selectedSuggestion;switch(n){case i.SuggestionCount:return this.canvas.currentSuggestionList.length+"-"+this._queryWithCurrentSuggestions.length;case i.PartialQuery:return t?encodeURIComponent(this._queryWithCurrentSuggestions):this._queryWithCurrentSuggestions;case i.SuggestionPosition:return this.config.ascsr?this.canvas.selectedSuggestion?((u=this.canvas.selectedSuggestion)===null||u===void 0?void 0:u.originalIndex)+1+"":"-1":(this.config.mnw&&r&&r.ord>this.canvas.mnwSuggestionsCount&&(r.ord=r.ord-this.canvas.mnwSuggestionsCount),r?""+r.ord:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionPosition.toString():"-1");case i.SuggestionType:return r?r.src:this.config.mnw&&this.isMNWSuggestionSelected(this.canvas.clickedMNWSuggestionType)?this.canvas.clickedMNWSuggestionType:"n";case i.SkipValue:return r&&r.sk?r.sk:"";case i.Ghosting:return this.ghostInstValue==0?null:this.ghostInstValue.toString();case i.ConversationId:return _G.IG;case i.GhShown:return this.ghostingShown.toString();case i.GhAccepted:return this.ghostingAccepted.toString();case i.GhPrefixLength:return this.ghostingPrefixLength;case i.LonqQueryParam:return this.isLongQuery?"1":"0";case i.AsCsrVersion:return this.config.sm?this.config.sm:null;default:return null}},h.prototype.isMNWSuggestionSelected=function(n){return n=="MNW"||n=="MNWU"||n=="MNWB"||n=="MNWT"||n=="MNWF"?!0:!1},h.prototype.setCursorPosition=function(n){this._cursorPosition=n},h.prototype.getCurrentCursorPosition=function(){return this._cursorPosition},h.prototype.finalizeKeystroke=function(){this._instrumentation&&this._requestSequence>-1&&(this.config.msbClient==t.msbVerticalClient&&this._instrumentation.createMSBMasterImpression(this._requestSequence),this._instrumentation.finalizeKeystroke(this._requestSequence))},h.prototype.fetch=function(n){if(this.finalizeKeystroke(),this._requestSequence++,this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence),this.fetchWeb(n,this._requestSequence,!1),this.config.msbqc&&this.isMsbCachingBundleReady||this.config.isNtpClientqfEnabled)this.fetchMsb(n,this._requestSequence);else if(this.config.msbqc){if(this.config.msbqc&&this.config.bawUserId&&this._msbDataProvider&&!this.isMsbCachingBundleReady)this.onMsbResponseReceived([],this._requestSequence,n,!0,"",null,"CS")}else this.fetchBingAtWork(n,this._requestSequence);this.config.msbSusE&&this.fetchSubstrate(n,this._requestSequence);var t=n&&n.length;this._msbEngagementDataProvider&&t>=this.config.MSBMinQueryLengthForEngagementQF&&this._msbEngagementDataProvider.show(n,this._requestSequence)},h.prototype.fetchZeroQF=function(){if(this.config.enableZeroQfWork)if(this.finalizeKeystroke(),this._requestSequence++,this._instrumentation&&this._instrumentation.beginRequest(this._requestSequence),this.fetchWeb("",this._requestSequence,!1),this.config.msbqc&&this.isMsbCachingBundleReady||this.config.isNtpClientqfEnabled)this.fetchZeroQf(this._requestSequence);else if(this.config.msbqc&&this.config.bawUserId&&this._msbDataProvider&&!this.isMsbCachingBundleReady)this.onMsbResponseReceived([],this._requestSequence,"",!1,"",null,"ZCS")},h.prototype.fetchSubstrate=function(n,i){if(this._substrateDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName&&this._substrateDataProvider.fetch(n,i,!1)}},h.prototype.fetchBingAtWork=function(n,i){if(this._bingAtWorkDataProvider&&this.currentQuery.length>=this.config.bawminqlen){var r=t.BingAtWorkTemplateManager.getTenantConfig(this.config);r&&r.displayName?(this.addBawPayload(n),this._bingAtWorkDataProvider.fetch(n,i,!1)):this.config.isEdgeNtp&&this.msbNtpKeyStrokeMaxRetry>0&&(this.msbNtpKeyStrokeMaxRetry--,this.raiseEvent(21))}},h.prototype.fetchMsb=function(n,i){var r,u,e,f;((r=this._bingAtWorkWebTelemetry)===null||r===void 0?void 0:r.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()&&(e=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery.length>=this.config.bawminqlen&&(f=t.BingAtWorkTemplateManager.getTenantConfig(this.config),f&&f.displayName&&(((u=this._bingAtWorkWebTelemetry)===null||u===void 0?void 0:u.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()?this._msbDataProvider.fetch(n,i,e):this._msbDataProvider.fetch(n,i)))},h.prototype.fetchZeroQf=function(n){var t,i,r;((t=this._bingAtWorkWebTelemetry)===null||t===void 0?void 0:t.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()&&(r=this._bingAtWorkWebTelemetry.createQfLoggerContext());this._msbDataProvider&&this.currentQuery==""&&(((i=this._bingAtWorkWebTelemetry)===null||i===void 0?void 0:i.is3sQfLoggerExists)&&this._bingAtWorkWebTelemetry.is3sQfLoggerExists()?this._msbDataProvider.fetchZeroQF(n,r):this._msbDataProvider.fetchZeroQF(n))},h.prototype.addBawPayload=function(n){var r=this.config.bawmax,t,i;this._isBawPayloadAdded?this._bingAtWorkDataProvider.addPostValue("Query",n):(t=["Bookmark","Qna","Building"],this.config.msbSusR||t.push("Person"),i={count:r,domains:t,query:n,conversationId:_G.IG},this._bingAtWorkDataProvider.addBody(i))},h.prototype.onSearchBoxFocusWithRetry=function(n,t,i,r){var u=this;if(t!==this.currentQuery){r&&r();return}this.canvas.searchBoxHasFocus()?i():n<5&&sb_st(function(){u.onSearchBoxFocusWithRetry(n+1,t,i,r)},15)},h.prototype.fetchWeb=function(n,u,f,e){var o,s,h;if(e===void 0&&(e=!1),this.config.msbnocons&&this._receivedAtLeastOnceValidResponse)this.canvas.render(this._emptyWebSuggestionsResponse,this.currentQuery,u,r.Web);else{if(this._dataProvider.addParam(i.CursorPosition,this._cursorPosition.toString()),this._container!=null&&this._container.parentNode!=null&&(o=this._container.parentNode.offsetWidth.toString(),this.config.cors?this._dataProvider.addParam("contentWidth",o):this._dataProvider.addHeader("X-Autosuggest-ContentWidth",o)),_ge("sidebar_search_experience")&&this._dataProvider.addHeader("X-SIDEBAR-SEARCH","true"),_w.localStorage!==null&&_w.localStorage!==undefined&&t.Utils.setItem("asUsed",1),this._receivedAtLeastOnceValidResponse&&(!this.config.aszisear||n!=="")||this.config.ascssdis||this.config.ascsr||this._dataProvider.addParam(i.Css,"1"),this.config.ascsr&&this._dataProvider.addParam(i.Csr,"1"),this.config.sm&&this._dataProvider.addParam(i.AsCsrVersion,this.config.sm),n===""&&this.config.zisr1>0&&(s=this.checkSuggestionTypeForRanking(),s!=""&&this._dataProvider.addParam("zisBD",s)),!this.config.ascsr&&(this.config.ezis&&this._originalQuery===n&&this._requestSequence==0||this.config.aszisear&&n==="")&&this._dataProvider.addParam(i.ZeroInputSerp,"1"),this.config.ascsr&&this.config.ezis&&this._originalQuery===n&&this._dataProvider.addParam(i.ZeroInputSerp,"1"),this.config.pc&&this._dataProvider.addParam("pubcode",this.config.pc),this.config.enableBaseQInLocalStorage&&_w.localStorage!==null&&_w.localStorage!==undefined&&this.config!==null&&this.config.u!==null&&this.config.u.indexOf("%26bq%3d")===-1&&this._dataProvider.addParam("bq",_w.localStorage.getItem("baseq")),this.config.footnote&&this._dataProvider.addParam("footnote","1"),this.config.longquery&&this.isLongQuery&&this._dataProvider.addParam("lq","1"),this.config.adcached&&this._adCachedQuery&&this._adCachedImpressionGuid&&(this._dataProvider.addParam("adq",this._adCachedQuery),this._dataProvider.addParam("adig",this._adCachedImpressionGuid)),this.config.pcov&&(h=this.getPartnerCodeOverride(),h&&this._dataProvider.addParam("pc",h)),(this.config.ascsr&&!this.config.enableCSRForBAW||this._msbDataProvider==null&&this._bingAtWorkDataProvider==null)&&this._dataProvider.addParam("msbqf","false"),this.config.IsBingPrivate&&!this.config.cors&&this._dataProvider.addHeader("preferAnonymous","1"),this.config.enableRequeryParam&&!this.hasPrefixQueryBeenUpdated&&this._dataProvider.addParam("rqry","1"),this.config.isPathSearch&&this._dataProvider.addParam("pths","1"),this.config.aspsc&&e){this._dataProvider.addParam(i.ParallelSuggestionCall,"1");this._dataProvider.fetch(n,u,!0);sj_evt.fire("AS.PSCRequestSent",this.currentQuery);return}this.config.ascsr&&this.attemptLoadingCsrBundles();this.config.asprefre||this.config.asprefrev2?(this.raiseEvent(7,this.currentQuery,u),this._dataProvider.fetch(n,u,!0)):(this._dataProvider.fetch(n,u,!0),this.raiseEvent(7,this.currentQuery,u));f||sj_evt.fire("AS.RequestSent",this.currentQuery)}},h.prototype.registerAjaxSerpUnloadEvent=function(){var n=this,t=function(i){var r=i&&i[1];r&&r.isInstantRequest||(n._isDisposed=!0,sj_evt.unbind(e,t),n.raiseEvent(17),n.clearEvents())};sj_evt.bind(e,t,!1)},h.prototype.getPartnerCodeOverride=function(){var n,t=(n=_ge(this.config.f))===null||n===void 0?void 0:n.querySelector("[name='pc']"),r=t&&t.value,u=_d.location.href.indexOf("ntp.msn.com/edge/ntp")>=0||_d.location.href.indexOf("ntp.msn.cn/edge/ntp")>=0,i;return!r&&u&&(i="U531"),i},h.prototype.setRawQuery=function(n){this.canvas.updateRawQuery(n)},h.prototype.setPSCQuery=function(n){this.pscQuery=n;this.fetchWeb(n,this._requestSequence,!1,!0)},h.prototype.setQuery=function(n){if(this._cacheZisEarly=!1,this.config.enableRequeryParam&&n!==undefined&&(this.previousQuery=this.currentQuery!==""?this.currentQuery:this.previousQuery),this.currentQuery=n,this.config.enableRequeryParam&&n!==undefined&&(this.hasPrefixQueryBeenUpdated=this.previousQuery==""||this.hasPrefixQueryBeenUpdated||this.previousQuery!==undefined&&this.previousQuery.toLowerCase()!==this.currentQuery.toLowerCase()),typeof n=="undefined"||n.length==0&&!this.config.fetchOnEmpty){this.fetchZeroQF();return}this.fetch(n)},h.prototype.pretechQuery=function(n){this._cacheZisEarly=!0;this.fetchWeb(n,0,!0)},h.prototype.setAdCachedQuery=function(n,t){this._adCachedQuery=n;this._adCachedImpressionGuid=t},h.prototype.appendLatency=function(n){this.networkLatencyInfo=this.data&&this.data.Inst?this.networkLatencyInfo==""?this.data.Inst.IG+":"+n:this.networkLatencyInfo+"&"+this.data.Inst.IG+":"+n:this.networkLatencyInfo==""?n:this.networkLatencyInfo+"&"+n},h.prototype.checkSuggestionTypeForRanking=function(){for(var i="",n=0;n<t.ZisRankableBanners.length;n++)this.checkClicksOrExpirty(t.ZisRankableBanners[n])&&(i=i!=""?i+","+t.ZisRankableBanners[n]:t.ZisRankableBanners[n]);return i},h.prototype.checkClicksOrExpirty=function(n){var r=t.Utils.getItem(n),i,u;try{if(r){if(i=JSON.parse(r),u=new Date,i&&u.getTime()>i.expiry)return t.Utils.removeItem(n),!1;if(i&&i.value>=this.config.zisr1)return!0}return!1}catch(f){return!1}},h.prototype.attemptLoadingCsrBundles=function(){this.config.csr_precompbootstrap||typeof sa_preactcompsloader=="undefined"||this.preactComponentsLoaded||(sa_preactcompsloader(),this.preactComponentsLoaded=!0)},h.prototype.LogPerformanceTiming=function(n){n.forEach(function(n){var t=performance.getEntriesByName(n);t&&t[0]&&Log.Log(n,"AS","PerfInst",!1,"LoadTime",t[0].startTime.toString())})},h.ScopeExtensions=[],h}(t.EventRegisterer);t.WebCore=s})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){function i(n,t,i){Log.Log(n,"AS","PerfInst",i,"Meta",t)}function f(n,t,i){Log.Log(n,"AS","MSBInst",i,"Meta",t)}function r(n,t,i,r){Log.Log(n,"AS","Ghosting",r,"Namespace","AutoSuggest","EventType",t,"CustomData",i)}function t(n,t){var i="q:"+n;return t&&(i+=",i:"+t),i}var u=function(){function u(){}return u.prototype.init=function(t){var i,r;this._coreInstance=t;i=new n.EventRegistration(this);i.add(18,this.onTextChanged);i.add(7,this.onRequestSent);i.add(9,this.onValidResponseReceived);i.add(31,this.OnGhostingEventFired);i.add(10,this.onSuggestionsRendered);i.add(26,this.onGhostingShown);i.add(27,this.onGhostingAccepted);i.add(34,this.logMSBSuggestionCount);t.registerEvents(i);t.internalEventTrigger&&(r=new n.EventRegistration(this),r.add(10,this.onSuggestionsRendered),t.internalEventTrigger.registerEvents(r))},u.prototype.onGhostingShown=function(n,t){var i='{"PL":'+n+', "GL":'+t;this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(i=i+', "IG":"'+this._coreInstance.data.Inst.IG+'"');i=i+"}";r("SystemEvent","TextGhostingSuggest",i,!1)},u.prototype.onGhostingAccepted=function(n,t,i){var u='{"PL":'+n+', "GL":'+t+', "AM":"'+i+'"';this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(u=u+', "IG":"'+this._coreInstance.data.Inst.IG+'"');u=u+"}";r("InteractionEvent","TextGhostingAccept",u,!1)},u.prototype.onTextChanged=function(n,r){i("Change",t(n,r),!1)},u.prototype.OnGhostingEventFired=function(n,r){i("GhostingLatency",t(n,r),!1)},u.prototype.onRequestSent=function(n,r){i("Request",t(n,r),!1)},u.prototype.logMSBSuggestionCount=function(n,t,i){var r="q:"+n;i&&(r+=",i:"+i);r+=",cnt:"+t;f("MSBSuggestionCount",r,!1)},u.prototype.onValidResponseReceived=function(i,r,u,f){u==n.DataSources.Web&&Log.Log("Load","AS","PerfInst",!1,"Meta",t(i,r),"AsResponseLength",f!==null&&f!==void 0?f:"")},u.prototype.onSuggestionsRendered=function(i,r,u,f,e){var o,s;e==n.DataSources.Web&&(o=t(i,u),this._coreInstance.data&&this._coreInstance.data.Inst&&this._coreInstance.data.Inst.IG&&(o+=",ig:"+this._coreInstance.data.Inst.IG),s=this.CheckAnswerPresent(r),Log.Log("Show","AS","PerfInst",!1,"Meta",o,"AnswerInfo",s))},u.prototype.CheckAnswerPresent=function(n){if(n!==null&&n!==undefined&&n[0]!==null&&n[0]!==undefined){var t=n[0];if(this._coreInstance.config.ascsr&&t.t&&t.q&&t.q!==undefined)return t.t+";"+t.q.length;if(!this._coreInstance.config.ascsr&&t.stype&&t.query&&t.query!==undefined)return t.stype+";"+t.query.length}return null},u}();n.PerfInst=u;n.WebCore.ScopeExtensions.push(new u)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t;(function(t){function g(t,u,f,e,o,h,c,l){if(c)return r(t,u,i.RS,p,f,n.searchResultId.RS,"rs_drw",5020,e,!1,!1,o,!1,h,-1,l);var a=_d.querySelectorAll(s);return r(t,u,i.RS,a,f,n.searchResultId.RS,"rs_drw",5020,e,!1,!1,o,!1,h,-1,l)}function nt(t,u,f,s,h,c,l,v,y){var p,b,k,d,g;return v?(p=!1,a.length>0?b=a:(b=w,p=!0),r(t,u,i.PAA,b,f,n.searchResultId.PAA,"paa_drw",5040,h,p,s,c,!1,-1,l,y)):(k=_d.querySelectorAll(e),d=!1,k.length>0?g=k:(g=_d.querySelectorAll(o),d=!0),r(t,u,i.PAA,g,f,n.searchResultId.PAA,"paa_drw",5040,h,d,s,c,!1,-1,l,y))}function tt(t,u,f,e,o,s,l){var a;if(s)return a=v.length>0?v:b,r(t,u,i.PASF,a,f,n.searchResultId.PASF,"pasf_rich_drw",5060,e,!1,!1,!1,o,-1,-1,l);var y=_d.querySelectorAll(h),p=_d.querySelectorAll(c),w=y.length>0?y:p;return r(t,u,i.PASF,w,f,n.searchResultId.PASF,"pasf_rich_drw",5060,e,!1,!1,!1,o,-1,-1,l)}function it(t,u,f,e,o,s,h){var c,a,v;return s?(c=k,r(t,u,i.PASFEM,c,f,n.searchResultId.PASFEM,"pasf_rich_drw",5060,e,!1,!1,!1,o,-1,-1,h)):(a=_d.querySelectorAll(l),v=a,r(t,u,i.PASFEM,v,f,n.searchResultId.PASFEM,"pasf_rich_drw",5060,e,!1,!1,!1,o,-1,-1,h))}function rt(n,t){if(t){switch(n){case i.RS:return p.length>0;case i.PAA:return(a.length||w.length)>0;case i.PASF:return(v.length||b.length)>0;case i.PASFEM:return k.length>0}return!1}switch(n){case i.RS:return _d.querySelectorAll(s).length>0;case i.PAA:return(_d.querySelectorAll(e).length||_d.querySelectorAll(o).length)>0;case i.PASF:return(_d.querySelectorAll(h).length||_d.querySelectorAll(c).length)>0;case i.PASFEM:return _d.querySelectorAll(l).length>0}return!1}function ut(n,t){var r;switch(n){case i.PAA:return t.getAttribute("data-query");case i.PASF:return r=t.querySelector("img"),(r===null||r===void 0?void 0:r.getAttribute("title"))||(r===null||r===void 0?void 0:r.getAttribute("alt"));case i.PASFEM:return r=t.getElementsByClassName("epv_title"),r[0].innerHTML;default:return t.textContent.trim()}}function r(n,t,r,u,f,e,o,s,h,c,l,a,v,p,w,b){var k,nt,tt,rt,it,d,g;if(c===void 0&&(c=!1),l===void 0&&(l=!1),a===void 0&&(a=!1),v===void 0&&(v=!1),p===void 0&&(p=-1),w===void 0&&(w=-1),b===void 0&&(b=!1),!u||u.length<y)return{suggestions:"",sugCount:0};for(k=sj_ce("ul",e,o),k.setAttribute("role","listbox"),k.setAttribute("aria-label",ft(r)),nt=s,tt=Math.min(u.length,f),rt=0;k.childElementCount<tt&&rt<u.length;rt++)if(it=u[rt],d=ut(r,it),!(h.indexOf(d)>-1)){g=void 0;switch(r){case i.RS:if(p>0&&d.length>p)continue;g=et(it,nt,d,n,tt,a,b);break;case i.PAA:if(w>0&&d.length>w)continue;g=ot(nt,d,n,t,tt,l,a,b);break;case i.PASF:g=st(it,nt,d,n,tt,v);break;case i.PASFEM:g=ht(it,nt,d,n,tt,v)}g!==null&&k.appendChild(g);nt++}return{suggestions:k.childElementCount>=y?k.outerHTML:"",sugCount:k.childElementCount}}function ft(n){var t="";switch(n){case i.RS:t=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.RelatedSearches)||"Related Search ";break;case i.PAA:t=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.PeopleAlsoAsk)||"People Also Ask ";break;case i.PASF:t=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.PeopleAlsoSearchFor)||"People Also Search For "}return t+"Suggestions"}function et(n,t,r,e,o,s,h){var c=sj_ce("li","sa_"+t.toString(),"sa_sgr"),l,a;return h&&c.setAttribute("class","sa_sgr sa_sgr_rrq_fnf"),f(c,i.RS,r,e,o,s),l=sj_ce("div","","sa_tm"),l.setAttribute("tabindex","-1"),l.innerHTML=n===null||n===void 0?void 0:n.innerHTML,a=s?u(!0,!1):h?u(!1,!0):u(),c.appendChild(a),c.appendChild(l),c}function ot(n,t,r,e,o,s,h,c){var l=sj_ce("li","sa_"+n.toString(),"sa_sgr"),a,v;return c&&l.setAttribute("class","sa_sgr sa_sgr_rrq_fnf"),f(l,i.PAA,t,r,o,h),a=sj_ce("div","","sa_tm"),a.setAttribute("tabindex","-1"),t.length>0&&(a.innerHTML=s?ct(e,t):t),v=h?u(!0,!1):c?u(!1,!0):u(),l.appendChild(v),l.appendChild(a),l}function st(t,r,u,e,o,s){var l,a,h,c,v,y,p;if(!t.getElementsByTagName("IMG"))return null;if(l=sj_ce("li","sa_"+r.toString(),"sa_sg_pasf"),f(l,i.PASF,u,e,o,!1),a=sj_ce("div","","sa_img"),h=sj_ce("div","",""),h.innerHTML=t.innerHTML,c=sj_ce("div","",""),c.innerHTML=h.innerHTML,v=c===null||c===void 0?void 0:c.firstChild,v!=null)n.Utils.AddClassName(v,"cico"),s&&n.Utils.AddClassName(v,"shadow"),h.innerHTML=c.innerHTML;else return null;return y=h===null||h===void 0?void 0:h.querySelectorAll("a"),y===null||y===void 0?void 0:y.forEach(function(n){n===null||n===void 0?void 0:n.removeAttribute("href");n===null||n===void 0?void 0:n.removeAttribute("target")}),p=sj_ce("div","","sa_pasf_text"),p.innerText=u,a.appendChild(h),a.appendChild(p),l.appendChild(a),l}function ht(t,r,u,e,o,s){var v,c,l,h,a,y;return t.getElementsByTagName("IMG")?(c=sj_ce("li","sa_"+r.toString(),"sa_sg_pasf"),f(c,i.PASFEM,u,e,o,!1),l=sj_ce("div","","sa_img"),h=sj_ce("div","","cico"),s&&n.Utils.AddClassName(h,"shadow"),h.innerHTML=t.getElementsByClassName("cico")[0].innerHTML,(v=h.querySelector(".epv_caption"))===null||v===void 0?void 0:v.remove(),a=h===null||h===void 0?void 0:h.querySelectorAll("a"),a===null||a===void 0?void 0:a.forEach(function(n){n===null||n===void 0?void 0:n.removeAttribute("href");n===null||n===void 0?void 0:n.removeAttribute("target")}),y=sj_ce("div","","sa_pasf_text"),y.innerText=u,l.appendChild(h),l.appendChild(y),c.appendChild(l),c):null}function f(n,t,i,r,u,f){n.setAttribute("role","option");n.setAttribute("stype",t);n.setAttribute("query",i);n.setAttribute("url",lt(i,r,"QBRE",u,t,f))}function ct(n,t){for(var f=n.split(" "),e=t.charAt(t.length-1),r=t.substr(0,t.length-1).split(" "),i="",o=function(n){i=f.some(function(t){return t.localeCompare(r[n],_G.Lang,{sensitivity:"base"})==0})?"".concat(i," ").concat(r[n]):"".concat(i," <strong>").concat(r[n],"<\/strong>")},u=0;u<r.length;++u)o(u);return i+e}function lt(n,t,i,r,u,f){var e={},o,s;e.q=encodeURIComponent(n);e.pq=encodeURIComponent(t);e.cvid=_G.IG;e.FORM=i;e.qs=u;e.sc=r+"-"+(t?t.length:0);f&&(e.showconv="1",e.sendquery="1");o="/search?";for(s in e)o+=s+"="+e[s]+"&";return o.substr(0,o.length-1)}function u(n,t){var i=sj_ce("div",null,"sa_sg_icon"),r;return t?i.setAttribute("class","sa_sg_icon sa_sg_icon_rrq_fnf sa_sg_searchicon_rdc"):n?(i.innerHTML='<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path class="lefticon_gray70_fill" d="M10 0C15.5228 0 20 4.47703 20 9.99972C20 15.5224 15.5228 19.9994 10 19.9994C8.40848 19.9994 6.86989 19.6268 5.48336 18.9236L5.3325 18.8432L0.776363 19.9808C0.389086 20.0775 0.0327801 19.7955 0.00163734 19.4292L0.00142664 19.3275L0.0186661 19.2229L1.15625 14.6683L1.07711 14.5187C0.508253 13.3978 0.155414 12.1774 0.0409332 10.91L0.00921994 10.4326L0 9.99972C0 4.47703 4.47715 0 10 0ZM10 1.24996C5.16751 1.24996 1.25 5.16736 1.25 9.99972C1.25 11.521 1.63818 12.9844 2.36691 14.2807C2.42558 14.385 2.45263 14.5033 2.44615 14.6212L2.42842 14.7385L1.48375 18.5145L5.2638 17.5724C5.34117 17.5531 5.42077 17.549 5.49841 17.5594L5.61288 17.5859L5.72126 17.6339C7.01702 18.3618 8.47963 18.7495 10 18.7495C14.8325 18.7495 18.75 14.8321 18.75 9.99972C18.75 5.16736 14.8325 1.24996 10 1.24996ZM10.625 11.2497C10.9702 11.2497 11.25 11.5295 11.25 11.8747C11.25 12.1815 11.0289 12.4367 10.7373 12.4896L10.625 12.4996H6.875C6.52982 12.4996 6.25 12.2198 6.25 11.8747C6.25 11.5678 6.47109 11.3127 6.76266 11.2598L6.875 11.2497H10.625ZM13.125 7.49979C13.4702 7.49979 13.75 7.7796 13.75 8.12477C13.75 8.43159 13.5289 8.68677 13.2373 8.73968L13.125 8.74975H6.875C6.52982 8.74975 6.25 8.46994 6.25 8.12477C6.25 7.81795 6.47109 7.56278 6.76266 7.50986L6.875 7.49979H13.125Z" fill="#767676"/><\/svg>',i.classList.add("sa_sg_icon_chat")):i.innerHTML='<svg height="18px" width="18px" viewBox="0 0 25 25"><path class="gray70_stroke" stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M23.75 23.75l-9-9"> <\/path><circle class="gray70_stroke" stroke ="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" cx="9" cy="9" r="7.75" fill="none"> <\/circle><path fill="none" d="M25 25h-25v-25h25z"> <\/path><\/svg>',r=sj_ce("div",null,"sa_sg_icon_area"),r.appendChild(i),r}var e="#df_listaa .df_topAlAs.df_sideColor.df_alsoAsk",o=".df_alsoAskCard",s=".b_rs ul li .b_suggestionText",h=".lite-entcard-exp ul li a.as_pasf_data .cico",c="#l_ecrd_blk_ExploreMore ul li a.as_pasf_data .cico",l=".b_remod .b_mgridOuter .b_mgridBody .b_mgridImageCont .b_entityCont.b_showTitle",i={RS:"RS",PAA:"PAA",PASF:"PASF",PASFEM:"PASFEM"},y=2,p=_d.querySelectorAll(s),a=_d.querySelectorAll(e),w=_d.querySelectorAll(o),v=_d.querySelectorAll(h),b=_d.querySelectorAll(c),k=_d.querySelectorAll(l),d=function(){function n(n,t){n===void 0&&(n="");t===void 0&&(t=0);this.suggestions=n;this.sugCount=t}return n}();t.RequeryResponse=d;t.getRsSuggestions=g;t.getPaaAnswers=nt;t.getPASFData=tt;t.getPASFEMData=it;t.isResultTypePresent=rt})(t=n.SearchTypeUtils||(n.SearchTypeUtils={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var u=AutoSuggest.Service.QueryParams,t="sa_errorCnt",i=function(){function n(){this._callParams={};this._callHeaders={};this._callBody={}}return n.prototype.fetchUrl=function(){},n.prototype.init=function(n,t,i){this._config=n;this._baseUrl=t;this._callbackFunc=i},n.prototype.addParam=function(n,t){this._callParams[n]=t},n.prototype.addHeader=function(n,t){if(this._config.cors)throw"Custom headers are not allowed for cross domain calls";this._callHeaders[n]=t},n.prototype.addPostValue=function(n,t){this._callBody[n]=t},n.prototype.addBody=function(n){this._callBody=n},n.prototype.fetch=function(n,t,i){this._requestSequence=t;var r=this.getFinalFetchUrl(n);this.fetchUrl(r,n,t,i)},n.prototype.getBaseUrl=function(){return this._baseUrl},n.prototype.isPostCall=function(){return this._callBody&&typeof this._callBody=="object"&&Object.keys(this._callBody).length>0},n.prototype.getFinalFetchUrl=function(n){var i=decodeURIComponent(this.getBaseUrl())+encodeURIComponent(n),t;this.addParam(u.ConversationId,_G.IG);this._config.adform&&this.addParam("form",this._config.adform);for(t in this._callParams)i+="&"+t+"="+this._callParams[t];return this._callParams={},i},n}(),r;n.DataProviderBase=i;r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.fetchUrl=function(i,r,u,f){var o=this,s,e,h,c;if((this._config.asprefre||this._config.asprefrev2)&&typeof sa_storage!="undefined"&&sa_storage.hasOwnProperty(r)&&sa_storage[r]!==null&&sa_storage[r]!==undefined)s=sa_storage[r],this._callbackFunc(s.responseText,u,r,i,null,s.status,s.getResponseHeader("content-length"),!0);else{e=sj_gx();e.open(this.isPostCall()?"POST":"GET",i,!0);for(h in this._callHeaders)e.setRequestHeader(h,this._callHeaders[h]);this._callHeaders={};e.onreadystatechange=function(){var s,n,h,c,l;if(e.readyState==4){if(e.onreadystatechange=function(){},s=void 0,n=e.status,n==200?s=e.responseText:_w[t]&&(n==0||(n/100|0)==4||(n/100|0)==5)&&(s=_w[t]),h=null,f&&(!o._config.cors||o._config.rbhc)&&e.getResponseHeader&&(h=e.getResponseHeader("X-BingQF-BLIS")),o._config.instHeader&&e.getResponseHeader&&(c=e.getResponseHeader("X-BingQF-It"),c))try{l=JSON.parse(c);l.Inst&&sa_inst.setData(l)}catch(a){}o._callbackFunc(s,u,r,i,h,n,e.getResponseHeader("content-length"))}};e.withCredentials!==undefined&&(e.withCredentials=!0);this.isPostCall()?(c=n.Utils.safeExecute(function(){return JSON.stringify(o._callBody)},""),e.send(c)):e.send()}},r}(i);n.DataProvider=r})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getFinalFetchUrl=function(t){if(this.isPostCall()){var i=decodeURIComponent(this.getBaseUrl());return this._callParams={},i}return n.prototype.getFinalFetchUrl.call(this,t)},t}(n.DataProvider);n.BingAtWorkDataProvider=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(n){var t=this;this.bindEventToGetTenantConfig=function(){sj_evt.bind("bfbtcfg",function(n){n&&n.length>1&&(t.tenantConfig=n[1])},!0)};this.config=n;this.config.bfbAppendTenantName&&this.bindEventToGetTenantConfig()}return t.prototype.parse=function(t,i,r,u,f,e){var v=[],k,y,p,c,w,l,nt,b,a,tt;if(!t){r(v,k,u);return}for(y=0,p=t;y<p.length;y++){var o=p[y],s=void 0,d=void 0,h=void 0,g=void 0;switch(o.domain){case"Person":c=o;c&&c.identifiers&&c.identifiers.uniqueName&&(w=c.query,this.config.bfbAppendTenantName&&this.tenantConfig&&this.tenantConfig.displayName&&(w+=" "+this.tenantConfig.displayName),s=n.Utils.buildBfbSearchUrl(this.config,w,"Person",c.identifiers.uniqueName,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length),h=2);break;case"Group":l=o;l&&l.identifiers&&l.identifiers.uniqueName&&(s=n.Utils.buildBfbSearchUrl(this.config,l.query,"Group",l.identifiers.uniqueName,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length));h=6;break;case"Bookmark":s=n.Utils.buildBfbSearchUrl(this.config,o.query,"Bookmark",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=1;break;case"Qna":s=n.Utils.buildBfbSearchUrl(this.config,o.query,"Qna",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=3;break;case"Acronym":this.config.msbAcrR&&(nt="define ".concat(o.query.replace(/\s/g,"")),s=n.Utils.buildBfbSearchUrl(this.config,nt,"Acronym",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length),h=7,(o===null||o===void 0?void 0:o.hasMoreDefinitions)&&(o===null||o===void 0?void 0:o.title)&&(o.title="".concat(o.title," (").concat(sa_loc.SeeMore||"See more",")")));break;case"Building":s=n.Utils.buildBfbSearchUrl(this.config,o.query,"Building",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=4;break;case"File":b=o;b&&(g=b.fileType);s=n.Utils.buildBfbSearchUrl(this.config,o.query,"Files",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=5;break;case"EducationAssignment":s=n.Utils.buildBfbSearchUrl(this.config,o.query,"EducationAssignment",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=8;break;case"External":a=o;a&&(s=n.Utils.buildBfbSearchUrl(this.config,o.query,"External","",a.contentDomainAlternateId||a.cType,a.id,u===null||u===void 0?void 0:u.ConversationId,t.length),d=a.iconUrl);h=9;break;case"UserHistory":s=n.Utils.buildBfbSearchUrl(this.config,o.query,"UserHistory",null,null,null,u===null||u===void 0?void 0:u.ConversationId,t.length);h=10}s&&h&&(tt={query:o.query,url:s,stype:o.domain,instItem:n.InstrumentedItem.createInstrumentedItem(i),id:o.id,annotation:o.title,icon:h,iconUrl:d,fileType:g,confidence:o.confidence,subType:o.cType,sourceReferenceId:o.referenceId,sourceLogicalId:o.logicalId,lastSyncTime:o.lastSyncTime,isServerSuggestion:o.isServerSuggestion,traceId:o.traceId},v.push(tt))}r(v,k,u);this.config.ascsr&&this.config.enableCSRForBAW&&t&&t.length!=0&&sj_evt.fire("AS.ResponseRecieved",v,f,i,e,!0)},t}();n.MsbSuggestionsParser=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function n(){}return n.prototype.init=function(n){this._callbackFunc=n},n.prototype.show=function(n,t){this._callbackFunc(t,n)},n}();n.MSBEngagementDataProvider=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function n(){}return n.prototype.init=function(n,t,i){this._msbDataModule=_w.BingAtWork;this._callbackFunc=n;this._bingAtWorkWebTelemetry=t;this._msbStateCallback=i},n.prototype.fetch=function(n,t,i){var f=this,r=this._bingAtWorkWebTelemetry?this._bingAtWorkWebTelemetry.getLogicalId(i===null||i===void 0?void 0:i.LogicalId):"",u=this._bingAtWorkWebTelemetry?this._bingAtWorkWebTelemetry.getConversationId():"",e;if(!this._msbDataModule){this._msbStateCallback([],t,n,!1,r,i,"DMNL");return}if(i&&u&&(i.ConversationId=u),e=function(n,t,i,r,u,e,o,s){f._msbStateCallback(n,t,i,!1,u,e,o,s)},this._msbDataModule.getExtraSuggestions&&this._msbDataModule.getExtraSuggestions(n,function(u){f._callbackFunc(u,t,n,!1,r,i)},function(u){return e([],t,n,!1,r,i,"EXSF",u)},{qfLoggerContext:i,conversationId:u,logicalId:r}),!this._msbDataModule.getSuggestions){this._msbStateCallback([],t,n,!0,r,i,"GSNL");return}this._msbDataModule.getSuggestions&&this._msbDataModule.getSuggestions(n,function(u){f._callbackFunc(u,t,n,!0,r,i)},function(u){return e([],t,n,!0,r,i,"GSF",u)},{count:sa_config.bawmax,qfLoggerContext:i,conversationId:u,logicalId:r})},n.prototype.fetchZeroQF=function(n,t){var r=this,i=this._bingAtWorkWebTelemetry?this._bingAtWorkWebTelemetry.getLogicalId():"",f=this._bingAtWorkWebTelemetry?this._bingAtWorkWebTelemetry.getConversationId():"",u;if(!this._msbDataModule){this._msbStateCallback([],n,"",!0,i,t,"ZQNL");return}u=function(n,t,i,u,f,e,o,s){r._msbStateCallback(n,t,i,!0,f,e,o,s)};this._msbDataModule.getZeroQfSuggestions&&this._msbDataModule.getZeroQfSuggestions(function(u){r._callbackFunc(u,n,"",!0,i,t)},function(r){return u([],n,"",!0,i,t,"ZQSF",r)},{count:sa_config.bawmax,qfLoggerContext:t,conversationId:f,logicalId:i})},n}();n.MsbDataProvider=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var rt=["MD","ADS"],ut=["CustomSearch"],s=["previousSibling","nextSibling"],ft=["","","nextSibling","previousSibling"],u=["lastChild","firstChild","parentElement"],f=["","","firstChild","lastChild"],e={},tt,it;e.sa_ul=0;e.rich_card=1;e.sa_exp_sug=2;var a="sa_hv",et="sa_kb_hv",v=/(\s|^)sa_hv/g,y=/(\s|^)sa_kb_hv/g,h="data-sugcont",p="as_rsform",ot="as_shadow",w="as_show",st="sa_exp_hv",b=/(\s|^)as_rsform/g,ht=/(\s|^)as_expand/g,ct=/(\s|^)sa_exp_hv/g,lt=/(\s|^)sa_drw/g,k="b_norr",at=/(\s|^)b_norr/g,c="BAWC",vt="bw-cn",d=",",g="result",i=t.Utils,o=AutoSuggest.Service.SuggestionAttributes,nt=[t.DataSources.BingAtWork,t.DataSources.Substrate,t.DataSources.MicrosoftSearchInBing,t.DataSources.MicrosoftSearchInBingCached],l={RS:"RS",PAA:"PAA",PASF:"PASF",PASFEM:"PASFEM"},r;(function(n){n[n.RIGHT_BORDER=0]="RIGHT_BORDER";n[n.LEFT_BORDER=1]="LEFT_BORDER";n[n.NO_BORDER=2]="NO_BORDER";n[n.DUAL_BORDER=3]="DUAL_BORDER"})(r||(r={}));t.searchResultId={RS:"rs_ul",PAA:"paa_ul",PASF:"pasf_ul",PASFEM:"pasf_ul",PN:"zisR_ul"};tt=[t.searchResultId.RS,t.searchResultId.PAA,t.searchResultId.PASF,t.searchResultId.PASFEM,t.searchResultId.PN];it=function(it){function yt(){var n=it.call(this)||this;return n.currentSuggestionList=[],n._ie9orLower=sb_ie&&!_w.atob,n._currentRequestSequence=-1,n._suggestionsQueue={},n}return __extends(yt,it),yt.prototype.init=function(n,r,u,f){var e,o;this.autoSuggestInstance=n;this.config=r;this.container=u;this._searchBox=f;this._asContainer=_ge(r.c||"sw_as");o=new t.EventRegistration(this);o.add(17,this.clearEvents);this.autoSuggestInstance.registerEvents(o);this._hasPrefixQueryBeenUpdated=!1;this.nextWordRemoved=!1;this.hasAsExpanded=!1;this.searchTypeDivIndex=0;this.isBNorrClassPresent=!1;this._isNewDom=!1;this._header=document.querySelector("#b_header")?document.querySelector("#b_header"):null;this.resizeNextWord=r.nwRz;this.isFirstNWFullEnabled=r.nextWordNFullSuggsOne;this.msbNonHistorySuggestions=0;this._previousQuery=(e=f.value)===null||e===void 0?void 0:e.toLowerCase();this._borderRadius=this.config.asdhml&&!this.config.brlg?12:this.config.isMobile?10:24;this.isRtl=i.GetComputedStyle(sj_b).direction=="rtl";this._previousRoundedElement=null;this.cbOnTopLastSuggestion=!1;this._searchBoxForm=document.getElementsByClassName("b_searchboxForm")[0];this.trendingNowMovedToRight=!1;this._highlightedRichLIElement=null;this._easePollingInterval=this.config.easePI},yt.prototype.updateWidth=function(){var r=_ge("sw_as"),n,u,f,i;if(this.nextWordRemoved&&r&&(n=document.querySelectorAll("li.sa_sg"),u=t.Utils.GetComputedStyle(r).width,n))for(f=n.length,i=0;i<f;i++)n[i].style.width=u},yt.prototype.removeNextWordOnMSBHistory=function(n){var e=_ge("sw_as"),r,f,i,u,o;if(n&&e&&(r=document.querySelectorAll("li.sa_sg"),f=r===null||r===void 0?void 0:r.length,f>0)){for(i=0;i<f;i++)r[i].stype.indexOf("NW")!=-1&&(r[i].parentElement.removeChild(r[i]),this.currentSuggestionList[i]&&this.currentSuggestionList.splice(i,1),this.nextWordRemoved=!0);this.nextWordRemoved&&(this.config.enforceMsnNWStyle?(u=document.querySelector(".sa_as.sa_nw.sa_msn_nw"),u&&(u.classList.remove("sa_nw"),u.classList.remove("sa_msn_nw"))):(u=document.querySelector(".sa_as.sa_nw"),u&&u.classList.remove("sa_nw")),this.containsNextWord=!1,o=new t.Layout(this.config,e,this),o.update())}},yt.prototype.calculateBorderRadius=function(n){switch(n){case r.DUAL_BORDER:return"0px 0px ".concat(this._borderRadius,"px ").concat(this._borderRadius,"px");case r.RIGHT_BORDER:return"0px 0px 0px ".concat(this._borderRadius,"px");case r.LEFT_BORDER:return"0px 0px ".concat(this._borderRadius,"px 0px");case r.NO_BORDER:return"0px 0px 0px 0px"}},yt.prototype.lastElementBorderCurve=function(){var f,u=_ge("as_foot"),t=_ge("sa_ul"),s=_ge("sa_zis_Banner"),i=this.calculateBorderRadius(r.NO_BORDER),e=!1,o,n;(u===null||((f=u===null||u===void 0?void 0:u.style)===null||f===void 0?void 0:f.display)==="none")&&(i=this.calculateBorderRadius(r.DUAL_BORDER),this.config.enableAsPanelExpansion&&this.hasAsExpanded&&(o=_ge("asmsbribbon_li"),this.isLeftSectionLongerForRichRequery()||o?i=this.isRtl?this.calculateBorderRadius(r.LEFT_BORDER):this.calculateBorderRadius(r.RIGHT_BORDER):(e=!0,i=this.calculateBorderRadius(r.NO_BORDER))));t&&(e||(t.style.borderRadius=i),t.children&&t.children.length&&t.lastElementChild&&(n=this._isNewDom&&t.lastElementChild.tagName==="UL"?t.lastElementChild.lastElementChild:t.lastElementChild,n&&!this.trendingNowMovedToRight&&(this._previousRoundedElement&&this._previousRoundedElement&&(this._previousRoundedElement.style.borderRadius=this.calculateBorderRadius(r.NO_BORDER),!this.config.isMobile&&this._previousRoundedElement.tagName.toLowerCase()==="div"&&this._previousRoundedElement.lastElementChild&&(this._previousRoundedElement.lastElementChild.style.borderRadius=this.calculateBorderRadius(r.NO_BORDER))),n.style.borderRadius=i,!this.config.isMobile&&n.tagName.toLowerCase()==="div"&&n.lastElementChild&&(n.lastElementChild.style.borderRadius=i),this.config.asszrdc&&(n.id.toLowerCase()==="asmsbribbon_li"||s||u||(!this.config.isMobile&&n.tagName.toLowerCase()==="div"&&n.lastElementChild?n.lastElementChild.style.paddingBottom="12px":n.style.paddingBottom="12px"),this._previousRoundedElement&&this._previousRoundedElement&&(!this.config.isMobile&&this._previousRoundedElement.tagName.toLowerCase()==="div"&&this._previousRoundedElement.lastElementChild?this._previousRoundedElement.lastElementChild.style.removeProperty("padding-Bottom"):this._previousRoundedElement.style.removeProperty("padding-Bottom"))),this._previousRoundedElement=n)));return},yt.prototype.insertHistoryBannerAndUpdateElementCurve=function(n,t){var f,i,r,e,o,u;for(this.container&&(i=this._isNewDom?this.container.getElementsByTagName("DIV"):this.container.getElementsByTagName("UL")),r=0;r<(i===null||i===void 0?void 0:i.length);r++)if(i[r].className.indexOf("sa_drw")!=-1){f=i[r];break}if(this.config.CommonFooter){if(t&&!_ge("as_foot")){o=void 0;u=this.config.isANtp?_geNtp(".sa_as",!0):document.querySelectorAll(".sa_as");u.length>0&&(o=u[u.length-1]);var s=this.config.aadManageHistoryUrl,h=this.config.ascontainer&&!this.config.brlg?"as_rmhswarning out_fd_side as_codex_border":"as_rmhswarning out_fd_side",c=sa_loc.ManageHistory?sa_loc.ManageHistory.slice(2,-2):"Manage Your Search History",l='<div id="as_foot" class="'.concat(h,'"><a _target="blank" id="as_foot_link" class="as_rmhswarningtxt" tabindex="0" href= ').concat(s,">").concat(c,"<\/a><\/div>"),e=this.createDivFromAjaxResponse(l);this.insertAjaxResponseDivIntoDom(o,e,1,"MSB")}}else n!=""&&(e=this.createDivFromAjaxResponse(n),this.insertAjaxResponseDivIntoDom(f&&!this.hasAsExpanded?f:this.container,e,1,"MSB"));this.config.asmobfw||this.lastElementBorderCurve()},yt.prototype.UpdateClassForBoldEntity=function(){var n=document.querySelector(".bold_ent");if(n&&n!=undefined){var r=document.querySelector(".pp_tile.pp_sTile"),u=document.querySelector(".pp_tile.pp_sTile .sa_ans"),t=document.querySelector(".pp_tile.pp_sTile .entity_container .cico"),i=document.querySelector(".pp_tile.pp_sTile .entity_container .cico img");t.style.height="160px";t.style.width="170px";r.classList.add("pp_bold");i.style.height="160px";i.style.width="170px";u.id="sa_ans_bold"}},yt.prototype.render=function(r,u,f,e,o){var at,vt,yt,pt,wt,p,b,ut,d,tt,a,ti,ii,bt,kt,c,v,h,ft,it,st,dt,et,ct,gt,ht,y,ri,ui,lt,ni,fi,rt,ei,oi;for(f>this._currentRequestSequence&&(this._suggestionsQueue={},this._currentQuery=u,this._currentRequestSequence=f),this._suggestionsQueue[e]={suggestions:r,rendered:!1,dataSource:e},e==="Web"&&(this._isNewDom=r?!((this.config.moveTrendingNowToRight||this.config.zisPaneexpansion)&&this.config.enableAsPanelExpansion)&&r.substring(0,5)==="<div ":!1),this.config.asLowNetworkScneario&&!this.container.parentElement&&(wt=document.querySelector(".sa_as"),this.container=wt?wt:this.container),this.nextWordRemoved=!1,this.hasAsExpanded=!1,p="",b=!1,ut=0;ut<this.config.enabledDataSources.length;ut++){var l=[],g=this.config.enabledDataSources,s=this._suggestionsQueue[g[ut]];if(!s){this.insertHistoryBannerAndUpdateElementCurve(p?p:"",b);return}if(!s.rendered){for(d=_ge("sa_baw"),tt=null,nt.indexOf(s.dataSource)!=-1&&(d?this.config.msbSusR&&(tt=this.config.bawmax*2-d.children.length):(a=this._isNewDom?"listbox":"none",this.config.promoteUserHistoryForAADUser&&s.dataSource==="MSBC"?(c=s.suggestions.split("|||"),s.suggestions="",c&&c.length==3&&(c[0]!=""&&(b=!0,this._currentQuery==""?(ti=(at=sa_loc.SearchHistoryHeading)!==null&&at!==void 0?at:"History",ii='<div class="sa_hd" > <h2 class=" asSectionHeading" > '.concat(ti," <\/h2><\/div >"),s.suggestions='<div data-region="BAWC" id="bawuh" data-sugcont="1" role="'.concat(a,'">').concat(ii).concat(c[0],"<\/div>")):s.suggestions='<div data-region="BAWC" id="bawuh" data-sugcont="1" role="'.concat(a,'">').concat(c[0],"<\/div>")),c[1]!=""&&(s.suggestions+="|||"+'<div data-region="BAWC" id="bawh" data-sugcont="1" role="'.concat(a,'">').concat(c[1],"<\/div>")),c[2]!=""&&(s.suggestions+="|||"+'<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="'.concat(a,'">').concat(c[2],"<\/div>")),v=t.BingAtWorkTemplateManager===null||t.BingAtWorkTemplateManager===void 0?void 0:t.BingAtWorkTemplateManager.replaceLocalizedStringsInMSBHtml(s.suggestions,u),v&&(bt='<li id="as_foot"',v.indexOf(bt)!=-1?(kt=v.split(bt),s.suggestions=kt[0]+"<\/div>",p='<li id="as_foot"'+kt[1].split("<\/div>")[0]):s.suggestions=v))):this.config.webMsbQFRanking&&s.dataSource==="MSBC"?(c=s.suggestions.split("|||"),s.suggestions=c[0]!=""?'<div data-region="BAWC" id="bawh" data-sugcont="1" role="'.concat(a,'">').concat(c[0],"<\/div>")+"|||"+'<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="'.concat(a,'">').concat(c[1],"<\/div>"):'<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="'.concat(a,'">').concat(c[1],"<\/div>")):s.dataSource!=="MSBE"&&(s.suggestions='<div data-region="BAWC" id="sa_baw" data-sugcont="1" role="'.concat(a,'">').concat(s.suggestions,"<\/div>")))),s.dataSource==="MSBE"&&(v=t.BingAtWorkTemplateManager===null||t.BingAtWorkTemplateManager===void 0?void 0:t.BingAtWorkTemplateManager.replaceLocalizedStringsInMSBEHtml(s.suggestions,u),v&&(s.suggestions=v)),g[0]==s.dataSource&&(this.container.innerHTML="",this.currentSuggestionList=[],this._currentSuggestion=null,this.selectedSuggestion=null,this.containsNextWordInWebSuggestions=!1,this._searchBox.removeAttribute("aria-activedescendant")),h=void 0,ft=this._isNewDom?this.container.getElementsByTagName("DIV"):this.container.getElementsByTagName("UL"),it=0;it<ft.length;it++)if(ft[it].className.indexOf("sa_drw")!=-1){h=ft[it];break}if(d=_ge("sa_baw"),s.dataSource==="MSBE"||!d||(h=d),this.config.promoteUserHistoryForAADUser&&s.dataSource==="MSBC"&&s.suggestions.indexOf("|||")!=-1){for(et=s.suggestions.split("|||"),this.isFirstNWFullEnabled||this.removeNextWordOnMSBHistory(b),st=0,dt=et;st<dt.length;st++)ht=dt[st],y=this.createDivFromAjaxResponse(ht),this.insertAjaxResponseDivIntoDom(h?h:this.container,y,tt,s.dataSource),((vt=n.AS.BingAtWorkTemplateManager)===null||vt===void 0?void 0:vt.handleMsbImageError)&&n.AS.BingAtWorkTemplateManager.handleMsbImageError(s,h?h:this.container),this.buildSuggestions(l,s.dataSource);this.updateWidth()}else if(this.config.webMsbQFRanking&&s.dataSource==="MSBC"&&s.suggestions.indexOf("|||")!=-1)for(et=s.suggestions.split("|||"),ct=0,gt=et;ct<gt.length;ct++)ht=gt[ct],y=this.createDivFromAjaxResponse(ht),this.insertAjaxResponseDivIntoDom(h?h:this.container,y,tt,s.dataSource),((yt=n.AS.BingAtWorkTemplateManager)===null||yt===void 0?void 0:yt.handleMsbImageError)&&n.AS.BingAtWorkTemplateManager.handleMsbImageError(s,h?h:this.container),this.buildSuggestions(l,s.dataSource);else s.dataSource==="MSBE"&&this.containsNextWordInWebSuggestions||(y=this.createDivFromAjaxResponse(s.suggestions),s.dataSource!=="MSBC"||this.isFirstNWFullEnabled||this.removeNextWordOnMSBHistory(b),this.config.webMsbQFRanking&&this.setLowConfidenceWebSignal(y),this.insertAjaxResponseDivIntoDom(h?h:this.container,y,tt,s.dataSource),this.updateMSBEBannerStyleForRichRequery(),this.updateWidth(),this.config.boldEntity&&s.dataSource==="Web"&&this.UpdateClassForBoldEntity(),((pt=n.AS.BingAtWorkTemplateManager)===null||pt===void 0?void 0:pt.handleMsbImageError)&&n.AS.BingAtWorkTemplateManager.handleMsbImageError(s,h?h:this.container),this.rqsPresent=this.rqspresent(),this.buildSuggestions(l,s.dataSource),s.dataSource==="Web"&&(this.containsNextWordInWebSuggestions=this.containsNextWord),this.config.enableAsPanelExpansion&&s.dataSource==="Web"&&this.shouldShowOtherSuggestions()?(this.config.backfillRichRequery&&(this.rqsPresent?this.serverGPCbackfillRichRequery():this.backfillRichRequery()),this.showSearchType(s.dataSource,this.config.enabledSearchTypes,h,l,this.config.maxSuggestionsToShow),this.config.IsRequeryPresent&&typeof Log!="undefined"&&typeof Log.Log!="undefined"&&(ri="RS:"+this.rsCnt+"|PASF:"+this.pasfCnt+"|PAA:"+this.paaCnt,Log.Log("Requery","AS","RequeryInst",!1,"Namespace","AutoSuggest","EventType","Request","CustomData",ri))):!this.config.enableAsPanelExpansion||this._highlightedRichLIElement||this.shouldShowOtherSuggestions()||(this.updateSearchBoxExpansionClasses(!1),this.isBNorrClassPresent&&i.AddClassName(document.body,k)),this.trendingNowMovedToRight=(this.config.moveTrendingNowToRight||this.config.zisPaneexpansion)&&this.config.enableAsPanelExpansion&&this.shouldMoveTrendingNowToRight(),this.isQueryNullOrWhiteSpace()&&this.trendingNowMovedToRight&&(this.updateSearchBoxExpansionClasses(!0),this.buildSuggestions(l,"TRR")));if(this.config.asshdw&&i.AddClassName(this._searchBoxForm,ot),this._previousQuery=this._currentQuery,(this.config.moveTrendingNowToRight||this.config.zisPaneexpansion)&&this.config.enableAsPanelExpansion&&this.isQueryNullOrWhiteSpace()?this._searchTypeDivs=_d.querySelectorAll(".sa_zis_parent"):this.config.enableAsPanelExpansion&&this.hasAsExpanded?this._searchTypeDivs=_d.querySelectorAll(".sa_as ul"):(this._searchTypeDivs=undefined,this.searchTypeDivIndex=0),s.rendered=!0,s.dataSource==t.DataSources.Web)if(l.length>0)this.config.bi&&(ui={currentQuery:u,suggestionElements:l,requestSequence:f},sj_evt.fire("AS.SuggestionsRendered",ui));else for(lt=0,ni=g;lt<ni.length;lt++)if(fi=ni[lt],nt.indexOf(fi)!=-1){rt=this._isNewDom?sj_ce("div",this.config.slid,"sa_drw"):sj_ce("ul",this.config.slid,"sa_drw");ei=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.Suggestions)?sa_loc.Suggestions:"Suggestions";rt.setAttribute("data-priority","2");rt.setAttribute("role","listbox");rt.setAttribute("aria-label",ei);this.container.appendChild(rt);break}l.length>0?(sj_evt.fire("AS.Canvas.Show"),this.config.asLowNetworkScneario&&(this.config.enableAsPanelExpansion&&(this.hasAsExpanded||this.trendingNowMovedToRight)?this.updateSearchBoxExpansionClasses(!0):this.config.enableEASE&&(this._highlightedRichLIElement&&this.removeEASEClasses(this._highlightedRichLIElement),oi=this._suggestionsContainer.getElementsByTagName("LI")[0],this.pollForEASE(oi)),this.container.style.display=="none"&&(this.config.asOnSBRound&&t.Utils.AddClassName(this._searchBoxForm,w),this.container.style.display="block")),this.raiseEvent(10,u,l,f,this.container,s.dataSource,o),this.config.asOnSBRound&&t.Utils.AddClassName(this._searchBoxForm,w)):this.config.enableAlwaysUpdateQFC&&s.dataSource==t.DataSources.Web&&this.autoSuggestInstance.raiseUpdateText(this._currentQuery,!1);this.currentSuggestionList.length===0&&(sj_evt.fire("AS.Canvas.Hide"),g[g.length-1]==s.dataSource?this.raiseEvent(11,u):e===t.DataSources.Web&&this.raiseEvent(24,u))}}this.insertHistoryBannerAndUpdateElementCurve(p?p:"",b)},yt.prototype.pollForEASE=function(n){var i=this,t;n===void 0&&(n=null);this._easePollingInterval&&(this._easePollingInterval=this.config.easePI);n!==null?(t=this.checkWhetherEASEChildSuggestionsArePresent(n),t&&(this.isSuggestionNullOrUndefined(this._currentSuggestion)||this._currentSuggestion===n)&&(this._highlightedRichLIElement=n,this.addEASEClasses(this._highlightedRichLIElement))):this.isSuggestionNullOrUndefined(this._highlightedRichLIElement)?this.isSuggestionNullOrUndefined(this._currentSuggestion)||this.checkWhetherEASEChildSuggestionsArePresent(this._currentSuggestion)&&(this._highlightedRichLIElement=this._currentSuggestion,this.addEASEClasses(this._highlightedRichLIElement)):this.isSuggestionNullOrUndefined(this._currentSuggestion)?this.container.style.display=="none"&&(this.removeEASEClasses(this._highlightedRichLIElement),this._highlightedRichLIElement=null):this._enteredChildSuggestionPane||this._currentSuggestion===this._highlightedRichLIElement||(this.removeEASEClasses(this._highlightedRichLIElement),this._highlightedRichLIElement=null,this.checkWhetherEASEChildSuggestionsArePresent(this._currentSuggestion)&&(this._highlightedRichLIElement=this._currentSuggestion,this.addEASEClasses(this._highlightedRichLIElement)));sb_st(function(){return i.pollForEASE()},this._easePollingInterval)},yt.prototype.isSuggestionNullOrUndefined=function(n){return n===null||n===undefined?!0:!1},yt.prototype.checkWhetherEASEChildSuggestionsArePresent=function(n){var t;return(n===null||n===void 0?void 0:n.className.indexOf("sa_ent"))!==-1&&((t=n===null||n===void 0?void 0:n.lastElementChild)===null||t===void 0?void 0:t.className.indexOf("sa_expand"))!==-1},yt.prototype.addEASEClasses=function(n){var u,r,t,f,e;if(this.updateSearchBoxExpansionClasses(!0),u=document.querySelector(".sa_as"),i.AddClassName(u,"as_expand"),i.AddClassName(n,st),n.querySelector(".sa_expand"))for(this.updateSearchBoxExpansionClasses(!0),r=n.getElementsByTagName("UL"),t=0;t<r.length;t++)f=r[t],i.AddClassName(f,"sa_drw");e="isEASEPresent:true";Log.Log("EASE","AS","EASEInst",!1,"Namespace","AutoSuggest","EventType","Hide","CustomData",e)},yt.prototype.removeEASEClasses=function(n){var t=n.getElementsByTagName("UL"),r,f,u,e;if(t!==undefined&&t!==null)for(r=0;r<t.length;r++)f=t[r],i.RemoveClassName(f,lt);i.RemoveClassName(n,ct);u=document.querySelector(".sa_as");u!==null&&i.RemoveClassName(u,ht);this.updateSearchBoxExpansionClasses(!1);e="isEASEPresent:false";Log.Log("EASE","AS","EASEInst",!1,"Namespace","AutoSuggest","EventType","Hide","CustomData",e)},yt.prototype.updateRawQuery=function(n){this._rawQuery=n},yt.prototype.isLeftSectionLongerForRichRequery=function(){var e,i=_d.querySelectorAll(".sa_as ul"),o=0,r=0,n,t,f;if(i.length>1){var s=34,u=i[0];for(n=0;n<((e=u===null||u===void 0?void 0:u.childNodes)===null||e===void 0?void 0:e.length);n++)o+=u.childNodes[n].offsetHeight;for(n=1;n<(i===null||i===void 0?void 0:i.length);n++){t=i[n];switch(t.className){case"paa_drw":case"rs_drw":for(f=0;f<(t===null||t===void 0?void 0:t.childNodes.length);f++)r+=t.childNodes[f].offsetHeight;r+=s;break;case"pasf_rich_drw":r+=t.offsetHeight+12+s}}r+=10}return o>r},yt.prototype.updateMSBEBannerStyleForRichRequery=function(){var n,t;this.config.enableAsPanelExpansion&&this.isLeftSectionLongerForRichRequery()&&(n=_ge("asmsbribbon_li"),n!=null&&n!=undefined&&(t=n.style,t.position="relative",t.borderRadius=this.isRtl?this.calculateBorderRadius(r.LEFT_BORDER):this.calculateBorderRadius(r.RIGHT_BORDER)))},yt.prototype.backfillRichRequery=function(){var n=t.SearchTypeUtils.isResultTypePresent("PASF",this.config.enableRichRequeryPerf),r=t.SearchTypeUtils.isResultTypePresent("PAA",this.config.enableRichRequeryPerf),i=!1;(this.config.backfillPASFEMRS||this.config.backfillPASFEMPAA)&&(i=t.SearchTypeUtils.isResultTypePresent("PASFEM",this.config.enableRichRequeryPerf));switch(!0){case this.config.backfillPAARS:this.paaTriggerBackfillRichRequery(r,n,i);break;case this.config.prioritizePAAMinWords>0&&this._currentQuery&&this._currentQuery.trim().length!==0&&this._currentQuery.split(" ").length>=this.config.prioritizePAAMinWords:this.paaTriggerBackfillRichRequery(r,n,i);break;case this.config.prioritizePAAInterrogative&&this._currentQuery&&this._currentQuery.trim().length!==0&&this._currentQuery[this._currentQuery.length-1]==="?":this.paaTriggerBackfillRichRequery(r,n,i);break;case this.config.backfillPASFEMPAA&&!i&&n:this.config.enabledSearchTypes=["RS","PASF"];this.config.maxSuggestionsToShow=[3,5];break;case this.config.backfillPASFEMPAA&&!i&&!n:this.config.enabledSearchTypes=["RS","PAA"];this.config.maxSuggestionsToShow=[3,3];break;case this.config.backfillPASFEMRS:this.paaTriggerBackfillRichRequery(r,n,i);break;case!n:this.config.enabledSearchTypes=["RS","PAA"];this.config.maxSuggestionsToShow=[3,2]}},yt.prototype.serverGPCbackfillRichRequery=function(){var i=t.SearchTypeUtils.isResultTypePresent("PASF",this.config.enableRichRequeryPerf),n=t.SearchTypeUtils.isResultTypePresent("PAA",this.config.enableRichRequeryPerf);switch(!0){case i:this.config.enabledSearchTypes=["PASF"];this.config.maxSuggestionsToShow=[5];break;case n&&this.config.prioritizePAAMinWords>0&&this._currentQuery&&this._currentQuery.trim().length!==0&&this._currentQuery.split(" ").length>=this.config.prioritizePAAMinWords:this.config.enabledSearchTypes=["PAA"];this.config.maxSuggestionsToShow=[3];break;case n&&this.config.prioritizePAAInterrogative&&this._currentQuery&&this._currentQuery.trim().length!==0&&this._currentQuery[this._currentQuery.length-1]==="?":this.config.enabledSearchTypes=["PAA"];this.config.maxSuggestionsToShow=[3];break;default:this.config.enabledSearchTypes=["RS"];this.config.maxSuggestionsToShow=[3]}},yt.prototype.paaTriggerBackfillRichRequery=function(n,t,i){switch(!0){case n&&i:this.config.enabledSearchTypes=["PAA","PASFEM"];this.config.maxSuggestionsToShow=[3,5];break;case n&&t:this.config.enabledSearchTypes=["PAA","PASF"];this.config.maxSuggestionsToShow=[3,5];break;case!n&&i:this.config.enabledSearchTypes=["RS","PASFEM"];this.config.maxSuggestionsToShow=[3,5];break;case!n&&t:this.config.enabledSearchTypes=["RS","PASF"];this.config.maxSuggestionsToShow=[3,5];break;case n:this.config.enabledSearchTypes=["PAA","RS"];this.config.maxSuggestionsToShow=[3,3];break;case!t:this.config.enabledSearchTypes=["RS","PAA"];this.config.maxSuggestionsToShow=[3,3]}},yt.prototype.showSearchType=function(n,t,r,u,f){var o,e;if(u===void 0&&(u=[]),o=this.addOtherSuggesstionsOnASPanel(t,f),o!==undefined)for(this.hasAsExpanded=!0,this.isBNorrClassPresent=document.body.classList.contains("b_norr"),this.config.enableAsPanelExpansion&&this.isBNorrClassPresent&&i.RemoveClassName(document.body,at),this.insertAjaxResponseDivIntoDom(r?r:this.container,o,f.reduce(function(n,t){return n+t},0),n),e=0;e<t.length;++e)this.buildSuggestions(u,t[e]);else this.updateSearchBoxExpansionClasses(!1),this.config.enableAsPanelExpansion&&this.isBNorrClassPresent&&i.AddClassName(document.body,k)},yt.prototype.shouldMoveTrendingNowToRight=function(){var n=_d.querySelectorAll("#sa_requery.ra_drw");return n===undefined||(n===null||n===void 0?void 0:n.length)===0?!1:this.isQueryNullOrWhiteSpace()},yt.prototype.isQueryNullOrWhiteSpace=function(){var n;return this._currentQuery===""||this._currentQuery!==undefined&&((n=this._currentQuery)===null||n===void 0?void 0:n.trim())===""},yt.prototype.rqspresent=function(){if(!this.config.enableGPCRequeryExpandedPane)return!1;var n=_d.querySelectorAll("#sa_gpcrequery.sa_drw");return n===undefined||(n===null||n===void 0?void 0:n.length)===0?!1:(this.hasAsExpanded=!0,!0)},yt.prototype.addOtherSuggesstionsOnASPanel=function(n,t){var f,r="",i;for(this.rsCnt=0,this.pasfCnt=0,this.paaCnt=0,i=0;i<n.length;++i){var e=this.getSuggestionsAndLabel(n[i],t[i]),u=e[0],o=e[1];u&&u.length!==0&&(r+=o+u)}return r&&r.length!==0&&(f=this.createDivFromAjaxResponse("<div class='sa_drw' id='sa_requery'>".concat(r,"<\/div>"))),f},yt.prototype.getSuggestionsAndLabel=function(n,i){if(typeof t.SearchTypeUtils=="undefined")return["",""];var e="",u="",f="",r;switch(n){case l.RS:r=t.SearchTypeUtils.getRsSuggestions(this._previousQuery,this._currentQuery,i,this.currentSuggestionList,this.config.asrschat,this.config.maxRSSuggLenLimitRichRequery,this.config.enableRichRequeryPerf,this.config.enableRichRequeryFitNFinish);e=r===null||r===void 0?void 0:r.suggestions;f="rs_tx";u=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.RelatedSearches)||"Related Searches";this.config.enableRichRequeryFitNFinish&&(u=u.toUpperCase(),f="rs_tx rs_tx_fnf");this.rsCnt=r===null||r===void 0?void 0:r.sugCount;break;case l.PAA:r=t.SearchTypeUtils.getPaaAnswers(this._previousQuery,this._currentQuery,i,this.config.hitHighlightPaa,this.currentSuggestionList,this.config.aspaachat,this.config.maxPAASuggLenLimitRichRequery,this.config.enableRichRequeryPerf,this.config.enableRichRequeryFitNFinish);e=r===null||r===void 0?void 0:r.suggestions;f="paa_tx";u=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.PeopleAlsoAsk)||"People Also Ask";this.config.enableRichRequeryFitNFinish&&(u=u.toUpperCase(),f="paa_tx paa_tx_fnf");this.paaCnt=r===null||r===void 0?void 0:r.sugCount;break;case l.PASF:r=t.SearchTypeUtils.getPASFData(this._previousQuery,this._currentQuery,i,this.currentSuggestionList,this.config.rrboxshadow,this.config.enableRichRequeryPerf,this.config.enableRichRequeryFitNFinish);e=r===null||r===void 0?void 0:r.suggestions;f="pasf_tx";u=(sa_loc===null||sa_loc===void 0?void 0:sa_loc.PeopleAlsoSearchFor)||"People Also Search For";this.config.enableRichRequeryFitNFinish&&(u=u.toUpperCase(),f="pasf_tx pasf_tx_fnf");this.pasfCnt=r===null||r===void 0?void 0:r.sugCount;break;case l.PASFEM:r=t.SearchTypeUtils.getPASFEMData(this._previousQuery,this._currentQuery,i,this.currentSuggestionList,this.config.rrboxshadow,this.config.enableRichRequeryPerf,this.config.enableRichRequeryFitNFinish);e=r===null||r===void 0?void 0:r.suggestions;f="pasf_tx";u=sa_loc.PeopleAlsoSearchFor||"People Also Search For";this.config.enableRichRequeryFitNFinish&&(u=u.toUpperCase(),f="pasf_tx pasf_tx_fnf");this.pasfCnt=r===null||r===void 0?void 0:r.sugCount;break;default:e="";f="";u=""}return e===""?["",""]:[e,this._isNewDom?"<div class='".concat(f,"'><h2 class='asSectionHeading'>").concat(u,"<\/h2><\/div>"):"<h2 class='".concat(f,"'>").concat(u,"<\/h2>")]},yt.prototype.shouldShowOtherSuggestions=function(){var n=_d.querySelectorAll("#sa_ul li");return n===undefined||n.length==0?!1:(this._hasPrefixQueryBeenUpdated=this._previousQuery==""||this._hasPrefixQueryBeenUpdated||this._previousQuery!==undefined&&this._previousQuery!==this._currentQuery,!this._hasPrefixQueryBeenUpdated)},yt.prototype.getSuggestionsContainer=function(n){return n&&n.length>0?n[0]:null},yt.prototype.setSuggestionContainerToBuild=function(n){var i,r;this._suggestionsContainer=null;n=n==t.DataSources.MicrosoftSearchInBingCached||n==t.DataSources.BingAtWork?t.DataSources.MicrosoftSearchInBingCached:n;n=n==t.DataSources.MicrosoftSearchInBing||n==t.DataSources.SubstrateSuggestionsForEnterprise?t.DataSources.MicrosoftSearchInBing:n;switch(n){case t.DataSources.Web:this.rqsPresent?(i=_d.querySelectorAll(".sa_as"),this._suggestionsContainer=this.getSuggestionsContainer(i)):this._suggestionsContainer=_ge(this.config.slid);break;case t.SearchTypeUtils.RelatedSearch:i=_d.querySelectorAll(".sa_as .rs_drw");this._suggestionsContainer=this.getSuggestionsContainer(i);break;case t.SearchTypeUtils.PeopleAlsoAsk:i=_d.querySelectorAll(".sa_as .paa_drw");this._suggestionsContainer=this.getSuggestionsContainer(i);break;case t.SearchTypeUtils.PeopleAlsoSearchFor:i=_d.querySelectorAll(".sa_as .pasf_rich_drw");this._suggestionsContainer=this.getSuggestionsContainer(i);break;case t.SearchTypeUtils.PeopleAlsoSearchForExploreMore:i=_d.querySelectorAll(".sa_as .pasf_rich_drw");this._suggestionsContainer=this.getSuggestionsContainer(i);break;case t.SearchTypeUtils.TrendingNowOnRight:i=_d.querySelectorAll("#sa_requery.ra_drw");this._suggestionsContainer=this.getSuggestionsContainer(i);break;case t.DataSources.MicrosoftSearchInBingCached:this.msbNonHistorySuggestions=0;i=_d.querySelectorAll("[data-region=".concat(c,"]"));i&&i.length>0?(r=i.length,this._suggestionsContainer=i[r-1]):this.config.isANtp&&(this._suggestionsContainer=_ge(this.config.slid));break;case t.DataSources.MicrosoftSearchInBing:i=_d.querySelectorAll("[data-region=".concat(c,"]"));i&&i.length>0?(r=i.length,this._suggestionsContainer=i[r-1]):this.config.isANtp&&(this._suggestionsContainer=_ge(this.config.slid));break;default:this._suggestionsContainer=_ge(this.config.slid)}},yt.prototype.isSuggestionHistory=function(n){var t,i;return((t=n.url)===null||t===void 0?void 0:t.indexOf("qs=HS"))!=-1||((i=n.url)===null||i===void 0?void 0:i.indexOf("asbe=HS"))!=-1},yt.prototype.buildSuggestions=function(n,r){var w=this,s,l,a,v,y,p,f,e;if(this._nextWordRawQuerySize=null,this._largestSuggestion=0,this._nextWordRawQuerySize=1e4,this.containsNextWord=!1,this.mnwSuggestionsCount=0,p=!1,this.setSuggestionContainerToBuild(r),this._suggestionsContainer){f=null;f=r==t.DataSources.MSBEngagment?this.config.isANtp?[_ge("asmsbribbon_li")]:_d.querySelectorAll("li#asmsbribbon_li"):this._suggestionsContainer.getElementsByTagName("li");var k=10,nt=this.currentSuggestionList.length,b=f.length;this.msbNonHistorySuggestions=(r===t.DataSources.MicrosoftSearchInBingCached||r===t.DataSources.BingAtWork)&&this._suggestionsContainer.id=="sa_baw"?b:this.msbNonHistorySuggestions;var it=r==t.DataSources.MicrosoftSearchInBing||r==t.DataSources.SubstrateSuggestionsForEnterprise?this.msbNonHistorySuggestions:0,rt=function(r){var e=f[r],it=void 0,b,rt,ut,ft,et;if(u._isNewDom&&(it=(s=e.parentNode)===null||s===void 0?void 0:s.parentNode),b=e.parentNode,b&&b.id!==u.config.slid&&b.id!=="sa_exp_sug"&&!b.getAttribute(h)&&b.className!=="sa_mnw_region"&&b.className!==t.suggestionParentClass&&(it===null||it===void 0?void 0:it.id)!==u.config.slid&&!(it===null||it===void 0?void 0:it.classList.contains(u.config.zisParent))&&(it===null||it===void 0?void 0:it.className)!=="sa_mnw_region"&&!((u.config.moveTrendingNowToRight||u.config.zisPaneexpansion)&&u.config.enableAsPanelExpansion)&&tt.indexOf(b.id)===-1)return"continue";if(e.className.indexOf("sa_hd")!=-1)return e.hd=!0,"continue";i.RewriteAttribsToProps(e,[o.Url,o.Query,o.Type,o.Autocomplete,o.RequestGuid,o.AdQuery,o.GhostingText]);u.config.zisr1>0&&t.ZisRankableBanners.indexOf(e.stype)!=-1&&u.updateShowCount(e.stype);e.stype&&(u.isSuggestionHistory(e)?u.ariaHideSuggestionChildren(e,!0):e.ariaLabel!==null?u.ariaHideSuggestionChildren(e,!1):(u.ariaHideSuggestionChildren(e,!1),rt="",b.getAttribute("data-region")==c&&(ut=e.getElementsByClassName(vt),rt=ut.length>0?[d,ut[0].innerText,e.stype.toLowerCase(),g].join(" "):[d,e.stype.toLowerCase(),g].join(" "),u.config.enableMsbQFWorkRedirect&&(e.url=t.Utils.getMSBWorkVerticalSearchUrl(e.url),e.setAttribute("url",e.url))),e.stype.indexOf("NW")!=0||p||u.config.isMobile||u.config.iscxtab||(ft=u.isSpyGlassPresent(e),u.resizeNextWord=!ft,((a=(l=e.lastChild)===null||l===void 0?void 0:l.firstChild)===null||a===void 0?void 0:a.innerText)&&(et=e.lastChild.firstChild.innerText.indexOf("...")==0,u.isFirstNWFullEnabled=ft&&et,p=!0)),e.innerText&&(u.isFirstNWFullEnabled&&e.stype.indexOf("NW")==0?e.setAttribute("aria-label",e.innerText.substr(4)):(e.stype==="PLQ"||e.stype==="BC")&&sa_loc.NudgesAStoChatClickthrough!==null?e.setAttribute("aria-Label",sa_loc.NudgesAStoChatClickthrough+". "+e.innerText+rt):e.setAttribute("aria-label",e.innerText+rt))));e.className.indexOf("pp_tile")!=-1&&(e.panel={ot:sb_gt()});e.stype&&u.isSuggestionTypeInstrumentationDisabled(e.stype)||(e.addInst=!0);e.stype&&u.isNavigationalSuggestion(e.stype)&&(e.nav=!0);u.config.mnw&&(e.stype=="MNW"||e.stype=="MNWU"||e.stype=="MNWB"||e.stype=="MNWT"||e.stype=="MNWF")&&(u.mnwSuggestionsCount+=1);u.buildNextWordSuggestions(e);((v=e===null||e===void 0?void 0:e.ariaLabel)===null||v===void 0?void 0:v.indexOf("Clicking on this will redirect to Work Vertical"))==-1&&u.currentSuggestionList.push(e.query);((y=b===null||b===void 0?void 0:b.parentElement)===null||y===void 0?void 0:y.className)==="sa_expand"?u.decorateChildSuggestion(e,++k):u.decorateSuggestion(e,++nt);e.parentElement.classList.contains(t.suggestionParentClass)&&(sj_be(e.parentElement,"mousemove",function(n){return w.mouseOverSuggestionHandler(n,e)}),sj_be(e.nextElementSibling,"keydown",function(n){n.preventDefault();w._searchBox.dispatchEvent(new KeyboardEvent("keydown",{keyCode:n.keyCode}))}));n.push(e)},u=this;for(e=it;e<b;++e)rt(e)}},yt.prototype.ariaHideSuggestionChildren=function(n,t){for(var i,r,u,e=((r=n.children)===null||r===void 0?void 0:r.length)||0,f=0;f<e;f++)i=n.children[f],i&&(((u=i.classList)===null||u===void 0?void 0:u.contains("sa_rm"))&&t||i.setAttribute("aria-hidden","true"))},yt.prototype.buildNextWordSuggestions=function(n){var t,i;this.config.eNw&&n.stype&&n.stype.indexOf("NW")>-1&&(this.containsNextWord=!0,this.resizeNextWord&&(t=n.textContent||n.innerText,t&&(i=n.query.replace(t,""),t.length>this._largestSuggestion&&i.length<=this._nextWordRawQuerySize&&(this._largestSuggestion=t.length,this._nextWordRawQuerySize=i.length,this.largestNextWordElement=n))))},yt.prototype.isSuggestionTypeInstrumentationDisabled=function(n){for(var r,t=0,i=rt;t<i.length;t++)if(r=i[t],r===n)return!0;return!1},yt.prototype.isNavigationalSuggestion=function(n){for(var r,t=0,i=ut;t<i.length;t++)if(r=i[t],r===n)return!0;return!1},yt.prototype.mouseOverSuggestionHandler=function(n,i,r){var f,e,o,u;r===void 0&&(r=!1);u=t.Utils.GetMouseCoords(n);i.url&&this._previousMouseCoords&&(this._previousMouseCoords.x!=u.x||this._previousMouseCoords.y!=u.y)?(this._previousMouseCoords=u,i.className.indexOf(a)==-1&&(this._enteredChildSuggestionPane=r,r&&(this._mainLIElement=(e=(f=i===null||i===void 0?void 0:i.parentElement)===null||f===void 0?void 0:f.parentElement)===null||e===void 0?void 0:e.parentElement,this._richCardHighlight=i&&((o=i.parentElement)===null||o===void 0?void 0:o.id)==="rich_card"?!0:!1),this.highlightSuggestion(i))):this._previousMouseCoords=this._previousMouseCoords||u},yt.prototype.decorateChildSuggestion=function(n,i){var r=this;n.src=n.stype;n.ord=i;sj_be(n,"mousedown",function(t){r.cancelEventBubbling(t);r.onMouseDownSuggestion(t,n)});sj_be(n,"mouseup",function(t){r.cancelEventBubbling(t);r.onMouseUpSuggestion(t,n)});n.addEventListener("mousemove",function(t){r.cancelEventBubbling(t);r.mouseOverSuggestionHandler(t,n,!0)});n.addEventListener("mouseover",function(i){r.cancelEventBubbling(i);var u=t.Utils.MouseEnterLeave(function(t){return r.mouseOverSuggestionHandler(t,n,!0)},n);u(i)})},yt.prototype.decorateSuggestion=function(n,i){var r=this,u;n.src=n.stype;n.ord=i;sj_be(n,"mousemove",function(t){r.mouseOverSuggestionHandler(t,n)});sj_be(n,"mouseover",function(i){var u=t.Utils.MouseEnterLeave(function(t){return r.mouseOverSuggestionHandler(t,n)},n);u(i)});sj_be(n,"mousedown",function(t){return r.onMouseDownSuggestion(t,n)});sj_be(n,"mouseup",function(t){r.cancelEventBubbling(t);r.onMouseUpSuggestion(t,n)});u=window.navigator.msPointerEnabled?"onMSPointerDown":"ontouchstart";u.toLowerCase()in _w&&sj_be(n,u.substr(2),function(t){if(n.it="m",t.pointerType)switch(t.pointerType){case t.MSPOINTER_TYPE_TOUCH:n.it="t";break;case t.MSPOINTER_TYPE_PEN:n.it="p"}else n.it="t"})},yt.prototype.getSearchDivIndex=function(n){for(var t=0;t<this._searchTypeDivs.length;++t)if(this._searchTypeDivs[t].className.indexOf(n)>-1)return t;return 0},yt.prototype.getTargetElementExpandZIS=function(n,i,r,f){var c,l,a,o,e,v,h;return(r===void 0&&(r=0),f===void 0&&(f=!0),a=s[i],o=u[i],n&&r>0&&this.isSuggestionElement(n))?n:n&&((c=n.classList)===null||c===void 0?void 0:c.contains(t.suggestionParentClass))&&f?this.getTargetElementExpandZIS(n.getElementsByTagName("LI")[0],i,r+1,!0):((n===null||n===void 0?void 0:n.id)=="sa_requery"||(n===null||n===void 0?void 0:n.classList.contains(this.config.zisParent)))&&f?this.getTargetElementExpandZIS(n[o],i,r+1):(n===null||n===void 0?void 0:n.tagName)=="UL"?this.getTargetElementExpandZIS(n.parentElement,i,r+1,!1):(i!=1||n||(this.searchTypeDivIndex=0),i!=0||n||(this.searchTypeDivIndex=this._searchTypeDivs.length-1),e=n?n[a]:this._searchTypeDivs[this.searchTypeDivIndex][o],i===2?(o=u[1],this.searchTypeDivIndex++,e=this._searchTypeDivs[this.searchTypeDivIndex][o]):i===3&&(o=u[1],this.searchTypeDivIndex--,e=this._searchTypeDivs[this.searchTypeDivIndex][o]),i!=0&&!e&&(n===null||n===void 0?void 0:n.classList.contains(this.config.zisParent))||(n===null||n===void 0?void 0:n.classList.contains("as_rmhswarning")))?(n=n.parentElement,e=n[a],!e)?null:this.getTargetElementExpandZIS(e,i,r+1):e&&!e.classList.contains("sa_rm")?(((l=e.classList)===null||l===void 0?void 0:l.contains(t.suggestionParentClass))&&(e=e.getElementsByTagName("LI")[0]),(e.classList.contains(this.config.zisParent)||e.id==="sa_ul"||e.id=="sa_requery")&&(o=="firstChild"?e=e.getElementsByTagName("UL")[0]:(v=e.getElementsByTagName("UL").length,e=e.getElementsByTagName("UL")[v-1])),this.isSuggestionElement(e)?e:this.getTargetElementExpandZIS(e[o],i,r+1,!0)):n?(h=n.parentElement,h.id==="sw_as")?null:h.parentElement.id=="sw_as"?null:this.getTargetElementExpandZIS(h,i,r+1,!1):null},yt.prototype.getTargetElementExpandAs=function(n,i,r){var l,a,v,p,e,y;r===void 0&&(r=0);var w=s[i],o=u[i],f=n?n[w]:this._searchTypeDivs[this.searchTypeDivIndex][o];return i===2?(o=u[1],this.searchTypeDivIndex++,f=this._searchTypeDivs[this.searchTypeDivIndex][o]):i===3&&(o=u[1],this.searchTypeDivIndex--,f=this._searchTypeDivs[this.searchTypeDivIndex][o]),f?(((l=f.classList)===null||l===void 0?void 0:l.contains(t.suggestionParentClass))&&(f=f.getElementsByTagName("LI")[0]),p=f.getAttribute(h),p&&f.innerHTML||this._isNewDom&&f.tagName==="UL"?(f=f[o],this.isSuggestionElement(f)||(f=this.getTargetElementExpandAs(f,i,r+1))):this.isSuggestionElement(f)||(f=((a=f.classList)===null||a===void 0?void 0:a.contains("sa_rm"))?this.getTargetElementExpandAs(f.parentElement,i,r+1):this.getTargetElementExpandAs(f,i,r+1))):this._currentSuggestion&&(e=this._currentSuggestion.parentElement,e.getAttribute("data-region")&&e.getAttribute("data-region")===c&&r<2?f=this.getTargetElementExpandAs(e,i,r+1):this._isNewDom&&e.tagName==="UL"&&r<2?f=this.getTargetElementExpandAs(e,i,r+1):e!=n&&((v=e.classList)===null||v===void 0?void 0:v.contains(t.suggestionParentClass))?f=this.getTargetElementExpandAs(e,i,r+1):(this.searchTypeDivIndex=this.getSearchDivIndex(e.className),y=!1,this.searchTypeDivIndex===this._searchTypeDivs.length-1&&i===1&&(y=!0),this.searchTypeDivIndex=(this.searchTypeDivIndex+this._searchTypeDivs.length+(i===1?1:-1))%this._searchTypeDivs.length,this.unHighlightSuggestionHandler(),f=y?undefined:this.getTargetElementExpandAs(null,i,r+1))),f},yt.prototype.getTargetElementEASEArrow=function(n,t,i,r){var c,l,a,v,p,h,o,w,y;if(i===void 0&&(i=0),r===void 0&&(r=!0),this._searchTypeDivs===undefined&&(this._searchTypeDivs=_d.querySelectorAll(".sa_as .sa_drw")),n&&(n===null||n===void 0?void 0:n.tagName)==="LI"&&((c=n.parentElement)===null||c===void 0?void 0:c.id)!=undefined&&e[(l=n.parentElement)===null||l===void 0?void 0:l.id]!=undefined&&(this.searchTypeDivIndex=e[n.parentElement.id]),p=((a=n===null||n===void 0?void 0:n.parentElement)===null||a===void 0?void 0:a.id)==="sa_exp_sug"?ft[t]:s[t],h=((v=n===null||n===void 0?void 0:n.parentElement)===null||v===void 0?void 0:v.id)==="sa_exp_sug"?f[t]:u[t],n&&i>0&&this.isSuggestionElement(n))return this._searchTypeDivs=undefined,n;if(n&&(n===null||n===void 0?void 0:n.tagName)=="DIV"&&r)return this.getTargetElementEASEArrow(n[h],t,i+1,!0);if((n===null||n===void 0?void 0:n.tagName)=="UL"&&r)return this.getTargetElementEASEArrow(n,t,i+1,!1);if(o=n?n[p]:this._searchTypeDivs[this.searchTypeDivIndex][h],t===2){if(!this._enteredChildSuggestionPane&&!this.checkWhetherEASEChildSuggestionsArePresent(n)&&!this._richCardHighlight)return n;this._enteredChildSuggestionPane?(this._richCardHighlight&&(this._enteredChildSuggestionPane=!1,this._richCardHighlight=!1,this.searchTypeDivIndex--,o=this._mainLIElement),this._richCardHighlight||o||(h=f[2],o=this._searchTypeDivs[this.searchTypeDivIndex][h])):(h=u[1],this.searchTypeDivIndex++,this._enteredChildSuggestionPane=!0,this._richCardHighlight=!0,this._currentSuggestion&&(this._mainLIElement=this._currentSuggestion),o=this._searchTypeDivs[this.searchTypeDivIndex][h])}else if(t===3){if(!this._enteredChildSuggestionPane&&!this.checkWhetherEASEChildSuggestionsArePresent(n)&&!this._richCardHighlight)return n;this._richCardHighlight?(this._enteredChildSuggestionPane=!1,this._richCardHighlight=!1,this.searchTypeDivIndex--,o=this._mainLIElement):this._enteredChildSuggestionPane&&!o?(h=f[3],o=this._searchTypeDivs[this.searchTypeDivIndex][h]):this._enteredChildSuggestionPane||(h=u[1],this.searchTypeDivIndex++,this._enteredChildSuggestionPane=!0,this._richCardHighlight=!0,this._currentSuggestion&&(this._mainLIElement=this._currentSuggestion),o=this._searchTypeDivs[this.searchTypeDivIndex][h])}else t===1?this._richCardHighlight?(this._richCardHighlight=!1,this.searchTypeDivIndex++,h=f[2],o=this._searchTypeDivs[this.searchTypeDivIndex][h]):this._enteredChildSuggestionPane&&(this._richCardHighlight=!0,this.searchTypeDivIndex--,h=f[3],o=this._searchTypeDivs[this.searchTypeDivIndex][h]):t===0&&this._enteredChildSuggestionPane&&(this._richCardHighlight?(this._richCardHighlight=!1,this.searchTypeDivIndex++,h=f[2],o=this._searchTypeDivs[this.searchTypeDivIndex][h]):(this._richCardHighlight=!0,this.searchTypeDivIndex--,h=f[3],o=this._searchTypeDivs[this.searchTypeDivIndex][h]));return(o&&!this.isSuggestionElement(o)&&(o=this.getTargetElementEASEArrow(o,t,i+1)),o&&!o.classList.contains("sa_rm"))?((o.classList.contains(this.config.zisParent)||o.id==="sa_ul"||o.id=="sa_exp_sug")&&(h=="firstChild"?o=o.getElementsByTagName("UL")[0]:(w=o.getElementsByTagName("UL").length,o=o.getElementsByTagName("UL")[w-1])),this.isSuggestionElement(o)?(this._searchTypeDivs=undefined,o):this.getTargetElementEASEArrow(o[h],t,i+1,!0)):n?(y=n.parentElement,y.id==="sw_as")?null:this.getTargetElementEASEArrow(y,t,i+1,!1):null},yt.prototype.getTargetElementEASETab=function(n,i,r,f){var a,v,y,p,w,b,h,o,k,c,l;return(r===void 0&&(r=0),f===void 0&&(f=!0),this._searchTypeDivs===undefined&&(this._searchTypeDivs=_d.querySelectorAll(".sa_as .sa_drw")),n&&(n===null||n===void 0?void 0:n.tagName)==="LI"&&((a=n.parentElement)===null||a===void 0?void 0:a.id)!=undefined&&e[(v=n.parentElement)===null||v===void 0?void 0:v.id]!=undefined&&(this.searchTypeDivIndex=e[n.parentElement.id]),b=s[i],h=u[i],n&&r>0&&this.isSuggestionElement(n))?(this._searchTypeDivs=undefined,n):n&&((p=(y=n.parentElement)===null||y===void 0?void 0:y.classList)===null||p===void 0?void 0:p.contains(t.suggestionParentClass))&&f?this.getTargetElementEASETab(n.parentElement,i,r+1,!1):n&&(n===null||n===void 0?void 0:n.tagName)=="DIV"&&f?this.getTargetElementEASETab(n.getElementsByTagName("LI")[0],i,r+1,!0):(n===null||n===void 0?void 0:n.classList.contains("sa_expand"))&&f?this.getTargetElementEASETab(n[h],i,r+1):(n===null||n===void 0?void 0:n.tagName)=="UL"?n.parentElement.className=="sa_expand"?(++this.searchTypeDivIndex,n=n.parentElement,this.getTargetElementEASETab(n[b],i,r+1,!0)):this.getTargetElementEASETab(n.parentElement,i,r+1,!1):(o=n?n[b]:this._searchTypeDivs[this.searchTypeDivIndex][h],o&&!this.isSuggestionElement(o)&&(o=this.getTargetElementEASETab(o,i,r+1)),i===2?(h=u[1],this.searchTypeDivIndex++,this._enteredChildSuggestionPane=!0,this._currentSuggestion&&(this._mainLIElement=this._currentSuggestion),o=this._searchTypeDivs[this.searchTypeDivIndex][h]):i===3&&(this._enteredChildSuggestionPane=!1,this.searchTypeDivIndex--,o=this._mainLIElement),o&&!o.classList.contains("sa_rm"))?((o.classList.contains(this.config.zisParent)||o.id==="sa_ul"||o.id=="sa_exp_sug")&&(h=="firstChild"?o=o.getElementsByTagName("UL")[0]:(k=o.getElementsByTagName("UL").length,o=o.getElementsByTagName("UL")[k-1])),this.isSuggestionElement(o)?(this._searchTypeDivs=undefined,o):this.getTargetElementEASETab(o[h],i,r+1,!0)):n?(c=n.parentElement,l=c===null||c===void 0?void 0:c.parentElement,c.id==="sw_as")?null:l&&l.className==="sa_expand"&&this.searchTypeDivIndex==this._searchTypeDivs.length-1?(this.searchTypeDivIndex=this._searchTypeDivs.length-((w=l.querySelectorAll(".sa_drw"))===null||w===void 0?void 0:w.length),this.getTargetElementEASETab(l,i,r+1,!0)):this.getTargetElementEASETab(c,i,r+1,!1):null},yt.prototype.getTargetElement=function(n,i){var e,o,c,l,y=s[i],a=u[i],r=n?n[y]:_ge(this.config.slid)[a],v,f;if(r){if(r.classList.contains(this.config.zisParent)&&(r=r.getElementsByTagName("UL")[0]),(e=r.classList)===null||e===void 0?void 0:e.contains("sa_rm"))return this.getTargetElement(r.parentElement,i);((o=r.classList)===null||o===void 0?void 0:o.contains(t.suggestionParentClass))&&(r=r.getElementsByTagName("LI")[0]);v=r.getAttribute(h);v&&r.innerHTML||this._isNewDom&&r.tagName==="UL"?(r=r[a],((c=r.classList)===null||c===void 0?void 0:c.contains(t.suggestionParentClass))&&(r=r.getElementsByTagName("LI")[0]),this.isSuggestionElement(r)||(r=this.getTargetElement(r,i))):this.isSuggestionElement(r)||(r=this.getTargetElement(r,i))}else this._currentSuggestion&&(f=this._currentSuggestion.parentNode,this.unHighlightSuggestionHandler(),f===n&&((l=f.classList)===null||l===void 0?void 0:l.contains(t.suggestionParentClass))&&(f=f.parentNode),f.classList.contains("sa_nestedList")?r=this.getTargetElement(f.parentNode,i):(f.getAttribute(h)||this._isNewDom&&f.tagName==="UL"||f.classList.contains(this.config.zisParent)||f.classList.contains(t.suggestionParentClass))&&(r=this.getTargetElement(f,i)));return r},yt.prototype.isSuggestionElement=function(n){return n.url&&n.tagName==="LI"},yt.prototype.selectItem=function(n){var i,r,u,t,f;t=this.isQueryNullOrWhiteSpace()?this.config.enableAsPanelExpansion?this.getTargetElementExpandZIS(this._currentSuggestion,n):this.getTargetElement(this._currentSuggestion,n):this.config.enableAsPanelExpansion&&this.hasAsExpanded?this.getTargetElementExpandAs(this._currentSuggestion,n):this.config.enableEASE?this.isQueryNullOrWhiteSpace()?this.getTargetElement(this._currentSuggestion,n):this.config.enblEASEKB?this.getTargetElementEASEArrow(this._currentSuggestion,n):this.getTargetElementEASETab(this._currentSuggestion,n):this.getTargetElement(this._currentSuggestion,n);t?(this.setSearchValue(t),this.highlightSuggestion(t,!0)):this.clearSelectedSuggestion();_ge&&(t?t.id&&((i=_ge(t.id))===null||i===void 0?void 0:i.scrollIntoView(!1)):((r=this._searchBox)===null||r===void 0?void 0:r.id)&&((u=_ge(this._searchBox.id))===null||u===void 0?void 0:u.scrollIntoView(!1)));t&&this.config.bi&&(f={currentQuery:this._currentQuery,suggestionElements:[t],requestSequence:this._currentRequestSequence},sj_evt.fire("AS.SuggestionSelected",f))},yt.prototype.isClickOnElementWithClass=function(n,t){var i=n.target;return i&&i.className.indexOf(t)>-1},yt.prototype.cancelEventBubbling=function(n){n=sj_ev(n);sj_sp(n)},yt.prototype.highlightSuggestion=function(n,i){i===void 0&&(i=!1);this.unHighlightSuggestionHandler(n);this._currentSuggestion=n;n.parentElement.className==t.suggestionParentClass?this.addHighlightClassName(this._currentSuggestion.parentElement,i):this.addHighlightClassName(this._currentSuggestion,i);this._currentSuggestion!=n&&this.addHighlightClassName(n,i);this._searchBox.setAttribute("aria-activedescendant",n.id)},yt.prototype.unHighlightSuggestionHandler=function(n){var i;n===void 0&&(n=null);this._currentSuggestion&&(((i=this._currentSuggestion.parentElement)===null||i===void 0?void 0:i.classList.contains(t.suggestionParentClass))?(this._searchBox.focus(),this.removeHighlightClassName(this._currentSuggestion.parentElement)):this.removeHighlightClassName(this._currentSuggestion),this._currentSuggestion=null)},yt.prototype.updateSearchBoxExpansionClasses=function(n){n?(i.AddClassName(this._header,p),i.AddClassName(this._searchBoxForm,p)):(i.RemoveClassName(this._header,b),i.RemoveClassName(this._searchBoxForm,b))},yt.prototype.clearSelectedSuggestion=function(){this.setSearchValue();this.unHighlightSuggestionHandler();this._searchBox.removeAttribute("aria-activedescendant")},yt.prototype.addHighlightClassName=function(n,t){t===void 0&&(t=!1);v.test(n.className)||(n.className+=" "+a);t&&(y.test(n.className)||(n.className+=" "+et))},yt.prototype.removeHighlightClassName=function(n,t){t===void 0&&(t=!1);i.RemoveClassName(n,y);i.RemoveClassName(n,v)},yt.prototype.onMouseDownSuggestion=function(n,t){n=sj_ev(n);var i=n.button;i==2?(this.cancelEventBubbling(n),sj_pd(n)):t.url&&(this.clickedSuggestion=t)},yt.prototype.modifyUrl=function(n,t){var i=n.split("q="),r=i[0];return r+"q="+t+"&"+i[1].split("&")[1]},yt.prototype.onMouseUpSuggestion=function(n,t){this.clickedSuggestion&&this.clickedSuggestion==t&&(this.config.boldEntity&&this.isClickOnElementWithClass(n,"entiybubble_a")&&(t.url=this.modifyUrl(t.url,n.target.target)),n=sj_ev(n),this.config.clickIco&&this.isClickOnElementWithClass(n,"as_icon")?this.raiseEvent(20,t,sj_et(n)):(this.config.mnw&&(t.stype=="MNW"||t.stype=="MNWU"||t.stype=="MNWB"||t.stype=="MNWT"||t.stype=="MNWF")?(this._currentQuery=this._currentQuery.substring(0,this._currentQuery.lastIndexOf(" ")+1).concat(this.clickedSuggestion.query),this.clickedSuggestion.query=this._currentQuery,this.clickedMNWSuggestionType=this.clickedSuggestion.stype,this.clickedMNWSuggestionPosition=this.config.mnwbtm?90+this.clickedSuggestion.ord-(this.currentSuggestionList.length-this.mnwSuggestionsCount):90+this.clickedSuggestion.ord,this.highlightSuggestion(this.clickedSuggestion),this.raiseEvent(25,this.clickedSuggestion)):(this.setSearchValue(this.clickedSuggestion),sj_evt.fire("AS.Navigate",t,"mouseup"),this.raiseEvent(4,t,!1,this.config.linkTarget)),this.clickedSuggestion=null))},yt.prototype.searchBoxHasFocus=function(){return typeof this._searchBox!="undefined"&&typeof this._searchBox.getRootNode=="function"?this._searchBox.getRootNode().activeElement===this._searchBox:_d.activeElement==this._searchBox},yt.prototype.setSearchValue=function(n){var t,i;this.raiseEvent(19,this.selectedSuggestion,n);this.selectedSuggestion=n;t=this._currentQuery;this.config.trimwsnr&&this._rawQuery&&this._rawQuery[this._rawQuery.length-1]==" "&&(t=t+" ");i="";n?i=n.rg?this.autoSuggestInstance.currentQuery:n.query:(i=t,this._enteredChildSuggestionPane=!1);this.raiseEvent(12,i)},yt.prototype.getCssHolder=function(){var n=_ge("ajaxStyles"),t,i;return n||(n=sj_ce("div"),n.id="ajaxStyles",t=_ge("srchfrm"),i=t!=null&&typeof t.getRootNode!="undefined"&&t.getRootNode(),i&&i!=_d&&t?t.appendChild(n):sj_b.insertBefore(n,sj_b.firstChild)),n},yt.prototype.insertScriptIntoDom=function(n){var r=this,t=sj_ce("script"),i;t.type=n.type;i=n.getAttribute("src");i?t.setAttribute("src",i):(t.setAttribute("data-bing-script","1"),t.text=n.innerHTML);n.parentNode.removeChild(n);this._asContainer.appendChild(t);sb_st(function(){r._asContainer.contains(t)&&r._asContainer.removeChild(t)},1)},yt.prototype.insertStyleIntoDom=function(n){this._ie9orLower?(sj_ic(n.innerHTML),n.parentNode.removeChild(n)):(n.setAttribute("data-rms","1"),this.autoSuggestInstance.config.bi&&t.Utils.AddClassName(n,"bi_preserve"),this.getCssHolder().appendChild(n))},yt.prototype.createDivFromAjaxResponse=function(n){if(!n)return undefined;var t=sj_ce("div");return t.innerHTML=n,t},yt.prototype.setLowConfidenceWebSignal=function(n){this.config.isLowConfidenceWeb=!1;var t=n===null||n===void 0?void 0:n.childNodes[0];(t===null||t===void 0?void 0:t.hasAttribute("data-lowconfweb"))&&(this.config.isLowConfidenceWeb=!0)},yt.prototype.insertAjaxResponseDivIntoDom=function(n,t,i){var e,u,f,s,l;if(t){for(var r=_d.createDocumentFragment(),h=t.childNodes,o=!1,c=!1;h.length;){u=h[0];switch(u.tagName){case"SCRIPT":this.insertScriptIntoDom(u);break;case"STYLE":this.insertStyleIntoDom(u);break;default:i===null||i>0?(u.id==="bawh"&&(o=!0),u.id==="bawuh"&&(c=!0,this.handleDuplicatesForAADUserHistory(n,u)),r.appendChild(u),i!=null&&i--):t.removeChild(u)}}if(f=n.getElementsByClassName("sa_drw sa_gpcrqy"),c?(n.firstElementChild&&((e=n.firstElementChild.classList)===null||e===void 0?void 0:e.contains("sa_drw_zis"))&&(n=n.firstElementChild),this.config.msbSectionSuppressed&&this.isQueryNullOrWhiteSpace()?n.appendChild(r):this.config.zisHistoryAfterPn&&this.isQueryNullOrWhiteSpace()&&n.childElementCount>=2?n.insertBefore(r,n.childNodes[1]):n.insertBefore(r,n.firstElementChild)):this.config.webMsbQFRanking&&o&&this.config.isLowConfidenceWeb?(s=n.firstElementChild,s.id==="bawuh"?n.insertBefore(r,s.nextSibling):n.insertBefore(r,n.firstChild)):this.hasAsExpanded&&this.rqspresent&&f!=null&&f.length>0&&r.getElementById("sa_requery")!=null?f[0].appendChild(r):this.hasAsExpanded&&_ge("as_foot")!=null?(l=_ge("as_foot"),n.insertBefore(r,l)):n.appendChild(r),this._suggestionsQueue.Web&&this._suggestionsQueue.Web.rendered&&this._suggestionsQueue.MSBC&&!this._suggestionsQueue.MSBC.rendered)this.autoSuggestInstance.onHighConfidencePromoted(o&&this.config.isLowConfidenceWeb)}},yt.prototype.handleDuplicatesForAADUserHistory=function(n,t){var f,e,o,s,h,c,l,r,i,u;if(n&&(!this._isNewDom||n.firstChild)&&t)for(l=t.childNodes,r=this._isNewDom?((f=n.firstChild)===null||f===void 0?void 0:f.classList.contains("sa_hd"))?(o=(e=n.firstChild)===null||e===void 0?void 0:e.nextSibling)===null||o===void 0?void 0:o.childNodes:n.firstChild.childNodes:n.childNodes,i=0;i<r.length;i++)for(u=0;u<l.length;u++)((s=r[i])===null||s===void 0?void 0:s.getAttribute("query"))!=null&&((h=r[i])===null||h===void 0?void 0:h.getAttribute("query"))==((c=l[u])===null||c===void 0?void 0:c.getAttribute("query"))&&(r[i].parentElement.removeChild(r[i]),this.currentSuggestionList[i]&&this.currentSuggestionList.splice(i,1))},yt.prototype.isSpyGlassPresent=function(n){return n.firstChild&&n.firstChild.className?n.firstChild.className==="sa_sg_icon_area":!1},yt.prototype.updateShowCount=function(n){var r,e=t.Utils.getItem(n),u,f,i;try{e?(i=JSON.parse(e),u=t.Utils.checkIfValidNumber(i.value)?i.value+1:1,f=(r=i.expiry)!==null&&r!==void 0?r:0):(u=1,f=0);t.Utils.setItem(n,u,f)}catch(o){t.Utils.setItem(n,1,0)}},yt}(t.EventRegisterer);t.Canvas=it})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i="sa_nw",r=/(\s|^)sa_nw/g,u="sa_msn_nw",f=/(\s|^)sa_msn_nw/g,t=36,e=function(){function e(t,i,r){this.config=t;this._container=i;this._canvas=r;this._isRtl=n.Utils.GetComputedStyle(sj_b).direction=="rtl";this._isRtl&&this._container.setAttribute("dir","rtl");var u=document.querySelector(".sa_as");this._searchBoxElem=_ge(t.i);this._outerContainer=u?u:sj_ce("div","","sa_as");this._outerContainer.setAttribute("data-priority","2");this._outerContainer.setAttribute("aria-live","polite");this.hide();this._container.appendChild(this._outerContainer)}return e.prototype.getSuggestionsDrawer=function(){return this._outerContainer},e.prototype.show=function(){this._outerContainer.style.display="block"},e.prototype.hide=function(){this._outerContainer.style.display="none"},e.prototype.setMargin=function(n,i){var r=0,u=0;return this.config.searchBoxSpyglass&&(r=this._isRtl?t:t*-1,u=this._isRtl?t*-1:t),this._isRtl?[i+u,n+r]:[n+u,i+r]},e.prototype.update=function(){var l,t,o,e=n.Utils.GetComputedStyle(this._container.parentNode),a,v,h;if(this.config.eNw&&this._canvas.resizeNextWord&&this._canvas.containsNextWord&&this._canvas.largestNextWordElement){this.setMargins(0,0);a=n.Utils.GetComputedStyle(this._searchBoxElem);sj_evt.fire("AS.Layout.NextWord.Show");n.Utils.AddClassName(this._outerContainer,i);this.config.enforceMsnNWStyle&&n.Utils.AddClassName(this._outerContainer,u);v=this._outerContainer.style.display;this.setCanvasVisibility("hidden","block");var s=this._canvas.largestNextWordElement,y=n.Utils.GetTextContent(s),c=this.getFirstChild(s),w=s.query.replace(y,""),b=c&&c.innerHTML.indexOf("<strong>")>-1,k=n.Utils.CalcWidth(s,c&&c.textContent||y,null,b),d=n.Utils.CalcWidth(s,w,a.fontSize);this.config.IsBingPrivate&&(h=_ge("as_foot"),t!=0||o!=0?h!=null&&(h.style.display="none"):h!=null&&(h.style.display="list-item"));var g=_ge(this.config.f)?_ge(this.config.f).offsetWidth:Number.MAX_VALUE,nt=_ge("sa_ul")?_ge("sa_ul").offsetWidth:Number.MAX_VALUE,p=document.querySelector("#sb_form .b_logoArea"),tt=p?p.offsetWidth:0;t=Math.min(d+4,g-(nt+tt+12));o=this._outerContainer.offsetWidth-t-k-this.getNwExtraSz(s)-4;l=this.setMargin(t,o);t=l[0];o=l[1];this.setCanvasVisibility("",v)}else sj_evt.fire("AS.Layout.NextWord.Hide"),n.Utils.RemoveClassName(this._outerContainer,r),this.config.enforceMsnNWStyle&&n.Utils.RemoveClassName(this._outerContainer,f),this._isRtl?(o=(this.toFloat(e.paddingRight)+this.toFloat(e.borderRightWidth))*-1,t=this.toFloat(e.borderLeftWidth)-this.toFloat(e.paddingLeft)):(t=(this.toFloat(e.paddingLeft)+this.toFloat(e.borderLeftWidth))*-1,o=this.toFloat(e.borderRightWidth)-this.toFloat(e.paddingRight));this.setMargins(t,o);this._searchBoxElem!=null&&this._searchBoxElem.dir.length>0&&(this._outerContainer.dir=this._searchBoxElem.dir)},e.prototype.toFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t},e.prototype.setCanvasVisibility=function(n,t){this._outerContainer.style.visibility=n;this._outerContainer.style.display=t},e.prototype.setMargins=function(n,t){this._container.style.marginLeft=n+"px";this._container.style.marginRight=t+"px"},e.prototype.getFirstChild=function(n){return n&&n.childNodes&&n.childNodes.length>0&&n.childNodes[0]},e.prototype.getNwExtraSz=function(t){var r=this.getFirstChild(t),i;return r?(i=n.Utils.GetComputedStyle(r),this.toFloat(i.marginLeft)*2+this.toFloat(i.borderLeft)+this.toFloat(i.borderRight)):0},e}();n.Layout=e})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){function h(n){return typeof n=="number"?n:'"'+n.replace(/"/g,'\\"')+'"'}var c="SRCHHPGUSR",l="AS",u=4,t="AS.CurrentImpressionQuerySelected",f="AS.GlobalShowDropDown",e="bawh",i=sb_ie&&sb_de.style.opacity===undefined,o=-1,r=!1,s,a=function(a){function v(t,i,u){var f=a.call(this)||this,e,s,h;for(f.config=t,f.autosuggest=i,f.internalEventTrigger=u,f._pollInterval=0,f._pendingRequestCount=0,f._bRequeryOnTextChange=!0,f._hiddenFields=[],f._lastQuery="",f._lastRawQuery="",f._lastPSCQuery="",f._showAsdropdown=!0,f._trimRegex=new RegExp("^\\s*","g"),f._removeSpacesRegex=new RegExp("\\s+","g"),f._lastTextChanged="",f._textChangeSequence=0,f._isSearchBoxWebComponent=!1,f._asContainer=f.getContainer(),f.debounceTimeout=null,f.debounceDelay=40,f.focusHistory=function(n){var t=_ge("as_foot");if(t&&t.style.display!="none"){f.autosuggest.canvas.clearSelectedSuggestion();f.autosuggest.canvas.searchTypeDivIndex=0;var i=t.querySelector(".as_rmhswarning.out_fd_side a"),u=t.querySelector(".as_bpr.as_bprtxt a"),r=i?i:u;if(r!=null){r.focus();n.preventDefault();return}}f.hideDropDownOnFocusChange()},f.onBlur=function(){var n=!_ge("fbpgdg");n&&document.activeElement.id=="sd_fdb"&&(f.autosuggest.canvas.clearSelectedSuggestion(),f.hideDropDownOnFocusChange(),_ge("sb_form_q").focus())},f.focusFeedback=function(n){var t=_ge("sb_fdb");if(t&&t.style.display!="none"){f.autosuggest.canvas.clearSelectedSuggestion();f.autosuggest.canvas.searchTypeDivIndex=0;t.focus();t.onblur=f.onBlur;n.preventDefault();return}f.hideDropDownOnFocusChange()},f.onScrollHandler=function(){f.searchBox&&f._asSubContainer&&(f.searchBox.blur(),sj_ue(f._asSubContainer,"scroll",f.onScrollHandler))},f.searchBoxTouchAction=function(){f.config.handleClickOnly||f.config.handleDuplicateFetch&&f._lastClickQuery==f.getCurrentQuery(!0)||(f.autosuggest.canvas.searchBoxHasFocus()||f.searchBox.focus(),f.onSearchBoxClick(),f._lastClickQuery=f.getCurrentQuery(!0))},f.addSearchBoxLeftSpyglass=function(){var n=_ge("sb_leftsg"),t;n||(n=sj_ce("div","sb_leftsg"),n.style.display="none",f.searchBox.parentNode.insertBefore(n,f.searchBox));n.innerHTML===""&&(t='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 25 25"><path stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M23.75 23.75l-9-9"><\/path><circle stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" cx="9" cy="9" r="7.75" fill="none"><\/circle><path fill="none" d="M25 25h-25v-25h25z"><\/path><\/svg>',n.innerHTML=t)},f.searchBoxClickAction=function(){f._lastClickQuery==f.getCurrentQuery(!0)&&f.autosuggest.canvas.searchBoxHasFocus()||(f.searchBox.focus(),f.config.handleDuplicateFetch&&(f._lastClickQuery=f.getCurrentQuery(!0)),f.onSearchBoxClick());f.config.handleDuplicateFetch||(f._lastClickQuery=null)},f.onSubmit=function(n){var i,r,u,t;if(f.cancelDefaultHandler(n),!f.config.ascontainer&&f.config.ghostingWithGreyText&&f._ghostingText&&f.searchBox.value==f._prefixText&&(i=f._ghostingText.length,r=f._prefixText.length,f.searchBox.value=r-i>0?f._prefixText.slice(0,r-i):f._prefixText,f._ghostingText=null),f.isEmptyQuery()){u=_w._H&&_w._H.sbeb;u&&sb_st(function(){return f.hideDropDown(2)},5);return}if(sb_st(function(){return f.hideDropDown(2)},5),t=f.autosuggest.canvas.selectedSuggestion,sj_evt.fire("AS.Navigate",t,"submit"),t)f.config.ascsr?(t=t,f.navigateJSON(t.id,t.q,t.u,!0)):f.navigate(t,!0,f.config.linkTarget);else{f.submitForm(!0);f.autosuggest.onBfbSearchBoxAction("SearchDone")}},f.onSearchBoxKeyDown=function(n){var s,h,u=n.keyCode,c,t,e,a,i;f._ghostingText=null;c=(u==38||u==40)&&o==229&&!r;t=document.querySelector(".sa_hv");switch(u){case 13:if(f.config.enableNewlineByShiftEnter){if(f.config.submitOnEnter&&!n.shiftKey){f.onSubmit(n);break}n.shiftKey&&_w.Log&&Log.Log&&Log.Log("Autosuggest","SerpSearchBoxKeyDown","ShiftEnter");break}if(f.config.submitOnEnter)f.onSubmit(n);break;case 27:f.isQueryGhosted()||(f.hideDropDown(1),f.cancelDefaultHandler(n));break;case 38:f._isLayoutVisible&&(f.config.waitForCompositionEnd&&c?f.imeCheckForJapanese():f.config.ascsr?(f.searchBox.focus(),sj_evt.fire("AS.KeyBoardUp"),f.onEntitySugSelection()):f.autosuggest.canvas.selectItem(0),f.cancelDefaultHandler(n));break;case 40:f._isLayoutVisible?f.config.waitForCompositionEnd&&c?f.imeCheckForJapanese():f.config.ascsr?(f.searchBox.focus(),sj_evt.fire("AS.KeyBoardDown"),f.onEntitySugSelection()):f.autosuggest.canvas.selectItem(1):f.config.fetchOnDownArrowKey&&f.fetchForCurrentQuery();break;case 37:f._isLayoutVisible&&(f.config.ascsr&&f.config.enableEASE&&t?(sj_evt.fire("AS.KeyBoardLeft"),n.preventDefault(),f.onEntitySugSelection()):f.config.enableEASE&&f.config.enblEASEKB&&!f.autosuggest.canvas.hasAsExpanded&&!f.autosuggest.canvas.trendingNowMovedToRight&&t&&f._isLayoutVisible&&f.autosuggest.canvas.searchTypeDivIndex>=0&&(f.autosuggest.canvas.selectItem(3),e=document.querySelector(".sa_hv"),t!==e&&n.preventDefault()));break;case 39:f._isLayoutVisible&&(f.config.ascsr&&f.config.enableEASE&&t?(sj_evt.fire("AS.KeyBoardRight"),n.preventDefault(),f.onEntitySugSelection()):f.config.enableEASE&&f.config.enblEASEKB&&!f.autosuggest.canvas.hasAsExpanded&&!f.autosuggest.canvas.trendingNowMovedToRight&&t&&f._isLayoutVisible&&f.autosuggest.canvas.searchTypeDivIndex>=0&&(f.autosuggest.canvas.selectItem(2),e=document.querySelector(".sa_hv"),t!==e&&n.preventDefault()));break;case 9:f._searchDivs=document.querySelectorAll("#sa_ul");t=document.querySelector(".sa_sg.sa_ent.sa_hv");f._searchChildDiv=t?(s=t.lastElementChild)===null||s===void 0?void 0:s.querySelectorAll(".sa_sugg"):undefined;var v=f._searchDivs.length-1,y=f._searchChildDiv?f._searchChildDiv.length-1:0,l=f.autosuggest.canvas.searchTypeDivIndex,p=_ge("as_foot");if(!f.isQueryGhosted()){if(n.shiftKey){f._isLayoutVisible&&l>0&&f.config.enableAsPanelExpansion?(f.autosuggest.canvas.selectItem(3),n.preventDefault()):f.hideDropDownOnFocusChange();break}if(f._isLayoutVisible&&l<v&&f.config.enableAsPanelExpansion||f.config.enableEASE&&!f.config.enblEASEKB&&f._isLayoutVisible&&f._searchChildDiv!==undefined&&l<y){f.autosuggest.canvas.selectItem(2);n.preventDefault();break}if(f.config.CommonFooter==!0&&f._isLayoutVisible&&p!=null&&f.gaNtp(document.activeElement).id==f.config.i){f.focusHistory(n);break}if(f.config.removeSuggUrl&&f._isLayoutVisible&&((h=document.activeElement)===null||h===void 0?void 0:h.className)!=="sa_rm"){if(a=f.autosuggest.canvas.selectedSuggestion,!a){f.hideDropDownOnFocusChange();break}if(i=f.getSelectedSuggestionRemoveButton(),i){i.tabIndex=0;i.focus();i.onblur=f.onBlur;n.preventDefault();break}}f.focusFeedback(n)}}o=u},f.onASKeyDown=function(n){var t,i,r,u,e=_ge("sb_fdb"),o=_ge("as_foot"),s=n.keyCode;s==9&&(n.shiftKey?f._isLayoutVisible&&f.gaNtp(document.activeElement).id=="sb_fdb"&&o?f.focusHistory(n):(f.hideDropDownOnFocusChange(),_ge(f.config.i).focus(),n.preventDefault()):f.config.ascsr&&((t=document.activeElement)===null||t===void 0?void 0:t.id)=="as_foot_link"&&e?f.focusFeedback(n):(f.gaNtp(document.activeElement).className=="as_rmhswarningtxt"||((r=(i=f.gaNtp(document.activeElement))===null||i===void 0?void 0:i.parentElement)===null||r===void 0?void 0:r.className)=="as_bpr as_bprtxt")&&e?f.focusFeedback(n):((u=n.target)===null||u===void 0?void 0:u.className)!=="sa_rm"&&(f.hideDropDownOnFocusChange(),_ge(f.config.i).focus(),n.preventDefault()))},f.getSelectedSuggestionRemoveButton=function(){var u,t=f.autosuggest.canvas.selectedSuggestion,n,i,r;return t?(f.config.ascsr&&(t=document.getElementById(t.id)),n=t.firstElementChild,!n)?null:n.classList&&n.classList.contains("as_hr")?n:(i=n.lastElementChild,i&&i.classList&&i.classList.contains("sa_rm"))?i.firstElementChild:(r=t.nextElementSibling,r&&((u=r.classList)===null||u===void 0?void 0:u.contains("sa_rm")))?r:null:null},f.setshowAsDropDownValue=function(n){f._showAsdropdown=f.config.asmltbox?!0:n;f.autosuggest.isLongQuery=f.config.asmltbox?!1:!n},f.onSearchBoxClick=function(){f._ghostingText=null;var t=f.config.asbugfix?f._showAsdropdown:!0;f._isLayoutVisible||f.suppressRequestForQuery||!t||f.fetchForCurrentQuery();f.autosuggest.onBfbSearchBoxAction(n.searchBoxFocusEventId)},f.onEntitySugSelection=function(){var t,n=(t=f.autosuggest.canvas)===null||t===void 0?void 0:t.selectedSuggestion,i;f.config.selectEntity&&f.isJSONSuggestion(n)&&n.t==="MB"&&(i='{ "q": "'.concat(n.q,'", "t": "').concat(n.t,'"}'),Log.Log("entitySugKey","AS","EASEInst",!1,"Namespace","AutoSuggest","EventType","Hide","CustomData",i))},f.hideDropDownOnFocusChange=function(n){f.hideDropDown(1,n);f._showAsdropdown==!1&&f.config.ascontainer&&f.raiseEvent(30)},f.onTextInput=function(){var n=f.searchBox.value;f.triggerTextChangedEvent(n)},f.clearSearchBox=function(n){f.clearQuery();f.searchBoxClickAction(n)},f.raiseEvent(5,t),e=0,s=v.ScopeExtensions;e<s.length;e++)h=s[e],h.init(f);return v.ScopeExtensions=[],f}return __extends(v,a),v.prototype.init=function(t){var l=this,h,o,s,u,c,a,i,f,e;(this.config.globalId=t,this.config.slid="sa_ul",this._bDisabled=this.isDisabled())||(_w._H&&_w._H.ajax?(h=_ge("serpHeader"),h&&(o=h.getElementsByTagName("form"),o&&o.length>0&&(this.searchForm=o[0],s=this.searchForm.getElementsByClassName("b_searchbox"),s&&s.length>0&&(this.searchBox=s[0])))):(this.searchForm=_ge(this.config.f),this.searchBox=_ge(this.config.i)),this.searchBox&&typeof this.searchBox.shadowRoot!="undefined"&&(this._isSearchBoxWebComponent=!0),this.searchForm&&this.searchForm.form&&(this.config.fc=this.searchForm.form.value),this._currentImpressionQuery=this.searchBox.value,u=this.getContainer(),!u&&_w.sa_initAsC&&typeof _w.sa_initAsC=="function"&&(_w.sa_initAsC(),u=this.getContainer()),sj_be(u,"mousedown",function(n){return sj_sp(n)}),u.style.display="block",this.layout=this._layout=new n.Layout(this.config,u,this.autosuggest.canvas),this.layout.update(),this.registerUIElement(u),this.registerUIElement(this.searchBox),this.config.asmobfw&&(this._asSubContainer=document.querySelector(".sa_as"),this._asSubContainer&&this.searchBox&&sj_be(this.searchBox,"focus",function(){sj_be(l._asSubContainer,"scroll",l.onScrollHandler)})),c=_ge("sb_form_go"),c&&this.registerUIElement(c),this._pollInterval=this.config.d,this._pollThrottlingEnabled=this.config.t,a=this._layout.getSuggestionsDrawer(),this.autosuggest.init(this.config,a,this.searchBox),this._lastQuery=this.getQueryToFetch(),this.config.aszisear&&this.loadZisEarly(),this.searchBox.setAttribute("aria-autocomplete","both"),this.config.dsarialv||this.searchForm.setAttribute("aria-live","polite"),i=new n.EventRegistration(this),i.add(8,this.handleResponseReceived),i.add(11,this.startNoMatchTimeout),i.add(10,this.showDropDown),i.add(12,this.onUpdateText),i.add(13,this.onUpdateTextAndRequery),i.add(14,this.onUpdateGhostedText),i.add(4,this.navigate),i.add(17,this.dispose),this.autosuggest.registerEvents(i),this.internalEventTrigger&&(f=new n.EventRegistration(this),f.add(12,this.onUpdateText),f.add(4,this.navigateJSON),f.add(10,this.showDropDown),f.add(11,this.startNoMatchTimeout),this.internalEventTrigger.registerEvents(f)),this.bindEvents(sj_be,sj_evt.bind),this.config.asdbc?this.debouncingAutosuggest():this.pollForQueryChange(),this.raiseEvent(6,this),this.config.ascontainer&&(e=document.querySelector("textarea#".concat(this.config.i)),e&&(e===null||e===void 0?void 0:e.rows)>1&&this.setshowAsDropDownValue(!1)),this.config.waitForCompositionEnd&&(this.searchBox.addEventListener("compositionend",function(){r=!0}),this.searchBox.addEventListener("compositionstart",function(){r=!1})))},v.prototype.setData=function(n){this.autosuggest.setData(n)},v.prototype.getCurrentImpressionQuery=function(){return this._currentImpressionQuery},v.prototype.isDisabled=function(){return!this.config.pv&&sj_cook.get(c,l)=="0"},v.prototype.registerUIElement=function(n){sj_be(n,"touchend",sj_sp);sj_be(n,"click",sj_sp)},v.prototype.addHiddenField=function(n,t){var i=sj_ce("input");return i.id="sa_"+n,i.name=n,i.value=t,i.type="hidden",this.searchForm.appendChild(i),this.config.sbt&&this._hiddenFields.push(i),i},v.prototype.cancelDefaultHandler=function(n){sj_sp(n);sj_pd(n)},v.prototype.loadZisEarly=function(){this.autosuggest.pretechQuery("")},v.prototype.show=function(){this.config.handleDuplicateFetch&&this._lastClickQuery!=this.getCurrentQuery(!0)&&(this._lastClickQuery=this.getCurrentQuery(!0));this.onSearchBoxClick()},v.prototype.getCursorPosition=function(){return n.Utils.getCursorPosition(this.searchBox,!0)},v.prototype.makeAutoSuggestGPingCall=function(n){var r,u,i=_ge(n.replace("&","")),o;if(i&&document.images){var e=i.getAttribute("h"),f=void 0,t={a:[],add:function(n,t){this.a.push(h(n)+":"+h(t))},get:function(){return this.a.length?"&PR={"+this.a.join(",")+"}":""}};this.config.ascsr&&this.config.isMobile&&(i.it="t");t.add("i",this.autosuggest.canvas.clickedSuggestion?i.it||"m":"k");this.autosuggest.ghostInstValue&&t.add("ghc",this.autosuggest.ghostInstValue);i.panel?t.add("et",sb_gt()-i.panel.ot):this.config.ascsr&&((u=(r=this.autosuggest.canvas.clickedSuggestion)===null||r===void 0?void 0:r.panel)===null||u===void 0?void 0:u.ot)&&t.add("et",sb_gt()-this.autosuggest.canvas.clickedSuggestion.panel.ot);this.autosuggest.ghostingShown&&t.add("ghsh",this.autosuggest.ghostingShown.toString());this.autosuggest.ghostingAccepted&&t.add("ghacc",this.autosuggest.ghostingAccepted.toString());this.autosuggest.ghostingPrefixLength&&t.add("ghpl",this.autosuggest.ghostingPrefixLength.toString());f=this.autosuggest.data&&this.autosuggest.data.Inst?this.autosuggest.data.Inst.IG:null;f&&e&&(o=new Image,o.src=this.getGPingUrl()+"IG="+f+"&"+e+t.get())}return!0},v.prototype.getGPingUrl=function(){return _w&&_w.location&&_w.location.host&&_w.location.host.indexOf("bing.com")>-1&&_G.gpUrl?_G.gpUrl:"https://www.bing.com"+_G.gpUrl},v.prototype.navigate=function(t,i,r){var o=this,u,f;if(sb_st(function(){return o.hideDropDown(2)},5),this.config.zisr1>0&&n.ZisRankableBanners.indexOf(t.stype)!=-1&&this.updateLSOnClick(t.stype),this.makeAutoSuggestGPingCall(t.id),f=t.query,t.rg?this.updateSearchBoxValue(this.getLastRequestedQuery()):f!=undefined&&this.updateSearchBoxValue(f),this.config.logClickOnSuggestion&&(i?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","EnterClick",!1):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","MouseClick",!1)),this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency(),this.config.sbt&&t.addInst&&!t.nav){if(this.submitForm(i,t.url),this.config.isNtpClientqfEnabled)this.autosuggest.onBfbNavigateCallback(t.id,t.stype,((u=t.parentElement)===null||u===void 0?void 0:u.id)==e&&this.config.isLowConfidenceWeb,t.query,t.getAttribute("logicalId"))}else this.navigateToUrl(t,i,r)},v.prototype.redirectToSapphire=function(){if(typeof SAUpsellTrigger!="undefined")if(SAUpsellTrigger.setConfigs(this.config.sapphireSearchRedirectTimeout,this.config.maxSapphireSearchRedirect),SAUpsellTrigger.shouldRedirectToSapphire()){var n=this.getRedirectionPositionId();this.sapphireRedirectionLogger("SubmitFormHandler","RedirectToSapphire","PositionID",n);SAUpsellTrigger.queryNativelyByApp(this.searchForm,n,this.searchForm.submit.bind(this.searchForm))}else this.sapphireRedirectionLogger("SubmitFormHandler","RedirectionBlocked"),this.searchForm.submit();else this.sapphireRedirectionLogger("SubmitFormHandler","ScriptResourceNotLoaded"),this.searchForm.submit()},v.prototype.submitFormHandler=function(){this.config.enableSapphireSearchTrigger?this.config.blockIncognitoSapphireSearch&&this.config.isFirstSession?(this.sapphireRedirectionLogger("SubmitFormHandler","Incognito mode blocked"),this.searchForm.submit()):this.redirectToSapphire():this.searchForm.submit()},v.prototype.submitForm=function(n,i){var u,c,r,f,s,h,e;if(this.config.sbt){for(u=void 0;u=this._hiddenFields.shift();)u.parentNode==this.searchForm&&this.searchForm.removeChild(u);this._hiddenFields=[]}if(n&&(this.raiseEvent(15),this.config.bi&&this._currentImpressionQuery===this.searchBox.value)){sj_evt.fire(t);return}this._instrumentationData=this.autosuggest.getAllSuggestionInstObject(null,n,this.searchBox.value);c=this.getCustomUrlParams(i);r=_ge("sa_ghc");r&&r.parentNode.removeChild(r);for(var l=0,o=void 0,a=[this._instrumentationData,c];o=a[l++];)for(f in o)r=_ge("sa_"+f),s=o[f],r?r.value=s:this.addHiddenField(f,s);this.autosuggest.ghostInstValue=0;n||sj_evt.fire("onSearch",this.searchForm);this.makeSearchboxGPingCall();this.fireEvt?(h=this.searchForm.getAttribute("action"),i&&this.searchForm.setAttribute("action",i),this.submitFormHandler(),this.firePartnerEvents(n),h&&this.searchForm.setAttribute("action",h)):_w._H&&_w._H.ajax&&_w.sj_isAjax&&n||this.submitFormHandler();this.fireEvt&&(this.autosuggest.canvas.selectedSuggestion=null,this.autosuggest.ghostInstValue=0,e=_ge("sa_ghc"),!this._instrumentationData.ghc&&e&&e.parentNode.removeChild(e));this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency()},v.prototype.makeSearchboxGPingCall=function(){var t=this.searchForm.getAttributeNode("onsubmit"),n;t&&_w.si_T&&(n=t.value.match(/si_T\('(.*)'\)/),n&&n[1]&&_w.si_T(n[1]))},v.prototype.isMsbSuggestion=function(n){return n=="Bookmark"||n=="Building"||n=="Person"||n=="Qna"||n=="Acronym"||n=="External"||n=="File"||n=="EducationAssignment"||n=="Group"||n=="UserHistory"||n=="External"},v.prototype.navigateToUrl=function(i,r,u){var o,s,h,c,l,a,v,y,p=((o=i.parentElement)===null||o===void 0?void 0:o.id)==e&&this.config.isLowConfidenceWeb,d=((s=i.parentElement)===null||s===void 0?void 0:s.getAttribute("data-region"))=="BAWC",f,w,b,k;if(i.stype==n.BingAtWorkDataTypes.Bookmarks)this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"));else if(i.stype==n.BingAtWorkDataTypes.People)if(this.config.msbSusR)this.autosuggest.onSubstrateNavigateCallback(i.id);else this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"));else if(this.isMsbSuggestion(i.stype))this.autosuggest.onBfbNavigateCallback(i.id,i.stype,p,i.query,i.getAttribute("logicalId"),i.url);if(d&&i.getAttribute("menu")==="webSerpMenu")this.autosuggest.onBfbSearchBoxAction("Search_Web_Qf_Click");if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);if(this.firePartnerEvents(r),this.config.bi&&this._currentImpressionQuery===i.query){sj_evt.fire(t);return}this.config.enableBaseQInLocalStorage&&i.query!==undefined&&i.query&&_w.localStorage!==null&&_w.localStorage.setItem("baseq",i.query);f=i.url+(i.addInst?this.autosuggest.getAllSuggestionInstUrl():"");f=this.addExtraQueryStrings(f);i.nav&&!n.Utils.GetQueryStringParam(f,"form")&&(f=this.addFormCode(f));this.shouldRedirectToSapphire()?(w=this.getRedirectionPositionId(),this.sapphireRedirectionLogger("navigateToUrl","RedirectToSapphire","PositionID",w),SAUpsellTrigger.searchNativelyByApp(f,w,u)):u?_w.open(f,u):((c=(h=window.BingAtWork)===null||h===void 0?void 0:h.context)===null||c===void 0?void 0:c.isSharedSerpWorkBundlesEnabled)?(b="/work/search",k=f.substring(0,b.length)===b,k&&((a=(l=window.BingAtWork)===null||l===void 0?void 0:l.context)===null||a===void 0?void 0:a.isOnWorkVertical)&&((v=window.BingAtWork)===null||v===void 0?void 0:v.isMsbHandlingAutoSuggestRequery())?(y=window.BingAtWork)===null||y===void 0?void 0:y.handleAutoSuggestRequery(f):typeof sj_lc!="undefined"?sj_lc(f):_w.location.href=f):typeof sj_lc!="undefined"?sj_lc(f):_w.location.href=f},v.prototype.firePartnerEvents=function(n){!n&&this.fireEvt&&this.fireEvt(this.searchForm,"ASSugClicked")},v.prototype.getCustomUrlParams=function(n){var r={},t;if(n)for(var i=void 0,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,u=function(n){return decodeURIComponent(n.replace(f," "))},o=n.substring(n.indexOf("?")+1);i=e.exec(o);)t=u(i[1]).toLowerCase(),t!=="q"&&t!=="form"&&(r[t]=u(i[2]));return r},v.prototype.bindEvents=function(n,t){var i=this,r;n(sj_b,"click",this.hideDropDownOnFocusChange);n(sj_b,"touchend",this.hideDropDownOnFocusChange);n(this.searchForm,"submit",this.onSubmit);this.config.submitOnEnter&&sj_evt.fire("AS.BindKeyDown");n(this.searchBox,"keydown",this.onSearchBoxKeyDown);this.config.CommonFooter&&n(this._asContainer,"keydown",this.onASKeyDown);this.config.enableSbLeftSpyglass&&this.addSearchBoxLeftSpyglass();"ontouchend"in _w&&n(this.searchBox,"touchend",this.searchBoxTouchAction);n(this.searchBox,"click",this.searchBoxClickAction);this.config.popUpASFromUA&&(this.config.clickUAClearSB?sj_evt.bind(f,this.clearSearchBox,!1):sj_evt.bind(f,this.searchBoxClickAction,!1));this.config.expandOnFocus&&n(this.searchBox,"focus",this.searchBoxClickAction);this.fireEvt&&n(_w,"blur",this.hideDropDownOnFocusChange);r=function(){t("focusChange",function(n){return i.focusChange(n)});t("hideDrawer",function(){return i.hideDropDown(3)});t("SB.LineChange",function(n){return i.handleAsDropDown(n)})};r();this.config.bi&&t("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&(i._currentImpressionQuery=t.query||i.searchBox.value,i.config.asdbc?i.debouncingAutosuggest():i.pollForQueryChange(),r())});"oninput"in this.searchBox&&n(this.searchBox,"input",this.onTextInput)},v.prototype.isJSONSuggestion=function(n){return n&&typeof n.q=="string"&&typeof n.t=="string"},v.prototype.fetchForCurrentQuery=function(){(this._noResultsTimeout&&sb_ct(this._noResultsTimeout),this._bDisabled)||(this._lastQuery=null,this.config.disasdbcsbclick?this.fetchSuggestions(this.getQueryToFetch(),this.getCurrentQuery(!0)):this.fetchSuggestionsDebounced(this.getQueryToFetch(),this.getCurrentQuery(!0)))},v.prototype.showDropDown=function(){if(this._showAsdropdown){if(this._layout.update(),this.config.enableFullPageAs&&(_w.location.hash="asqf"),this.fireEvt){var n=this.autosuggest.canvas.containsNextWord?"1":"0";this.searchForm.setAttribute("SuggMode",n);this.fireEvt(this.searchForm,"autosuggestRendered")}this._isLayoutVisible||(sj_evt.fire("focusChange",this.searchBox),this._layout.show(),this._isLayoutVisible=!0,sb_i6&&sj_evt.fire("autosuggestShown",this.searchBox),sj_evt.fire("onPopTR"),this.fireEvt&&this.fireEvt(this.searchForm,"autosuggestShown"),this.searchForm.setAttribute("aria-owns","sw_as"))}else this._isLayoutVisible=!0,this.hideDropDown(5)},v.prototype.handleAsDropDown=function(n){if(this.config.ascontainer){var t=n&&n[1]?n[1].total_line:1;this.setshowAsDropDownValue(t<=1)}},v.prototype.hideDropDown=function(t,i){var r,u,o,s;if(t!=0&&(this._lastClickQuery=null),this._isLayoutVisible){if(this._layout.hide(),this._isLayoutVisible=!1,this.searchForm.removeAttribute("aria-owns"),r=n.Utils,u=document.getElementsByClassName("b_searchboxForm")[0],this.config.enableAsPanelExpansion){var f=/(\s|^)as_rsform/g,e=_ge("b_header");e&&r.RemoveClassName(e,f);r.RemoveClassName(u,f);this.autosuggest.canvas.isBNorrClassPresent&&r.AddClassName(document.body,"b_norr")}this.config.asshdw&&(o=/(\s|^)as_shadow/g,r.RemoveClassName(u,o));this.config.asOnSBRound&&(s=/(\s|^)as_show/g,r.RemoveClassName(u,s));t!=0&&(this._lastQuery=this.getQueryToFetch());t!=5&&this.raiseEvent(30);this.raiseEvent(16);this.autosuggest.finalizeKeystroke();i&&this.config.hdm&&sj_pd(i);_w._H&&sj_evt.fire("ASHide");this.autosuggest.setQuery(undefined)}sj_evt.fire("autosuggestHide",this.searchBox,t);this.fireEvt&&(this.searchForm.removeAttribute("SuggMode"),this.fireEvt(this.searchForm,"autosuggestHide"))},v.prototype.focusChange=function(n){n[1]!==this.searchBox&&this.hideDropDown(1)},v.prototype.startNoMatchTimeout=function(){var n=this;this._noResultsTimeout=sb_st(function(){return n.hideDropDown(0)},50)},v.prototype.onUpdateText=function(n,t){t===void 0&&(t=!0);this.getCurrentQuery()!=n&&t&&(this._bRequeryOnTextChange=!1);t?this.updateSearchBoxValue(n):this.sendQfcEvent()},v.prototype.sendQfcEvent=function(n,t){this.config.ascontainer?(sj_evt.fire("AS.Input.Update",{suggestion:n,nudge:!0,type:"AS"}),this.config.easpm&&n!=null&&t!=null&&this.autosuggest.raiseGhostingEventFired(this.searchBox.value,t)):(!this.config.webMsbQFRanking||n)&&sj_evt.fire("AS.Input.Update",{target:this.searchBox})},v.prototype.updateSearchBoxValue=function(t,r,u){var f=r&&!this.config.ascontainer?t+r:t,e;this._autoCompletedPrefixLength=r&&!this.config.ascontainer?t.length:null;this.config.ghostingWithGreyText&&r&&(this._ghostingText=r,this._prefixText=this.config.ascontainer?t:t+r);f!==null&&(this.searchBox.value=f,i||(this.searchBox.setAttribute("value",f),this.sendQfcEvent(r,u)),e=f===null||f===void 0?void 0:f.length,e&&this.getCurrentQuery(!0)!=t&&n.Utils.SetSelectionRange(this.searchBox,e,e),this.config.asperfv2?t&&t!=this._lastTextChanged&&u===undefined&&this.triggerTextChangedEvent(t):t&&t!=this._lastTextChanged&&this.triggerTextChangedEvent(t))},v.prototype.onUpdateTextAndRequery=function(t,i){if(this._bRequeryOnTextChange=!0,this.updateSearchBoxValue(t),!i){var r=t.length;this.searchBox.focus();n.Utils.SetSelectionRange(this.searchBox,r,r)}},v.prototype.onUpdateGhostedText=function(n,t,i,r){this._bRequeryOnTextChange=i===undefined?!0:i;this.updateSearchBoxValue(n,t,r)},v.prototype.triggerTextChangedEvent=function(n){this._lastTextChanged=n;this.autosuggest.raiseTextChanged(n,++this._textChangeSequence)},v.prototype.getGhostingInformation=function(n){return n+this._ghostingText==this._prefixText?!0:!1},v.prototype.isQuerySubstringOfGhostedQuery=function(n){return this.config.ghostingWithGreyText&&(this.getGhostingInformation(n)||this._prefixText&&this._ghostingText&&this._lastQuery&&n.length>this._lastQuery.length&&this._prefixText.length>=n.length&&this._prefixText.indexOf(n)==0&&this._ghostingText.indexOf(this._prefixText.substring(n.length-1,this._prefixText.length-1))==0)?!0:!1},v.prototype.debouncingAutosuggest=function(){var s=this,t,n,r,f,o,e;this._bDisabled||(t=this.getCurrentQuery(!0),this._lastRawQuery!=t&&(this.autosuggest.setRawQuery(t),this._lastRawQuery=t,this.config.bi&&sj_evt.fire("AS.RawQueryChanged"),n=this.getQueryToFetch(),r=(this._lastQuery!=n||!this._bRequeryOnTextChange)&&!i,r=this.config.ascontainer?r:r&&!this.isQuerySubstringOfGhostedQuery(n),r&&(this.config.enableSbUpdate&&this.searchBox.setAttribute("value",n),this._isSearchBoxWebComponent&&this.config.enableSbUpdate&&(this.searchBox.value=t)),this.config.aspsc&&(f=n.trim().split(/\s+/).length>3||n.trim().split(/\s+/).length===3&&n.substr(-1)===" ",f||(this._lastPSCQuery=""),o=f&&(n.length>=this._lastPSCQuery.length+2||n.length<=this._lastPSCQuery.length-2),o&&(this._lastPSCQuery=n,this.autosuggest.setPSCQuery(n))),n!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestionsDebounced(n,t):this.suppressRequestForQuery&&this.config.eNw&&this.autosuggest.canvas.resizeNextWord&&this._bRequeryOnTextChange?this.hideDropDown(4):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=n)),e=this._pollInterval,this._pollThrottlingEnabled&&(e*=1<<Math.max(0,this._pendingRequestCount-u+1)/2),sb_st(function(){return s.debouncingAutosuggest()},e))},v.prototype.pollForQueryChange=function(){var s=this,t,n,r,f,o,e;this._bDisabled||(t=this.getCurrentQuery(!0),this._lastRawQuery!=t&&(this.autosuggest.setRawQuery(t),this._lastRawQuery=t,this.config.bi&&sj_evt.fire("AS.RawQueryChanged"),n=this.getQueryToFetch(),r=(this._lastQuery!=n||!this._bRequeryOnTextChange)&&!i,r=this.config.ascontainer?r:r&&!this.isQuerySubstringOfGhostedQuery(n),r&&(this.config.enableSbUpdate&&this.searchBox.setAttribute("value",n),this._isSearchBoxWebComponent&&this.config.enableSbUpdate&&(this.searchBox.value=t)),this.config.aspsc&&(f=n.trim().split(/\s+/).length>3||n.trim().split(/\s+/).length===3&&n.substr(-1)===" ",f||(this._lastPSCQuery=""),o=f&&(n.length>=this._lastPSCQuery.length+2||n.length<=this._lastPSCQuery.length-2),o&&(this._lastPSCQuery=n,this.autosuggest.setPSCQuery(n))),n!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestions(n,t):this.suppressRequestForQuery&&this.config.eNw&&this.autosuggest.canvas.resizeNextWord&&this._bRequeryOnTextChange?this.hideDropDown(4):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=n)),e=this._pollInterval,this._pollThrottlingEnabled&&(e*=1<<Math.max(0,this._pendingRequestCount-u+1)/2),sb_st(function(){return s.pollForQueryChange()},e))},v.prototype.fetchSuggestionsDebounced=function(n,t){var i=this;this.config.asdbcdly&&(this.debounceDelay=this.config.asdbcdly);this.debounceTimeout&&clearTimeout(this.debounceTimeout);this.debounceTimeout=setTimeout(function(){i.fetchSuggestions(n,t)},this.debounceDelay)},v.prototype.fetchSuggestions=function(n,t){this._noResultsTimeout&&sb_ct(this._noResultsTimeout);this.autosuggest.setCursorPosition(this.adjustCursorPositionForModifiedQuery(t,n));this.autosuggest.setQuery(n);n.length!=0||this.config.fetchOnEmpty||this.config.enableZeroQfWork||this.hideDropDown(0);this._pendingRequestCount++},v.prototype.adjustCursorPositionForModifiedQuery=function(n,t){var r=this.getCursorPosition(),i;if(t!==n&&t!="")for(i=0;i<n.length&&n[i]!=t[0];i++)r--;return r},v.prototype.handleResponseReceived=function(){this._pendingRequestCount--},v.prototype.getQueryToFetch=function(){var t=this.getCurrentQuery(!0).toLowerCase();return this.config.trimwsnr&&(t=n.Utils.TrimmedQueryFromSuggestions(this.autosuggest.canvas.currentSuggestionList,t)),t},v.prototype.isQueryGhosted=function(){var n;return this.config.ascontainer?!!((n=_qs(".ghost"))===null||n===void 0?void 0:n.innerText):!!this._autoCompletedPrefixLength},v.prototype.getCurrentQuery=function(n){var t,i,r="";return r=this._autoCompletedPrefixLength?(t=this.searchBox)===null||t===void 0?void 0:t.value.substr(0,this._autoCompletedPrefixLength):(i=this.searchBox)===null||i===void 0?void 0:i.value,n?r:r.replace(this._trimRegex,"").replace(this._removeSpacesRegex," ").toLowerCase()},v.prototype.getPartnerCode=function(n){var u="",i=n.indexOf("pc"),f,t,e,r;return i>=0&&(f=n.indexOf("&",i),r=f>=0?n.substr(i,f-i):n.substr(i),u+="&"+r),t=n.indexOf("pt"),t>=0&&(e=n.indexOf("&",t),r=e>=0?n.substr(t,e-t):n.substr(t),u+="&"+r),u},v.prototype.checkMonitr=function(n){var t=n.indexOf("form=monitr");return t>=0?"&"+n.substr(t,11):""},v.prototype.getPubcode=function(n){if(n.indexOf("pubcode=null")!==-1&&n.indexOf("pt=opentetris")!==-1)return"&pubcode=null";var t=n.indexOf("pubcode");return"&pubcode="+n.substr(t+8,32)},v.prototype.addExtraQueryStrings=function(n){return this.config.pv?n+this.getPubcode(document.URL)+"&pubexp=1&msbqf=false"+this.getPartnerCode(document.URL)+this.checkMonitr(document.URL):n},v.prototype.addFormCode=function(n){return n+"&form="+this.searchForm.form.defaultValue},v.prototype.getLastRequestedQuery=function(){return this._lastQuery},v.prototype.notifyDeleteHistory=function(n){this.raiseEvent(22,n)},v.prototype.dispose=function(){this.clearEvents();this.bindEvents(sj_ue,sj_evt.unbind);sb_ct(this._noResultsTimeout);this.internalEventTrigger&&this.internalEventTrigger.dispose()},v.prototype.isEmptyQuery=function(){var n=_ge("sb_form_q");return n&&!n.value},v.prototype.getContainer=function(){return _ge(this.config.c||"sw_as")},v.prototype.imeCheckForJapanese=function(){if(this.searchBox.blur(),this.searchBox.focus(),document.createEvent){var n=new Event("blurfocusIme");this.searchBox.dispatchEvent(n)}s=this.searchBox.value;setTimeout(function(){document.querySelector("#sb_form_q").value=s},50)},v.prototype.logAutoSuggestNetworkLatency=function(){_w.Log&&Log.Log&&Log.Log("Autosuggest","NetworkLatency","PerfInst",!1,"Meta",this.autosuggest.networkLatencyInfo)},v.prototype.gaNtp=function(n){return n!==null&&n.shadowRoot!==null?this.gaNtp(n.shadowRoot.activeElement):n},v.prototype.navigateJSON=function(n,t,i,r){var o=this,f,e,u;if(sb_st(function(){return o.hideDropDown(2)},5),this.makeAutoSuggestGPingCall(n),f=t,f!=undefined&&this.updateSearchBoxValue(f),this.config.logClickOnSuggestion&&(r?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","EnterClick",!1):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest","Suggestion","MouseClick",!1)),this.config.enbleClientPerfTelemetry&&typeof this.autosuggest.networkLatencyInfo!=undefined&&this.autosuggest.networkLatencyInfo&&this.logAutoSuggestNetworkLatency(),this.shouldRedirectToSapphire()){e=this.getRedirectionPositionId();u=i+this.autosuggest.getAllSuggestionInstUrl();u=this.addExtraQueryStrings(u);this.sapphireRedirectionLogger("navigateToUrl","RedirectToSapphire","PositionID",e);SAUpsellTrigger.searchNativelyByApp(u,e);return}this.navigateToUrlJSON(t,i)},v.prototype.navigateToUrlJSON=function(n,i){if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);if(this.config.bi&&this._currentImpressionQuery===n){sj_evt.fire(t);return}if(i){var r=i+this.autosuggest.getAllSuggestionInstUrl();this.config.enableBaseQInLocalStorage&&n!==undefined&&n&&_w.localStorage!==null&&_w.localStorage.setItem("baseq",n);r=this.addExtraQueryStrings(r);typeof sj_lc!="undefined"?sj_lc(r):_w.location.href=r}},v.prototype.updateLSOnClick=function(t){n.Utils.setItem(t,0)},v.prototype.clearQuery=function(){var n=_ge("sb_form_q");n&&(n.value="")},v.prototype.sapphireRedirectionLogger=function(n,t,i,r){i&&r?typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest",n,t,!1,i,r):typeof Log!="undefined"&&Log&&Log.Log&&Log.Log("Autosuggest",n,t,!1)},v.prototype.getRedirectionPositionId=function(){return _w.location.pathname.indexOf("search")>0?"Bing_DirectOpen_SERP_AS":_w.location.pathname==="/"?"Bing_DirectOpen_HP_AS":"Bing_DirectOpen_OTHER_AS"},v.prototype.shouldRedirectToSapphire=function(){if(this.config.blockIncognitoSapphireSearch&&this.config.isFirstSession)return this.sapphireRedirectionLogger("shouldRedirectToSapphire","Incognito mode blocked"),!1;if(this.config.enableSapphireSearchTrigger&&typeof SAUpsellTrigger!="undefined"){if(SAUpsellTrigger.setConfigs(this.config.sapphireSearchRedirectTimeout,this.config.maxSapphireSearchRedirect),SAUpsellTrigger.shouldRedirectToSapphire())return!0;this.sapphireRedirectionLogger("SubmitFormHandler","RedirectionBlocked")}return!1},v.ScopeExtensions=[],v}(n.EventRegisterer);n.SearchForm=a})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));EventKeyCodes={Backsapce:"Backspace",Delete:"Delete"},function(n){var t;(function(n){var t=navigator.userAgent.toLowerCase(),i=t.indexOf("msie ")===-1||t.indexOf("rv:11.0")>-1,r=function(){function t(){this._imeInProgress=!1;this._rerankqfEnabled=!1;this._smoothGhostingSet=!1;this.compositionEventLogged=!1}return t.prototype.init=function(t){if(t.config.eHC){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)}this._instantEnabled=!!t.config.bi;this._rerankqfEnabled=t.config.webMsbQFRanking},t.prototype.onSearchFormInitialized=function(t){var r=this,o,u,e,h;this.searchFormInstance=t;u=t.autosuggest;u.ghostInstValue=0;this.isCursorPositionAtTheEnd=function(){return t.getCursorPosition()==r.searchFormInstance.getCurrentQuery(r.searchFormInstance.config.asdsg?!0:!1).length};var l=function(){return u.ghostInstValue=2},a=function(){u.ghostInstValue==0&&(u.ghostInstValue=1)},f=t.searchBox;this.isRtlMode=t.autosuggest.canvas.isRtl;this.getSearchBoxValue=function(){return f.value};this.getGhostedQuery=function(){var n;if((n=document.querySelector(".ghost"))!==null&&n!==void 0)return n.innerText};this.getCurrentImpressionQuery=t.getCurrentImpressionQuery;this.resetGhosting=function(n,t,i){var o,s,e;t?(s=(o=f===null||f===void 0?void 0:f.value)===null||o===void 0?void 0:o.length,e=r.getGhostedQuery(),u.raiseUpdateGhostedText(r.getSearchBoxValue()+e,null,n),l(),i&&u.raiseGhostingAccepted(s,e===null||e===void 0?void 0:e.length,i)):u.raiseUpdateGhostedText(r.getSearchBoxValue(),null,n)};this.removeGhosting=function(n){n?u.raiseUpdateTextAndRequery(r.getSearchBoxValue()):u.raiseUpdateText(r.getSearchBoxValue())};this.setGhostValue=function(n,t,i){t?(u.raiseUpdateGhostedText(n,t,!0,i),a(),u.raiseGhostedTextLength(n.length,t.length)):u.raiseUpdateTextAndRequery(n)};this.updateQfcContainer=function(n){n===void 0&&(n=!0);r.searchFormInstance.config.enableAlwaysUpdateQFC&&u.raiseUpdateText(r.getSearchBoxValue(),n)};var v=function(n){return r.handleSearchBoxKeyPress(n)},y=function(n){return r.handleSearchBoxKeyDown(n)},p=function(){return sb_st(function(){return r.handlePasteEvent()},0)},w=function(){return r.handleSearchBoxMouseDown()},b=function(){return r.removeGhosting(!1)},k=function(){return r.handleCompositionStart()},d=function(){return r.handleCompositionEnd()},g=function(n){return r.handleSearchBoxKeyUp(n)},c=function(n,t){n(f,"keypress",v);n(f,"keydown",y);n(f,"mousedown",w);n(f,"paste",p);t("onFeedbackStarting",b);i?(n(f,"compositionstart",k),n(f,"compositionend",d)):n(f,"keyup",g)},s=new n.EventRegistration(this);s.add(10,this.handleSuggestionsRendered);s.add(17,function(){return c(sj_ue,sj_evt.unbind)});u.registerEvents(s);e=new n.EventRegistration(this);e.add(15,function(){r.getGhostedQuery()&&r.resetGhosting(!1,!1)});e.add(30,this.onDropDownHidden);t.registerEvents(e);t.config.ascsr&&(h=new n.EventRegistration(this),h.add(10,this.handleSuggestionsRendered),(o=t.internalEventTrigger)===null||o===void 0?void 0:o.registerEvents(h));c(sj_be,sj_evt.bind)},t.prototype.onDropDownHidden=function(){var n=this.getGhostedQuery();n&&(this._instantEnabled?this.getCurrentImpressionQuery()===n&&this.resetGhosting(!1,!0):this.removeGhosting(!1))},t.prototype.handleCompositionStart=function(){this._imeInProgress=!0;this.compositionEventLogged||(this.compositionEventLogged=!0,Log.Log("SystemEvent","AS","CompositionEvent",!1));this.isCursorPositionAtTheEnd()&&this.removeGhosting(!1)},t.prototype.handleCompositionEnd=function(){this._imeInProgress&&(this._imeInProgress=!1,this.isCursorPositionAtTheEnd()&&(this.resetGhosting(!0,!1),this._pendingGhostFirstSuggestion&&sb_st(this._pendingGhostFirstSuggestion,0)))},t.prototype.ghostFirstSuggestion=function(n,t,i,r){var f,u,e,o;if(this._pendingGhostFirstSuggestion!==null&&(n=this.getSearchBoxValue()),this._pendingGhostFirstSuggestion=null,!n||t!=n.toLowerCase()){this.updateQfcContainer(!1);return}if(this._lastKeyDown==EventKeyCodes.Backsapce||this._lastKeyDown==EventKeyCodes.Delete){this.updateQfcContainer(!1);return}i&&(this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW&&(e=i,i=e.filter(function(n){return n.id.startsWith("sa")})),u=i?i[0]:null);this.searchFormInstance.config.ascsr&&u?(u=u,u&&u.g&&(f=u.g)):u&&!this.searchFormInstance.config.ascsr&&u.ghtxt&&(f=u.ghtxt);f&&f.indexOf(t)==0&&f.length>n.length?(o=f.slice(n.length),this.setGhostValue(n,o,r)):this.updateQfcContainer(!1)},t.prototype.handleSuggestionsRendered=function(t,i,r,u,f,e){var v=this,s,h,o,c,l,a;if((!this.searchFormInstance.config.ghostingWithGreyText||!this.searchFormInstance.getGhostingInformation(t))&&!this._smoothGhostingSet){if(!this.isCursorPositionAtTheEnd()){this.updateQfcContainer(!1);return}o=(h=(s=u===null||u===void 0?void 0:u.children)===null||s===void 0?void 0:s.namedItem("sa_ul"))===null||h===void 0?void 0:h.children;(o===null||o===void 0?void 0:o.length)>0&&(c=this.searchFormInstance.config.ghostingThreshold?o[0].id==="bawh"||o[0].id==="bawuh"?o[0]:null:o[0].id==="bawh"?o[0]:null);this._rerankqfEnabled&&f==n.DataSources.MicrosoftSearchInBingCached&&(c||this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW)&&(this.getGhostedQuery()&&this.removeGhosting(!0),(c.childNodes.length>=1||this.searchFormInstance.config.ascsr&&this.searchFormInstance.config.enableCSRForBAW)&&(l=this.getSearchBoxValue(),this._imeInProgress?this._pendingGhostFirstSuggestion=function(){return v.ghostFirstSuggestion(l,t,i,r)}:e||this.ghostFirstSuggestion(l,t,i,r)));f==n.DataSources.Web&&(a=this.getSearchBoxValue(),this._imeInProgress?this._pendingGhostFirstSuggestion=function(){return v.ghostFirstSuggestion(a,t,i,r)}:e||this.ghostFirstSuggestion(a,t,i,r))}},t.prototype.handlePasteEvent=function(){this.getGhostedQuery()||this.updateQfcContainer(!1)},t.prototype.handleSearchBoxKeyDown=function(n){var r=this,t,u;if(this._lastKeyDown=n.code,t=n.keyCode,n.ctrlKey&&t==90){sj_pd(n);return}if(i||this._imeInProgress||t!=229||this.handleCompositionStart(),(this._lastKeyDown==EventKeyCodes.Backsapce||this._lastKeyDown==EventKeyCodes.Delete)&&(this._smoothGhostingSet=!1),!this._imeInProgress&&this.getGhostedQuery()){if(this.getGhostedQuery()&&(t==38||t==40)){this.removeGhosting(!1);return}switch(t){case n.shiftKey&&13:this.resetGhosting(!0,!1);break;case 13:this.resetGhosting(!1,!1);break;case 33:case 34:break;case 37:this.isRtlMode?this.resetGhosting(!0,!0,"arrowLeft"):this.resetGhosting(!0,!1);break;case n.shiftKey&&39:this.isRtlMode?this.resetGhosting(!0,!1):this.resetGhosting(!1,!0,"shiftArrowRight");break;case 35:this.resetGhosting(!0,!0,"pressEnd");break;case 39:this.isRtlMode?this.resetGhosting(!0,!1):this.resetGhosting(!0,!0,"arrowRight");break;case n.shiftKey&&37:this.isRtlMode?this.resetGhosting(!0,!0,"shiftArrowLeft"):this.resetGhosting(!0,!1);break;case n.ctrlKey&&65:this.resetGhosting(!0,!1);break;case 9:this.resetGhosting(!0,!0,"pressTab");sj_pd(n);sj_sp(n);break;case 27:case n.ctrlKey&&8:this.removeGhosting(!0);sj_pd(n);break;case 46:case 8:case n.ctrlKey&&88:this.resetGhosting(!0,!1);break;case n.ctrlKey&&86:case n.shiftKey&&45:this.removeGhosting(!0);break;default:u=this.getSearchBoxValue().toLowerCase();sb_st(function(){u==r.getSearchBoxValue().toLowerCase()||r._smoothGhostingSet||r.resetGhosting(!0,!1)},0)}}},t.prototype.handleSearchBoxKeyUp=function(n){var t=n.keyCode;this._imeInProgress&&(t==13||t==27||t==8||t==37||t==39)&&this.handleCompositionEnd()},t.prototype.handleSearchBoxKeyPress=function(n){var t=this.getGhostedQuery();if(t){var i=n.char?n.char:String.fromCharCode(n.charCode?n.charCode:n.keyCode),f=this.getSearchBoxValue(),r=t,u=r.slice(1);r.charAt(0)==i.toLowerCase()&&u?(this._smoothGhostingSet=!0,this.setGhostValue(f+i,u),sj_pd(n)):(this._smoothGhostingSet=!1,this.resetGhosting(!0,!1))}else this._smoothGhostingSet=!1},t.prototype.handleSearchBoxMouseDown=function(){this.getGhostedQuery()&&this.resetGhosting(!0,!0,"pressTap")},t}();n.SearchForm.ScopeExtensions.push(new r)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(){this.nwAsFullSuggestionsEnabled=!1}return t.prototype.init=function(t){var o=this,f=t.autosuggest,r=new n.EventRegistration(this),u,e,i;r.add(6,function(){o.ini(f.canvas.container)});r.add(16,this.hide);r.add(22,this.hide);t.registerEvents(r);u=new n.EventRegistration(this);u.add(11,this.hide);u.add(24,this.hide);f.canvas.registerEvents(u);e=new n.EventRegistration(this);e.add(10,this.show);f.registerEvents(e);t.internalEventTrigger&&(i=new n.EventRegistration(this),i.add(10,this.show),i.add(35,this.showEase),i.add(11,this.hide),t.internalEventTrigger.registerEvents(i));this.nwAsFullSuggestionsEnabled=t.config.nextWordNFullSuggsOne},t.prototype.ini=function(n){this._ct=n},t.prototype.show=function(n,t,i){var u=this,f=this.hasNw(t)&&!this.nwAsFullSuggestionsEnabled,r;if(!this._fdb){if(f)return;this._fdb=sj_ce("button","sb_fdb","sa_fd");this._fdb.innerText=sa_loc.Feedback;this._fdb.tabIndex=0;this._ct.parentElement.appendChild(this._fdb);r="undefined";typeof Feedback!==r&&typeof Feedback.Bootstrap!==r&&Feedback.Bootstrap.InitializeFeedback({page:!0},this._fdb.id,!0,!1,!1,!1,!1,{formConfig:"Autosuggest_Web",service:"AutoSuggest",scenario:"Web"});sj_evt.bind("ajax.feedback.collectsettings",function(n){var t={};t.fb_suggestions=JSON.stringify(u.fb_suggestions||[]);n[1].setStartSettings(u._fdb,{formConfig:"Autosuggest_Web",service:"AutoSuggest",scenario:"Web",context:t})})}if(i!==this.lastRequestSequence&&(this.lastRequestSequence=i,this.fb_suggestions=[]),this.populateFeedbacksuggestions(t),f){this.hide();return}this.updateLayout(0)},t.prototype.showEase=function(n){this.fb_suggestions=[];this.populateFeedbacksuggestions(n)},t.prototype.populateFeedbacksuggestions=function(n){for(var r,t=(r=this.fb_suggestions)===null||r===void 0?void 0:r.reduce(function(n,t){return n[t.text]=t.stype,n},{}),u=0,e=n;u<e.length;u++){var i=e[u],f=sa_config.ascsr?i.q:i.query,o=(sa_config.ascsr?i.t:i.stype)||"BAW";f in t?t[f]+="||"+o:t[f]=o}this.fb_suggestions=Object.keys(t).map(function(n){return{text:n,stype:t[n]}})},t.prototype.hide=function(){this._fdb&&(this._fdb.style.display="none")},t.prototype.updateLayout=function(n){var t=this;sb_st(function(){t._ct.style.display!="none"&&(t._fdb.style.top=t._ct.offsetHeight-n+"px",t._fdb.style.display="block")},20)},t.prototype.hasNw=function(n){return this.hasSuggestionOfType(n,"NW")},t.prototype.hasSuggestionOfType=function(n,t){for(var r,i=0;i<n.length;i++)if(r=sa_config.ascsr?n[i].t:n[i].stype,r&&r.indexOf&&r.indexOf(t)>-1)return!0;return!1},t}();n.SearchForm.ScopeExtensions.push(new t)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var i=function(){function t(){}return t.prototype.getCallbacks=function(){var t=new n.EventRegistration(this);return t.add(11,this.onNoResults),t.add(10,this.onSuggestionsRendered),t},t.prototype.set=function(n){this._data=n;this._data.currentQuery.length<=1&&(this._lastQueryWithNoResults=null)},t.prototype.match=function(){return this._lastQueryWithNoResults&&this._data.currentQuery.substr(0,this._lastQueryWithNoResults.length)==this._lastQueryWithNoResults},t.prototype.onNoResults=function(n){this._lastQueryWithNoResults=n},t.prototype.onSuggestionsRendered=function(t,i,r,u,f){f==n.DataSources.Web&&(this._lastQueryWithNoResults=null)},t}(),r=function(){function t(n){this._searchFormInstance=n;this._exceededNextWordLimit=!1}return t.prototype.getCallbacks=function(){return new n.EventRegistration(this)},t.prototype.set=function(){if(this._searchFormInstance.config.ascqsl!=2e3){var t=this._searchFormInstance.getCurrentQuery(),i=this._searchFormInstance.searchBox.offsetWidth,r=this._searchFormInstance.searchForm?n.Utils.CalcWidth(this._searchFormInstance.searchForm,t):0,u=r/i;this._exceededNextWordLimit=u>.7}},t.prototype.match=function(){return this._exceededNextWordLimit},t}(),u=function(){function t(n){this._searchFormInstance=n;this._supressQueryCall=!1}return t.prototype.getCallbacks=function(){return new n.EventRegistration(this)},t.prototype.set=function(){this._supressQueryCall=this._searchFormInstance.getCurrentQuery().length>this._searchFormInstance.getCursorPosition()?!1:!0},t.prototype.match=function(){return this._supressQueryCall},t}(),t=function(){function t(){this._rules=[]}return t.prototype.init=function(t){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)},t.prototype.onSearchFormInitialized=function(n){this._searchFormInstance=n;this.addRules();this.addCallbacks()},t.prototype.addRules=function(){var n=this._searchFormInstance.config;n.eNw&&n.nwLim&&this._rules.push(new r(this._searchFormInstance));n.suppnores&&this._rules.push(new i(n));!n.ascontainer||n.isMobile||n.iscxtab||this._rules.push(new u(this._searchFormInstance))},t.prototype.addCallbacks=function(){var o=this._rules.length,r,u,t,f,e,i;if(o)for(r=this._searchFormInstance.autosuggest,u=new n.EventRegistration(this),u.add(18,this.onTextChanged),r.registerEvents(u),t=0,f=this._rules;t<f.length;t++)e=f[t],i=e.getCallbacks(),i&&(r.registerEvents(i),this._searchFormInstance.internalEventTrigger&&this._searchFormInstance.internalEventTrigger.registerEvents(i))},t.prototype.updateDataForRules=function(){var n,t,i;for(this._data={currentQuery:this._searchFormInstance.getCurrentQuery()},n=0,t=this._rules;n<t.length;n++)i=t[n],i.set(this._data)},t.prototype.getSuppressRequestForQuery=function(){var n,t,i;if(this._data.currentQuery.length>this._searchFormInstance.config.ascqsl)return 1;if(!this._searchFormInstance.config.noNextWordTermination&&this._data.currentQuery.length>1)for(n=0,t=this._rules;n<t.length;n++)if(i=t[n],i.match())return 1;return 0},t.prototype.onTextChanged=function(){this.updateDataForRules();this._searchFormInstance.suppressRequestForQuery=this.getSuppressRequestForQuery()},t}();n.PrefixThrottling=t;n.SearchForm.ScopeExtensions.push(new t)})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(t){var i;(function(i){function tt(n,t,i,f){var c="",a,v,y,b,l,o;if(!r||!r.displayName)return c;for(i!==e&&(s=!1),n.msShSugHdr&&!f&&t.length>0&&!s&&(c+=p(n,r.displayName,i),s=!0),b="sa_sg baw_small",l=0;l<t.length;l++)o=t[l],v=u(o.url),a=u(o.query).toLowerCase(),y=o.query.toLowerCase(),c+='<li class="'.concat(b,'" role="option" url="').concat(v,'" query="').concat(a,'" stype="').concat(o.stype,'" h="').concat(o.instItem.getHValue(),'" id="').concat(o.id,"_").concat(l,'">').concat(h(n,o,i,y,f),"<\/li>");return n.msShWebRecourse&&i===e&&i&&i.trim()&&(c+=w(n,i)),e=i,c}function it(n,t){var i,r,e=_ge("as_MSBASRibbonSearchWorkForQuery"),o=_ge("as_MSBASRibbonSearchTenantForQuery"),s=y();if(!e||!o)return null;var h='"'.concat(t,'"'),c=(i=e.value)===null||i===void 0?void 0:i.replace("{0}",h),f=s&&((r=o.value)===null||r===void 0?void 0:r.replace("{0}",s).replace("{1}",h));return f&&f.length<70&&(c=f),n.replace("{0}",u(c))}function rt(t,i,r){var s=nt,e=n.AS.BingAtWorkTemplateManager.getTenantThemeColors(),o,f,h;return e&&e.length>0&&(s=e[0]),o="",r==="MSBERN"&&(o="https://bing.com"),i&&i.length>0?(f=u(i).toLowerCase(),h=sa_loc.MsbBannerClickThrough!==null?sa_loc.MsbBannerClickThrough+". "+f:f,'<li role="option" url="'.concat(o,"/work/search?q=").concat(f,"&amp;FORM=").concat(r,'" query="').concat(f,'" id="asmsbribbon_li" aria-label="').concat(h,'"><div class="sa_msbribboncontainer" id="as_msbribboncontainer"><div class="sa_msbribbonright as_msb_').concat(r,'R"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="body_1" width="20" height="20"><g transform="matrix(0.8333334 0 0 0.8333334 0 0)"><g transform="matrix(1 0 0 1 0 0)"><\/g><path transform="matrix(1 0 0 1 0 0)"  d="M24 3.5L24 18.5L0 18.5L0 3.5L7.5 3.5L7.5 2C 7.5 1.78906 7.53906 1.59375 7.61719 1.41406C 7.69531 1.23438 7.80078 1.07812 7.93359 0.945312C 8.07422 0.804688 8.23438 0.695313 8.41406 0.617188C 8.59375 0.539062 8.78906 0.5 9 0.5L9 0.5L15 0.5C 15.2109 0.5 15.4062 0.539062 15.5859 0.617188C 15.7656 0.695313 15.9219 0.804688 16.0547 0.945312C 16.1953 1.07812 16.3047 1.23438 16.3828 1.41406C 16.4609 1.59375 16.5 1.78906 16.5 2L16.5 2L16.5 3.5L24 3.5zM9 3.5L15 3.5L15 2L9 2L9 3.5zM1.5 5L1.5 7.16797L9 10.9062L9 9.5L15 9.5L15 10.9062L22.5 7.16797L22.5 5L1.5 5zM10.5 11L10.5 12.5L13.5 12.5L13.5 11L10.5 11zM22.5 17L22.5 8.83203L15 12.5938L15 14L9 14L9 12.5938L1.5 8.83203L1.5 17L22.5 17z" stroke="none" fill="#').concat(s,'" fill-rule="nonzero" /><\/g><\/svg><\/div><div class="sa_msbribbonleft as_msb_').concat(r,'R" id="as_msbribbontextwithtenantname" style="display: flex;">{0}<\/div><\/div><\/li>')):null}function y(){return r&&r.displayName}function ut(){return l&&l.themeColors}function ft(n){var r,t=_ge("as_MSBlmanagehistorytext"),i;return t!==null&&(r=t),t===null?(i=n.indexOf('<li id="as_foot"'),i===-1?n:sa_loc.ManageHistory?n.replace("{2}",sa_loc.ManageHistory.slice(2,-2)):n.slice(0,i)):n.replace("{2}",u(r.value.slice(2,-2)))}function et(n,t,i,f,o){var tt,l="",v="",y="",g="",nt,it,et;if(a=!1,!r||!r.displayName)return l;i!==e&&(s=!1);n.msShSugHdr&&!f&&t.length>0&&!s&&(l+=p(n,r.displayName,i),s=!0);var rt=n.asszrdc?"sa_sg":"sa_sg baw_small",ut=n.asszrdc?"sa_sg sa_ent":"sa_sg baw_small",ft=0;for(nt=0,it=t;nt<it.length;nt++){var c=it[nt],b=void 0,k=void 0,d=void 0;k=u(c.url);b=u(c.query).toLowerCase();d=(tt=c===null||c===void 0?void 0:c.query)===null||tt===void 0?void 0:tt.toLowerCase();n.promoteUserHistoryForAADUser&&c.stype=="UserHistory"?(a=!0,i!==undefined&&(i===null||i===void 0?void 0:i.trim())===""?ft<n.msblmt&&(g+='<li class="'.concat(rt,'" role="option" url="').concat(k,'" query="').concat(b,'" stype="').concat(c.stype,'" h="').concat(c.instItem.getHValue(),'" id="').concat(c.id,'" logicalId="').concat(o,'">').concat(h(n,c,i,d,f),"<\/li>")):g+='<li class="'.concat(rt,'" role="option" url="').concat(k,'" query="').concat(b,'" stype="').concat(c.stype,'" h="').concat(c.instItem.getHValue(),'" id="').concat(c.id,'" logicalId="').concat(o,'">').concat(h(n,c,i,d,f),"<\/li>"),ft++):c.confidence==="High"&&n.webMsbQFRanking?v+='<li class="'.concat(ut,'" role="option" url="').concat(k,'" query="').concat(b,'" stype="').concat(c.stype,'" h="').concat(c.instItem.getHValue(),'" id="').concat(c.id,'" logicalId="').concat(o,'">').concat(h(n,c,i,d,f),"<\/li>"):c.confidence==="Low"&&(y+='<li class="'.concat(ut,'" role="option" url="').concat(k,'" query="').concat(b,'" stype="').concat(c.stype,'" h="').concat(c.instItem.getHValue(),'" id="').concat(c.id,'" logicalId="').concat(o,'">').concat(h(n,c,i,d,f),"<\/li>"))}return l=n.promoteUserHistoryForAADUser?n.msbSugLabelEnabled&&!i&&(v||y)&&!f?g+st()+"|||"+v+"|||"+y:g+"|||"+v+"|||"+y:v+"|||"+y,n.msShWebRecourse&&i===e&&i&&i.trim()&&(l+=w(n,i)),a&&!n.CommonFooter&&(et=n.aadManageHistoryUrl,l+='<li id="as_foot" class="as_rmhswarning fd_side" role="option"><a id="as_foot_link" class="as_rmhswarningtxt" href= '.concat(et,">{2}<\/a><\/li>")),e=i,l}function ot(n,t){var i,u,r;if((n.dataSource=="MSB"||n.dataSource=="MSBC")&&(i=t.getElementsByClassName("baw_pimg"),i&&i.length>0))for(u=function(){switch(i[r].getAttribute("stype")){case"Person":i[r].addEventListener("error",function(n){var t=n.target;t.src="https://www.bing.com/s/a/anon.png";t.onerror=null});break;case"Group":i[r].addEventListener("error",function(n){var t=n.target;t.style.display="none";t.onerror=null});i[r].addEventListener("load",function(n){var t=n.target;t.parentElement&&(t.parentElement.style.background="");t.onload=null});break;case"External":var n=function(t){var i=t.target;i.style.display="none";i.removeEventListener("error",n)};i[r].addEventListener("error",n)}},r=0;r<i.length;r++)u()}function p(n,t){var i=n.msShSugHdrResTxt?sa_loc.BAW_SuggestionTypeFormat:sa_loc.BAW_WorkResults;return'<li class="'.concat("sa_sg baw_small",'"><div id="baw_sug" class="sa_bawhead"><div class="sa_tm"><cite>')+"".concat(i.replace("{0}",u(t)).toLocaleUpperCase())+"<\/cite><\/div><\/div><\/li>"}function st(){var n=sa_loc.BAW_SugLabel;return'<li class= "sa_sg baw_small" role="option"><div class="bw_sug_label" id="bw_sug_la">'+"<span> ".concat(n,"<\/span>")+"<\/div><\/li>"}function h(n,t,i,r,u){var o="sa_tm bw_sa_flx bw_small_text",s="",l,a;if(n.leftIconOnSuggestions){var h=n.ascontainer?ti():ii(),y=n.isMobile,e=y?ui():"";return t.stype==="UserHistory"?n.EnableHistoryIcon?n.msbSugLabelEnabled?(l=g(),"".concat(e,'<div class="sa_bw_sg_icon_area">').concat(l,'<\/div><div class="sa_tm sa_tmHS bw_uh-alg">').concat(f(n,t,i,r),"<\/div>")):(a=ri(n.asszrdc),"".concat(e,'<div class="sa_sg_icon_area">').concat(a,'<\/div><div class="sa_tm sa_tmHS">').concat(f(n,t,i,r),"<\/div>")):"".concat(e,'<div class="sa_sg_icon_area">').concat(h,'<\/div><div class="sa_tm sa_tmHS">').concat(f(n,t,i,r),"<\/div>"):n.leftIconOnMsbSuggestions?"".concat(e).concat(c(n,t),'<div class="').concat(o,'">').concat(v(n)).concat(f(n,t,i,r),"<\/div>"):'<div class="sa_sg_icon_area">'.concat(h,'<\/div><div class="').concat(o,'">').concat(c(n,t)).concat(v(n)).concat(f(n,t,i,r),"<\/div>")}return t.stype==="UserHistory"&&!u?s+'<div class="sa_tm sa_tmHS">'.concat(f(n,t,i,r),"<\/div>"):u?s+"".concat(c(n,t,u)).concat(f(n,t,i,r,u)):s+'<div class="'.concat(o,'">').concat(c(n,t)).concat(v(n)).concat(f(n,t,i,r),"<\/div>")}function f(n,t,i,r,u){if(t){var f=k(r,i,n.msbRevHitHilighted);return u?t.stype==="UserHistory"?'<div class="sa_tm sa_tmHS">'.concat(f,"<\/div>"):'<div class="sa_tm">'.concat(f,"<\/div>"):t.stype==="UserHistory"?'<span class="bw-hl">'.concat(f,"<\/span>"):'<span class="bw-hl">'.concat(f).concat(ht(t.annotation,n.asEnableDarkModeHandlingForSuggestion),"<\/span>")}return""}function ht(n,t){var i=u(n);return n&&n.length?t==null||t===undefined||!t?"&nbsp;&middot;&nbsp;<cite>".concat(i,"<\/cite>"):'&nbsp;&middot;&nbsp;<cite class="dm-text">'.concat(i,"<\/cite>"):""}function v(n){var i,f;return n.msShSugHdr?"":(!r||!r.displayName||r.displayName.length>n.bawmaxtenlen?i=sa_loc.BAW_SuggestionTypeFallback:(f=u(r.displayName),i=n.bawShowResultText&&sa_loc.BAW_SuggestionTypeFormat?t.Utils.formatString(sa_loc.BAW_SuggestionTypeFormat,[f]):f),'<cite class="'.concat(n.bawHover?n.asEnableDarkModeHandlingForSuggestion?"bw-cn dm-text":"bw-cn":n.asEnableDarkModeHandlingForSuggestion?"bw-cn-st dm-text":"bw-cn-st",'">').concat(i,"<\/cite>"))}function w(t,i){var f="/search?q=".concat(encodeURIComponent(i),"&form=").concat(t.bfbfrmcde,"&cvid=").concat(encodeURIComponent(_G.IG)),e=n.AS.BingAtWorkIconProvider.getFileSvg(!1,"Web"),r=u(i);return'<li class="'.concat("sa_sg baw_small",'" id="bw_li_webrecourse" role="option" url="').concat(f,'" query="').concat(r,'" menu="webSerpMenu">')+'<div id="baw_rec" class="sa_bawhead"><div class="'.concat("sa_tm bw_sa_flx bw_webrec bw_small_text",'">')+"".concat(b(t,e,!1,!0,!0))+"<span>".concat(sa_loc.BAW_WebRecourseFormat.replace("{0}",r),"<\/span>")+"<\/div><\/div><\/li>"}function c(n,t,i){var u=vt(n,t.icon,r.theme,t.externalDirectoryObjectId||t.id,i,t.fileType,t.iconUrl);return b(n,u,i,ct(t.icon),!!t.fileType,n.leftIconOnMsbSuggestions)}function b(n,t,i,r,u,f){var o=!i&&r?u?f?"bw-file-ic-lt":"bw-file-ic-rt":f?"bw-bks-ic-lt":"bw-bks-ic-rt":"";if(t){var s=n.asszrdc?"sa_sg_icon":"",e='<span class="'.concat(s," ").concat(o,'">').concat(t,"<\/span>"),h=n.asszrdc?"sa_sg_icon_area bw-lt-icon bw-small-img":"bw-lt-icon bw-small-img";return i?'<div class="as_icon as_bw_icon">'.concat(e,"<\/div>"):f?'<div class="'.concat(h,'">').concat(e,"<\/div>"):e}return""}function ct(n){return n!=2&&n!=6}function lt(n){return(n.isLocalDebug||n.isNtpClientqfEnabled)&&!r&&(r={displayName:"Microsoft",theme:"#0078D4"}),r}function k(n,t,i){var f,s,h,e,v;if(!n||!n.length)return"";if(!t||n==t)return t?o(n,i):u(n);if(f="",s=n.indexOf(t),s>=0)return h=s+t.length,s>0&&(f+=o(n.substring(0,s),!i)),f+=o(n.substring(s,h),i),h<n.length&&(f+=o(n.substring(h),!i)),f;e={};v=t.split(" ");v.forEach(function(t){var i=n.indexOf(t);i>=0&&(!e[i]||t.length>e[i])&&(e[i]=t.length)});for(var r=0,c=0,l="",a="",y="";r<n.length;)e[r]?(l=n.substring(c,r),a=o(l,!i),c=r+e[r],y=o(n.substring(r,c),i),f+=a+y,r+=e[r]):(r++,r==n.length&&(l=n.substring(c,r),a=o(l,!i),f+=a));return f.length?f:u(n)}function o(n,t){return t?at(n):u(n)}function at(n){var t=u(n);return"<strong>".concat(t,"<\/strong>")}function u(n){var t=document.createElement("div");return t.textContent=n,t.innerHTML.replace(/"/g,"&quot;")}function vt(n,t,i,r,u,f,e){switch(t){case 1:return wt(i,u);case 2:return yt(n,r,u);case 3:return bt(i,u);case 4:return kt(i,u);case 5:return d(i,u,f);case 7:return dt(i,u);case 6:return gt(n,r,i,u);case 8:return ni(i,u);case 9:return pt(i,u,e);case 10:return n.msbSugLabelEnabled?g():null;default:return null}}function yt(n,i,r){var u=t.Utils.formatString(n.bfbPplPhotoFmt,[encodeURIComponent(i)]),f='<span class="def_ic_pl"><img src='.concat(u,' class="baw_pimg" stype="Person" ').concat(r?"width=24 height=24":"width=25 height=25"," ");return f+"/><\/span>"}function pt(n,t,i){return i?"<span><img src=".concat(i,' class="baw_pimg" stype="External" ').concat(t?"width=18 height=18":"width=24 height=24"," /><\/span>"):d(n,t)}function wt(n,t){return"<svg ".concat(t?"width=18 height=18":"width=20 height=20",' viewBox="0 0 150 204">')+"<g fill=".concat(n,">")+'<path d="M152.76,0V175.73L127.3,163v38.29L63.65,169.47,0,201.29V25.46H25.46V0ZM114.57,180.61V38.19H12.73V180.61l50.92-25.46ZM140,155.15V12.73H38.19V25.46H127.3V148.78Z"/><\/g><\/svg>'}function bt(n,t){return"<svg ".concat(t?"width=18 height=18":"width=20 height=20",' viewBox="0 0 200 204">')+"<g fill=".concat(n,">")+'<path d="M95.28,132.07a71.19,71.19,0,0,1,18.3,10.6,70.42,70.42,0,0,1,14.12,15.16,71.59,71.59,0,0,1,9.1,18.6A67.94,67.94,0,0,1,140,197.32v6.36H127.3v-6.36A55.54,55.54,0,0,0,122.78,175a57.64,57.64,0,0,0-30.49-30.48,57,57,0,0,0-44.55,0A57.58,57.58,0,0,0,17.26,175a55.38,55.38,0,0,0-4.53,22.28v6.36H0v-6.36a67.94,67.94,0,0,1,3.23-20.89,71.59,71.59,0,0,1,9.1-18.6,70.42,70.42,0,0,1,14.12-15.16,71.19,71.19,0,0,1,18.3-10.6,43.19,43.19,0,0,1-8-7.16,44.94,44.94,0,0,1-6.07-8.8,45.85,45.85,0,0,1-3.83-9.94,44,44,0,0,1,2.19-28A45,45,0,0,1,52.66,54.45a44.43,44.43,0,0,1,34.71,0A45,45,0,0,1,111,78.12a44,44,0,0,1,2.19,28.05,45.85,45.85,0,0,1-3.83,9.94,44.94,44.94,0,0,1-6.07,8.8A43.19,43.19,0,0,1,95.28,132.07ZM70,127.3a30.81,30.81,0,0,0,12.33-2.49A31.86,31.86,0,0,0,92.44,118a32.43,32.43,0,0,0,6.86-10.14,30.51,30.51,0,0,0,2.54-12.38A30.19,30.19,0,0,0,99.3,83.14a32.59,32.59,0,0,0-17-17A30.34,30.34,0,0,0,70,63.65a30.69,30.69,0,0,0-12.39,2.54,32.6,32.6,0,0,0-10.14,6.86,31.86,31.86,0,0,0-6.81,10.09,30.82,30.82,0,0,0-2.49,12.34,31.15,31.15,0,0,0,2.49,12.38,31.68,31.68,0,0,0,17,17A31.17,31.17,0,0,0,70,127.3ZM203.68,0V101.84H178.22L140,140V101.84H127.3V89.11h25.46V109.3L173,89.11h18V12.73H63.65V35.6q-3.18.4-6.41,1a45,45,0,0,0-6.32,1.74V0Z"/><\/g><\/svg>'}function kt(n,t){return"<svg ".concat(t?"width=18 height=18":"width=20 height=20",' viewBox="0 0 125 204">')+"<g fill=".concat(n,">")+'<path d="M63.65,0A62.17,62.17,0,0,1,80.56,2.29,64.35,64.35,0,0,1,95.77,8.7,63.93,63.93,0,0,1,118.6,31.53,64.53,64.53,0,0,1,125,46.74a62.17,62.17,0,0,1,2.29,16.91,51.23,51.23,0,0,1-1.64,13.08,64.61,64.61,0,0,1-4.72,12.38L63.65,203.68,6.37,89.11A64.66,64.66,0,0,1,1.64,76.73,51.23,51.23,0,0,1,0,63.65,62.17,62.17,0,0,1,2.29,46.74,64.53,64.53,0,0,1,8.7,31.53,63.93,63.93,0,0,1,31.53,8.7,64.35,64.35,0,0,1,46.74,2.29,62.17,62.17,0,0,1,63.65,0ZM111,84.14a42.3,42.3,0,0,0,3.88-10,43.53,43.53,0,0,0,1.29-10.49A50.86,50.86,0,0,0,112,43.26a53,53,0,0,0-28-28,52.4,52.4,0,0,0-40.78,0,52.93,52.93,0,0,0-28,28,50.7,50.7,0,0,0-4.13,20.39,40.24,40.24,0,0,0,1.39,10.54,53.11,53.11,0,0,0,3.78,10l47.34,94.68ZM63.65,26.26a36.37,36.37,0,0,1,14.57,2.93A37.42,37.42,0,0,1,98.11,49.08a37.69,37.69,0,0,1,0,29.14A37.42,37.42,0,0,1,78.22,98.11a37.69,37.69,0,0,1-29.14,0A37.51,37.51,0,0,1,29.19,78.22a37.69,37.69,0,0,1,0-29.14A37.51,37.51,0,0,1,49.08,29.19,36.37,36.37,0,0,1,63.65,26.26Zm0,63.65a25.75,25.75,0,0,0,10.24-2,26.19,26.19,0,0,0,14-14,26.72,26.72,0,0,0,0-20.48,26.19,26.19,0,0,0-14-14,26.72,26.72,0,0,0-20.48,0,26.19,26.19,0,0,0-14,14,26.72,26.72,0,0,0,0,20.48,26.19,26.19,0,0,0,14,14A25.75,25.75,0,0,0,63.65,89.91Z"/><\/g><\/svg>'}function d(t,i,r){return n.AS.BingAtWorkIconProvider?n.AS.BingAtWorkIconProvider.getFileSvg(i,r):"<svg ".concat(i?"width=18 height=18":"width=20 height=20",' viewBox="0 0 13 16">')+"<g fill=".concat(t,">")+'<path d="M8.7 0L13 4.3V16H0V0H8.7ZM9 1.7V4H11.3L9 1.7ZM1 15H12V5H8V1H1V15ZM3 8V7H10V8H3ZM3 10V9H10V10H3ZM3 12V11H10V12H3Z"/><\/g><\/svg>'}function dt(n,t){return"<svg ".concat(t?"width=18 height=18":"width=20 height=20",' viewBox="0 0 13 16">')+"<g fill=".concat(n,">")+'<path d="M2 0H13V16H2C1.72396 16 1.46354 15.9479 1.21875 15.8438C0.979167 15.7396 0.768229 15.5964 0.585938 15.4141C0.403646 15.2318 0.260417 15.0208 0.15625 14.7812C0.0520833 14.5365 0 14.276 0 14V2C0 1.72396 0.0520833 1.46615 0.15625 1.22656C0.260417 0.981771 0.403646 0.768229 0.585938 0.585938C0.768229 0.403646 0.979167 0.260417 1.21875 0.15625C1.46354 0.0520833 1.72396 0 2 0ZM12 15V13H2C1.85938 13 1.72917 13.026 1.60938 13.0781C1.48958 13.1302 1.38281 13.2031 1.28906 13.2969C1.20052 13.3854 1.13021 13.4896 1.07812 13.6094C1.02604 13.7292 1 13.8594 1 14C1 14.1406 1.02604 14.2708 1.07812 14.3906C1.13021 14.5104 1.20052 14.6172 1.28906 14.7109C1.38281 14.7995 1.48958 14.8698 1.60938 14.9219C1.72917 14.974 1.85938 15 2 15H12ZM12 12V1H2C1.85938 1 1.72917 1.02604 1.60938 1.07812C1.48958 1.13021 1.38281 1.20312 1.28906 1.29688C1.20052 1.38542 1.13021 1.48958 1.07812 1.60938C1.02604 1.72917 1 1.85938 1 2V12.2656C1.3125 12.0885 1.64583 12 2 12H12ZM6 10V5H7V10H6ZM6 4V3H7V4H6Z"/><\/g><\/svg>'}function gt(n,i,r,u){var f=t.Utils.formatString(n.bfbGrpPhotoFmt,[encodeURIComponent(i)]),e='<svg xmlns=\'http://www.w3.org/2000/svg\' width="100%" height="100%" viewBox="-2 -3 20 20">'+'<g fill="'.concat(r,'">')+'<path d="M14.5 3.4C14.7 3.5 14.9 3.7 15.1 3.9 15.3 4 15.4 4.3 15.6 4.5 15.7 4.7 15.8 4.9 15.9 5.2 16 5.5 16 5.7 16 6L15 6C15 5.7 14.9 5.5 14.8 5.2 14.7 5 14.6 4.8 14.4 4.6 14.2 4.4 14 4.3 13.8 4.2 13.5 4.1 13.3 4 13 4 12.7 4 12.5 4.1 12.2 4.2 12 4.3 11.8 4.4 11.6 4.6 11.4 4.8 11.3 5 11.2 5.2 11.1 5.5 11 5.7 11 6 11 6.5 10.9 6.9 10.7 7.4 10.5 7.8 10.2 8.1 9.8 8.4 10.1 8.6 10.4 8.8 10.7 9.1 11 9.3 11.2 9.6 11.4 9.9 11.6 10.2 11.7 10.5 11.8 10.9 11.9 11.3 12 11.6 12 12L11 12C11 11.6 10.9 11.2 10.8 10.8 10.6 10.5 10.4 10.2 10.1 9.9 9.8 9.6 9.5 9.4 9.2 9.2 8.8 9.1 8.4 9 8 9 7.6 9 7.2 9.1 6.8 9.2 6.5 9.4 6.2 9.6 5.9 9.9 5.6 10.2 5.4 10.5 5.2 10.8 5.1 11.2 5 11.6 5 12L4 12C4 11.6 4.1 11.3 4.2 10.9 4.3 10.5 4.4 10.2 4.6 9.9 4.8 9.6 5 9.3 5.3 9.1 5.6 8.8 5.9 8.6 6.2 8.4 5.8 8.1 5.5 7.8 5.3 7.4 5.1 6.9 5 6.5 5 6 5 5.7 4.9 5.5 4.8 5.2 4.7 5 4.6 4.8 4.4 4.6 4.2 4.4 4 4.3 3.8 4.2 3.5 4.1 3.3 4 3 4 2.7 4 2.5 4.1 2.2 4.2 2 4.3 1.8 4.4 1.6 4.6 1.4 4.8 1.3 5 1.2 5.2 1.1 5.5 1 5.7 1 6L0 6C0 5.7 0 5.5 0.1 5.2 0.2 4.9 0.3 4.7 0.4 4.5 0.6 4.3 0.7 4 0.9 3.9 1.1 3.7 1.3 3.5 1.5 3.4 1.4 3.2 1.2 3 1.1 2.7 1 2.5 1 2.3 1 2 1 1.7 1.1 1.5 1.2 1.2 1.3 1 1.4 0.8 1.6 0.6 1.8 0.4 2 0.3 2.2 0.2 2.5 0.1 2.7 0 3 0 3.3 0 3.5 0.1 3.8 0.2 4 0.3 4.2 0.4 4.4 0.6 4.6 0.8 4.7 1 4.8 1.2 4.9 1.5 5 1.7 5 2 5 2.3 5 2.5 4.9 2.7 4.8 3 4.6 3.2 4.5 3.4 4.9 3.6 5.2 3.9 5.5 4.3 5.8 3.9 6.1 3.6 6.6 3.4 7 3.1 7.5 3 8 3 8.5 3 9 3.1 9.4 3.4 9.9 3.6 10.2 3.9 10.5 4.3 10.8 3.9 11.1 3.6 11.5 3.4 11.4 3.2 11.2 3 11.1 2.7 11 2.5 11 2.3 11 2 11 1.7 11.1 1.5 11.2 1.2 11.3 1 11.4 0.8 11.6 0.6 11.8 0.4 12 0.3 12.2 0.2 12.5 0.1 12.7 0 13 0 13.3 0 13.5 0.1 13.8 0.2 14 0.3 14.2 0.4 14.4 0.6 14.6 0.8 14.7 1 14.8 1.2 14.9 1.5 15 1.7 15 2 15 2.3 15 2.5 14.9 2.7 14.8 3 14.6 3.2 14.5 3.4ZM2 2C2 2.1 2 2.3 2.1 2.4 2.1 2.5 2.2 2.6 2.3 2.7 2.4 2.8 2.5 2.9 2.6 2.9 2.7 3 2.9 3 3 3 3.1 3 3.3 3 3.4 2.9 3.5 2.9 3.6 2.8 3.7 2.7 3.8 2.6 3.9 2.5 3.9 2.4 4 2.3 4 2.1 4 2 4 1.9 4 1.7 3.9 1.6 3.9 1.5 3.8 1.4 3.7 1.3 3.6 1.2 3.5 1.1 3.4 1.1 3.3 1 3.1 1 3 1 2.9 1 2.7 1 2.6 1.1 2.5 1.1 2.4 1.2 2.3 1.3 2.2 1.4 2.1 1.5 2.1 1.6 2 1.7 2 1.9 2 2ZM8 8C8.3 8 8.5 7.9 8.8 7.8 9 7.7 9.2 7.6 9.4 7.4 9.6 7.2 9.7 7 9.8 6.8 9.9 6.5 10 6.3 10 6 10 5.7 9.9 5.5 9.8 5.2 9.7 5 9.6 4.8 9.4 4.6 9.2 4.4 9 4.3 8.8 4.2 8.5 4.1 8.3 4 8 4 7.7 4 7.5 4.1 7.2 4.2 7 4.3 6.8 4.4 6.6 4.6 6.4 4.8 6.3 5 6.2 5.2 6.1 5.5 6 5.7 6 6 6 6.3 6.1 6.5 6.2 6.8 6.3 7 6.4 7.2 6.6 7.4 6.8 7.6 7 7.7 7.2 7.8 7.5 7.9 7.7 8 8 8ZM12 2C12 2.1 12 2.3 12.1 2.4 12.1 2.5 12.2 2.6 12.3 2.7 12.4 2.8 12.5 2.9 12.6 2.9 12.7 3 12.9 3 13 3 13.1 3 13.3 3 13.4 2.9 13.5 2.9 13.6 2.8 13.7 2.7 13.8 2.6 13.9 2.5 13.9 2.4 14 2.3 14 2.1 14 2 14 1.9 14 1.7 13.9 1.6 13.9 1.5 13.8 1.4 13.7 1.3 13.6 1.2 13.5 1.1 13.4 1.1 13.3 1 13.1 1 13 1 12.9 1 12.7 1 12.6 1.1 12.5 1.1 12.4 1.2 12.3 1.3 12.2 1.4 12.1 1.5 12.1 1.6 12 1.7 12 1.9 12 2Z"/><\/g><\/svg>',o=_w.btoa(e),s="url('data:image/svg+xml;base64,".concat(o,"') no-repeat;"),h='<span class="def_ic_pl" style="background:'.concat(s,'"><img src=').concat(f,' class="baw_pimg" stype="Group" ').concat(u?"width=24 height=24":"width=25 height=25"," ");return h+" /><\/span>"}function ni(n,t){return"<svg ".concat(t?"width=18 height=18":"width=20 height=20",' viewBox="0 0 2048 2048">')+"<g fill=".concat(n,">")+'<path d="M2011 1728l-318 317-90-90 163-163h-614v-128h614l-163-163 90-90 318 317zm-624 192l128 128H256V256h512q0-53 20-99t55-82 81-55 100-20q53 0 99 20t82 55 55 81 20 100h512v1073l-128-128V384h-128v256H512V384H384v1536h1003zM640 384v128h768V384h-256V256q0-27-10-50t-27-40-41-28-50-10q-27 0-50 10t-40 27-28 41-10 50v128H640z" /><\/g><\/svg>'}function ti(){return'<div class="sa_sg_icon"><svg width="19" height = "19" viewBox = "0 0 19 19" fill = "none"><path class="lefticon_gray70_fill" d="M8 0.75C12.0041 0.75 15.25 3.99594 15.25 8C15.25 9.7319 14.6427 11.3219 13.6295 12.5688L18.5303 17.4697C18.8232 17.7626 18.8232 18.2374 18.5303 18.5303C18.2641 18.7966 17.8474 18.8208 17.5538 18.6029L17.4697 18.5303L12.5688 13.6295C11.3219 14.6427 9.7319 15.25 8 15.25C3.99594 15.25 0.75 12.0041 0.75 8C0.75 3.99594 3.99594 0.75 8 0.75ZM8 2.25C4.82436 2.25 2.25 4.82436 2.25 8C2.25 11.1756 4.82436 13.75 8 13.75C11.1756 13.75 13.75 11.1756 13.75 8C13.75 4.82436 11.1756 2.25 8 2.25Z" fill = "#767676" /><\/svg><\/div>'}function ii(){return'<div class="sa_sg_icon"><svg height="18px" width="18px" viewBox="0 0 25 25"><path class="gray70_stroke" stroke="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" fill="none" d="M23.75 23.75l-9-9"> <\/path><circle class="gray70_stroke" stroke ="#767676" stroke-width="2.5" stroke-linecap="round" stroke-miterlimit="10" cx="9" cy="9" r="7.75" fill="none"> <\/circle><path fill="none" d="M25 25h-25v-25h25z"> <\/path><\/svg><\/div>'}function ri(n){return n?'<div class="sa_sg_icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none"><path class="gray70_stroke lefticon_gray70_fill" fill="#767676" stroke="#767676" d="M3.16305 1.67099L3.1518 1.66998L3.14056 1.67099L3.05967 1.67824L3.04842 1.67976C2.81307 1.72247 2.62779 1.90775 2.58508 2.1431L2.58356 2.15435L2.5763 2.23524L2.5758 2.24648V5.84648L2.5763 5.85773L2.58356 5.93862L2.58508 5.94987C2.62779 6.18522 2.81307 6.37049 3.04842 6.41321L3.05967 6.41473L3.14056 6.42198L3.1518 6.42248H6.30001L6.31126 6.42198L6.39214 6.41473L6.4034 6.41321C6.67219 6.36442 6.87601 6.12939 6.87601 5.84648C6.87601 5.56358 6.67219 5.32855 6.4034 5.27976L6.39214 5.27824L6.31126 5.27098L6.30006 5.27048L4.08153 5.26958C4.99855 4.05814 6.33695 3.21429 7.87668 2.92892C11.2294 2.30753 14.451 4.5217 15.0724 7.87441C15.6938 11.2271 13.4797 14.4488 10.1269 15.0701C6.7742 15.6915 3.5525 13.4773 2.93111 10.1246C2.86654 9.77625 2.80902 9.08613 2.83062 8.57368C2.84403 8.25584 2.59723 7.98733 2.2794 7.97392C1.96157 7.96052 1.69304 8.20731 1.67964 8.52514C1.65421 9.12825 1.71864 9.90423 1.79841 10.3346C2.53573 14.3129 6.35856 16.9402 10.3369 16.2029C14.3151 15.4655 16.9424 11.6428 16.2051 7.66447C15.4678 3.68618 11.645 1.05887 7.66675 1.7962C6.13492 2.08011 4.76974 2.831 3.7273 3.91392L3.7278 2.24653L3.7273 2.23524L3.72005 2.15435L3.71853 2.1431C3.67582 1.90775 3.49054 1.72247 3.25519 1.67976L3.24394 1.67824L3.16305 1.67099ZM8.56305 5.27098L8.5518 5.26998L8.54056 5.27098L8.45967 5.27824L8.44842 5.27976C8.21307 5.32247 8.02779 5.50775 7.98508 5.7431L7.98356 5.75435L7.9763 5.83524L7.9758 5.84648V9.45L7.9763 9.46125L7.98356 9.54216L7.98508 9.55341C8.02779 9.78876 8.21307 9.97398 8.44842 10.0167L8.45967 10.0183L8.54056 10.0255L8.5518 10.026H10.8018L10.8131 10.0255L10.894 10.0183L10.9052 10.0167C11.174 9.96795 11.3778 9.73287 11.3778 9.45C11.3778 9.16713 11.174 8.93206 10.9052 8.88328L10.894 8.88175L10.8131 8.87451L10.8018 8.874H9.12781V5.84648L9.12727 5.83524L9.12007 5.75435L9.11854 5.7431C9.07579 5.50775 8.89054 5.32247 8.65519 5.27976L8.64394 5.27824L8.56305 5.27098Z" fill="#EDEBE9" stroke="#767676" stroke-width="0.266"><\/path><\/svg><\/div>':'<div class="sa_sg_icon"><svg height="19px" width="19px" viewBox="0 0 19 19"><path class="gray70_stroke lefticon_gray70_fill" fill="#767676" stroke="#767676" stroke-width="0.28" d="M3.51449 1.85665L3.50199 1.85553L3.4895 1.85665L3.39962 1.86471L3.39957 1.86414L3.38712 1.8664C3.12562 1.91386 2.91976 2.11972 2.8723 2.38122L2.87174 2.38111L2.87061 2.39372L2.86255 2.4836L2.86199 2.48355V2.49609V6.49609H2.86143L2.86255 6.50859L2.87061 6.59847L2.87004 6.59852L2.8723 6.61097C2.91976 6.87247 3.12562 7.07832 3.38712 7.12579L3.38701 7.12635L3.39962 7.12748L3.4895 7.13553L3.48945 7.13609H3.50199H7V7.13665L7.0125 7.13553L7.10237 7.12748L7.10243 7.12805L7.11488 7.12579C7.41353 7.07158 7.64 6.81043 7.64 6.49609C7.64 6.18176 7.41353 5.92061 7.11488 5.8664L7.11498 5.86584L7.10237 5.86471L7.0125 5.85665L7.01255 5.8561L7.00006 5.85609L4.53502 5.85509C5.55394 4.50904 7.04105 3.57143 8.75186 3.25435C12.4771 2.56392 16.0567 5.02411 16.7471 8.74934C17.4376 12.4746 14.9774 16.0542 11.2521 16.7446C7.52688 17.435 3.94721 14.9748 3.25678 11.2496C3.18503 10.8625 3.12112 10.0957 3.14512 9.52631C3.16002 9.17316 2.8858 8.87481 2.53266 8.85991C2.17951 8.84502 1.88115 9.11923 1.86626 9.47238C1.838 10.1425 1.90959 11.0047 1.99822 11.4829C2.81747 15.9032 7.06506 18.8224 11.4854 18.0032C15.9057 17.1839 18.8249 12.9364 18.0057 8.51608C17.1864 4.09576 12.9389 1.17652 8.5186 1.99578C6.81657 2.31123 5.2997 3.14556 4.14144 4.3488L4.14199 2.49614L4.14256 2.49614L4.14144 2.4836L4.13338 2.39372L4.13395 2.39367L4.13169 2.38122C4.08423 2.11972 3.87837 1.91386 3.61687 1.8664L3.61697 1.86584L3.60437 1.86471L3.51449 1.85665ZM9.51449 5.85665L9.50199 5.85553L9.4895 5.85665L9.39962 5.86471L9.39957 5.86414L9.38712 5.8664C9.12562 5.91386 8.91976 6.11972 8.8723 6.38122L8.87174 6.38111L8.87061 6.39372L8.86255 6.4836L8.86199 6.48355V6.49609V10.5H8.86143L8.86255 10.5125L8.87061 10.6024L8.87004 10.6024L8.8723 10.6149C8.91976 10.8764 9.12562 11.0822 9.38712 11.1297L9.38702 11.1303L9.39962 11.1314L9.4895 11.1394L9.48945 11.14H9.50199H12.002V11.1406L12.0145 11.1394L12.1044 11.1314L12.1044 11.132L12.1169 11.1297C12.4155 11.0755 12.642 10.8143 12.642 10.5C12.642 10.1857 12.4155 9.92451 12.1169 9.87031L12.117 9.86974L12.1044 9.86861L12.0145 9.86056L12.0145 9.86H12.002H10.142V6.49609H10.1426L10.1414 6.4836L10.1334 6.39372L10.1339 6.39367L10.1317 6.38122C10.0842 6.11972 9.87837 5.91386 9.61687 5.8664L9.61697 5.86584L9.60437 5.86471L9.51449 5.85665Z" /><\/svg><\/div>'}function g(){return'<div class="sa_sg_icon"><svg "width=24 height=24 viewBox=0 0 24 24"><path class="gray70_stroke lefticon_gray70_fill" fill="#767676" stroke="#767676" stroke-width="0.28" d="M19.5 12C19.5 7.85786 16.1421 4.5 12 4.5C10.0309 4.5 8.23907 5.25883 6.90093 6.5H8.25C8.66421 6.5 9 6.83579 9 7.25C9 7.66421 8.66421 8 8.25 8H5.25C4.83579 8 4.5 7.66421 4.5 7.25V4.25C4.5 3.83579 4.83579 3.5 5.25 3.5C5.66421 3.5 6 3.83579 6 4.25V5.29168C7.59227 3.86656 9.69494 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 11.5317 3.03576 11.0718 3.10471 10.6228C3.161 10.2562 3.48623 10 3.85708 10C4.31609 10 4.64845 10.4382 4.58123 10.8923C4.52772 11.2538 4.5 11.6236 4.5 12C4.5 16.1421 7.85786 19.5 12 19.5C16.1421 19.5 19.5 16.1421 19.5 12ZM12.5 7.75C12.5 7.33579 12.1642 7 11.75 7C11.3358 7 11 7.33579 11 7.75V12.25C11 12.6642 11.3358 13 11.75 13H14.25C14.6642 13 15 12.6642 15 12.25C15 11.8358 14.6642 11.5 14.25 11.5H12.5V7.75Z" fill = "#212121" /><\/svg><\/div>'}function ui(){return'<div class="as_icon as_qb" aria-hidden="true"><\/div>'}var nt="0078D4",r,l,e,s=!1,a=!1;sj_evt.bind("bfbtcfg",function(n){return r=n[1]},!0);sj_evt.bind("bfbTenantSettings",function(n){return l=n[1]},!0);sj_evt.bind("autosuggestHide",function(){return e=""},!0);i.generateHtml=tt;i.replaceLocalizedStringsInMSBEHtml=it;i.generateMSBEngagementHtml=rt;i.getTenantDisplayName=y;i.getTenantThemeColors=ut;i.replaceLocalizedStringsInMSBHtml=ft;i.generateMsbHtml=et;i.handleMsbImageError=ot;i.getTenantConfig=lt;i.getHitHighlightedText=k})(i=t.BingAtWorkTemplateManager||(t.BingAtWorkTemplateManager={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t;(function(n){function t(n,t){var i="".concat(n?'width="22" height="22"':'width="24" height="24"'),r='viewBox="-1 0 24 24"';switch(t){case"None":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 22.8H4.8V3.6h12L19.2 6z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M16.8 2.4H3.6V24h16.8V6zm0 1.8L18.6 6h-1.8zm-12 18.6h14.4V7.2h-3.6V3.6H4.8z" clip-rule="evenodd"/><\/svg>';case"Word":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#2C5898" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M7.2 3.6H12v1.2H7.2z"/><path fill="#C8C8C8" d="M12 7.2h7.2v1.2H12z"/><path fill="#C8C8C8" d="M12 9.6h7.2v1.2H12z"/><path fill="#C8C8C8" d="M12 12h7.2v1.2H12z"/><path fill="#C8C8C8" d="M12 14.4h7.2v1.2H12z"/><path fill="#C8C8C8" d="M12 16.8h7.2V18H12z"/><path fill="#fff" d="M6 10.8h1.2V12H6z" opacity=".6"/><path fill="#fff" d="M3.6 14.4h1.2v1.2H3.6z" opacity=".6"/><path fill="#fff" d="M9.6 14.4h1.2v1.2H9.6z" opacity=".6"/><path fill="#fff" d="M7.2 14.4H6v1.2h2.4v-2.4H7.2z" opacity=".6"/><path fill="#fff" d="M7.2 10.8V12H6v1.2H4.8v-2.4H3.6v3.6h1.2v2.4H6v-2.4h1.2v-1.2h1.2v-2.4z"/><path fill="#fff" d="M9.6 10.8v2.4H8.4v3.6h1.2v-2.4h1.2v-3.6z"/><\/svg>';case"Excel":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#008641" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M16.8 16.8h2.4V18h-2.4z"/><path fill="#C8C8C8" d="M16.8 19.2h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M16.8 12h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M16.8 14.4h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M16.8 7.2h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M16.8 9.6h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M13.2 16.8h2.4V18h-2.4z"/><path fill="#C8C8C8" d="M13.2 19.2h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M13.2 12h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M13.2 14.4h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M13.2 7.2h2.4v1.2h-2.4z"/><path fill="#C8C8C8" d="M13.2 9.6h2.4v1.2h-2.4z"/><path fill="#fff" d="M6 12h2.4v2.4H6z"/><path fill="#fff" d="M8.4 10.8h1.2V12H8.4z"/><path fill="#fff" d="M8.4 9.6h1.2v1.2H8.4z"/><path fill="#fff" d="M4.8 10.8H6V12H4.8z"/><path fill="#fff" d="M4.8 9.6H6v1.2H4.8z"/><path fill="#fff" d="M9.6 9.6h1.2v1.2H9.6z" opacity=".6"/><path fill="#fff" d="M3.6 9.6h1.2v1.2H3.6z" opacity=".6"/><path fill="#fff" d="M3.6 15.6h1.2v1.2H3.6z" opacity=".6"/><path fill="#fff" d="M4.8 13.2H6v1.2H4.8z" opacity=".6"/><path fill="#fff" d="M6 10.8h1.2V12H6z" opacity=".6"/><path fill="#fff" d="M7.2 14.4h1.2v1.2H7.2z" opacity=".6"/><path fill="#fff" d="M8.4 12h1.2v1.2H8.4z" opacity=".6"/><path fill="#fff" d="M9.6 15.6h1.2v1.2H9.6z" opacity=".6"/><path fill="#fff" d="M4.8 14.4H6v1.2H4.8z"/><path fill="#fff" d="M4.8 15.6H6v1.2H4.8z"/><path fill="#fff" d="M8.4 14.4h1.2v1.2H8.4z"/><path fill="#fff" d="M8.4 15.6h1.2v1.2H8.4z"/><\/svg>';case"PowerPoint":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#F5BA9D" d="M14.4 4.8A3.6 3.6 0 0 1 18 8.4h-3.6z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#C8C8C8" d="M18 9.6a4.8 4.8 0 1 1-4.8-4.8v4.8z"/><path fill="#F04E23" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M12 16.8h7.2V18H12z"/><path fill="#C8C8C8" d="M12 19.2h7.2v1.2H12z"/><path fill="#fff" d="M4.8 10.8H6v6H4.8z"/><path fill="#fff" d="M8.4 10.8h1.2v2.4H8.4z"/><path fill="#fff" d="M6 13.2h2.4v1.2H6z"/><path fill="#fff" d="M6 9.6h2.4v1.2H6z"/><path fill="#fff" d="M4.8 9.6H6v1.2H4.8z"/><path fill="#fff" d="M8.4 9.6h1.2v1.2H8.4z" opacity=".6"/><path fill="#fff" d="M8.4 13.2h1.2v1.2H8.4z" opacity=".6"/><\/svg>';case"Pdf":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 21.6H4.8V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M16.8 1.2H3.6v21.6h16.8v-18zm0 1.8 1.8 1.8h-1.8zm-12 18.6h14.4V6h-3.6V2.4H4.8z" clip-rule="evenodd"/><path fill="#C8C8C8" d="M6 3.6h4.8v1.2H6z"/><path fill="#C8C8C8" d="M6 7.2h12v1.2H6z"/><path fill="#C8C8C8" d="M6 9.6h12v1.2H6z"/><path fill="#D65532" fill-rule="evenodd" d="M7.2 13.2h9.6v7.2H7.2zm8.4 6v-4.8H8.4v4.8z" clip-rule="evenodd"/><path fill="#D65532" d="M2.4 14.4H6v4.8H2.4z"/><path fill="#D65532" d="M18 14.4h3.6v4.8H18z"/><\/svg>';case"Video":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M2.4 4.8h19.2v14.4H2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M1.2 20.4V3.6h21.6v16.8zm1.2-1.2h19.2V4.8H2.4z" clip-rule="evenodd"/><path fill="#69AFE5" d="M9.6 8.4v7.2l6-3.6z"/><path fill="#C8C8C8" d="M3.6 15.6h1.2v1.2H3.6z"/><path fill="#C8C8C8" d="M3.6 18h1.2v1.2H3.6z"/><path fill="#C8C8C8" d="M3.6 13.2h1.2v1.2H3.6z"/><path fill="#C8C8C8" d="M3.6 10.8h1.2V12H3.6z"/><path fill="#C8C8C8" d="M3.6 8.4h1.2v1.2H3.6z"/><path fill="#C8C8C8" d="M3.6 6h1.2v1.2H3.6z"/><path fill="#C8C8C8" d="M19.2 15.6h1.2v1.2h-1.2z"/><path fill="#C8C8C8" d="M19.2 18h1.2v1.2h-1.2z"/><path fill="#C8C8C8" d="M19.2 13.2h1.2v1.2h-1.2z"/><path fill="#C8C8C8" d="M19.2 10.8h1.2V12h-1.2z"/><path fill="#C8C8C8" d="M19.2 8.4h1.2v1.2h-1.2z"/><path fill="#C8C8C8" d="M19.2 6h1.2v1.2h-1.2z"/><\/svg>';case"OneNote":case"OneNotePage":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 21.6H6V2.4h13.2v1.2h1.2v3.6h-1.2z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M4.8 1.2h15.6v1.2h1.2v6h-1.2v14.4H4.8zm14.4 2.4V2.4H6v19.2h13.2V7.2h1.2V3.6z" clip-rule="evenodd"/><path fill="#803A7A" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M7.2 3.6H12v1.2H7.2z"/><path fill="#C8C8C8" d="M12 7.2h6v1.2h-6z"/><path fill="#C8C8C8" d="M12 9.6h6v1.2h-6z"/><path fill="#C8C8C8" d="M12 12h6v1.2h-6z"/><path fill="#C8C8C8" d="M12 14.4h6v1.2h-6z"/><path fill="#C8C8C8" d="M12 16.8h6V18h-6z"/><path fill="#fff" d="M4.8 9.6H6v7.2H4.8z"/><path fill="#fff" d="M8.4 9.6h1.2v7.2H8.4z"/><path fill="#fff" d="M6 12h1.2v1.2H6z"/><path fill="#fff" d="M7.2 13.2h1.2v1.2H7.2z"/><path fill="#fff" d="M7.2 12h1.2v1.2H7.2z" opacity=".6"/><path fill="#fff" d="M6 10.8h1.2V12H6z" opacity=".6"/><path fill="#fff" d="M6 13.2h1.2v1.2H6z" opacity=".6"/><path fill="#fff" d="M7.2 14.4h1.2v1.2H7.2z" opacity=".6"/><\/svg>';case"InfoPath":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#6A3889" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M18 7.2h-6v1.2h6v1.2h-6v1.2h7.2V7.2z"/><path fill="#C8C8C8" d="M18 12h-6v1.2h6v1.2h-6v1.2h7.2V12z"/><path fill="#C8C8C8" d="M18 16.8h-6V18h6v1.2h-6v1.2h7.2v-3.6z"/><path fill="#C8C8C8" d="M7.2 3.6H12v1.2H7.2z"/><path fill="#fff" d="M6 9.6h1.2v7.2H6z"/><path fill="#fff" d="M7.2 9.6h1.2v7.2H7.2z" opacity=".6"/><\/svg>';case"Visio":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#C8C8C8" fill-rule="evenodd" d="M16.8 14.46V9.6h-2.4V7.2h-6v6h6v-2.4h1.2v3.66a3 3 0 1 0 1.2 0M13.2 12H9.6V8.4h3.6zm1.2 5.4a1.8 1.8 0 1 0 3.6 0 1.8 1.8 0 0 0-3.6 0" clip-rule="evenodd"/><path fill="#2C5898" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#fff" d="M6 13.2h2.4v1.2H6z" opacity=".6"/><path fill="#fff" d="M6 15.6h2.4v1.2H6z"/><path fill="#fff" d="M6 14.4h2.4v1.2H6z"/><path fill="#fff" d="M4.8 10.8H6v3.6H4.8z"/><path fill="#fff" d="M8.4 10.8h1.2v3.6H8.4z"/><path fill="#fff" d="M3.6 9.6h1.2v1.2H3.6z"/><path fill="#fff" d="M4.8 14.4H6v1.2H4.8z" opacity=".6"/><path fill="#fff" d="M7.2 12h1.2v1.2H7.2z" opacity=".6"/><path fill="#fff" d="M6 12h1.2v1.2H6z" opacity=".6"/><path fill="#fff" d="M3.6 10.8h1.2V12H3.6z" opacity=".6"/><path fill="#fff" d="M4.8 9.6H6v1.2H4.8z" opacity=".6"/><path fill="#fff" d="M8.4 9.6h1.2v1.2H8.4z" opacity=".6"/><path fill="#fff" d="M9.6 10.8h1.2V12H9.6z" opacity=".6"/><path fill="#fff" d="M9.6 9.6h1.2v1.2H9.6z"/><path fill="#fff" d="M8.4 14.4h1.2v1.2H8.4z" opacity=".6"/><\/svg>';case"Publisher":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#C8C8C8" fill-rule="evenodd" d="M10.8 12h8.4v8.4h-8.4zm7.2 7.2v-6h-6v6z" clip-rule="evenodd"/><path fill="#C8C8C8" fill-rule="evenodd" d="M8.4 7.2h8.4v6H8.4zm7.2 4.8V8.4h-6V12z" clip-rule="evenodd"/><path fill="#0B7669" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" d="M12 14.4h1.2V18H12z"/><path fill="#7DBAB2" d="M14.4 14.4h2.4v1.2h-2.4z"/><path fill="#7DBAB2" d="M12 9.6h2.4v1.2H12z"/><path fill="#7DBAB2" d="M14.4 16.8h2.4V18h-2.4z"/><path fill="#fff" d="M4.8 10.8H6v6H4.8z"/><path fill="#fff" d="M8.4 10.8h1.2v2.4H8.4z"/><path fill="#fff" d="M6 13.2h2.4v1.2H6z"/><path fill="#fff" d="M6 9.6h2.4v1.2H6z"/><path fill="#fff" d="M4.8 9.6H6v1.2H4.8z"/><path fill="#fff" d="M8.4 9.6h1.2v1.2H8.4z" opacity=".6"/><path fill="#fff" d="M8.4 13.2h1.2v1.2H8.4z" opacity=".6"/><\/svg>';case"Project":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#307439" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#C8C8C8" fill-rule="evenodd" d="M12 7.2h7.2v13.2H12v-1.2h2.4V8.4H12zm3.6 12H18V8.4h-2.4z" clip-rule="evenodd"/><path fill="#8BBF8A" d="M12 9.6h4.8v1.2H12z"/><path fill="#8BBF8A" d="M12 12h4.8v1.2H12z"/><path fill="#8BBF8A" d="M12 16.8h4.8V18H12z"/><path fill="#8BBF8A" d="M13.2 14.4H18v1.2h-4.8z"/><path fill="#fff" d="M4.8 10.8H6v6H4.8z"/><path fill="#fff" d="M8.4 10.8h1.2v2.4H8.4z"/><path fill="#fff" d="M6 13.2h2.4v1.2H6z"/><path fill="#fff" d="M6 9.6h2.4v1.2H6z"/><path fill="#fff" d="M4.8 9.6H6v1.2H4.8z"/><path fill="#fff" d="M8.4 9.6h1.2v1.2H8.4z" opacity=".6"/><path fill="#fff" d="M8.4 13.2h1.2v1.2H8.4z" opacity=".6"/><\/svg>';case"Access":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M20.4 21.6H6V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M18 1.2H4.8v21.6h16.8v-18zM18 3l1.8 1.8H18zM6 21.6h14.4V6h-3.6V2.4H6z" clip-rule="evenodd"/><path fill="#C8C8C8" fill-rule="evenodd" d="M10.8 13.2h8.4v7.2h-8.4zm7.2 6v-4.8h-6v4.8z" clip-rule="evenodd"/><path fill="#C8C8C8" fill-rule="evenodd" d="M9.6 7.2h7.2v7.2H9.6zm6 6V8.4h-4.8v4.8z" clip-rule="evenodd"/><path fill="#A23739" d="M2.4 7.2 12 6v14.4l-9.6-1.2z"/><path fill="#F7A8AB" d="M12 13.2h7.2v2.4H12z"/><path fill="#F7A8AB" d="M12 7.2h4.8v2.4H12z"/><path fill="#fff" d="M8.4 10.8V9.6H6V12h2.4z"/><path fill="#fff" d="M9.6 15.6V12H8.4v2.4H6V12H4.8v3.6H3.6v1.2H6v-1.2h2.4v1.2h2.4v-1.2z"/><path fill="#fff" d="M6 13.2v1.2h2.4V12H6z" opacity=".6"/><path fill="#fff" d="M8.4 10.8h1.2V12H8.4z" opacity=".6"/><path fill="#fff" d="M9.6 14.4h1.2v1.2H9.6z" opacity=".6"/><path fill="#fff" d="M3.6 14.4h1.2v1.2H3.6z" opacity=".6"/><path fill="#fff" d="M4.8 10.8H6V12H4.8z" opacity=".6"/><\/svg>';case"Mail":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M2.4 4.8h19.2v14.4H2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M1.2 20.4V3.6h21.6v16.8zm1.2-1.2h19.2V4.8H2.4z" clip-rule="evenodd"/><path fill="#C8C8C8" d="M3.6 6h3.6v1.2H3.6z"/><path fill="#C8C8C8" d="M7.2 12h9.6v1.2H7.2z"/><path fill="#C8C8C8" d="M7.2 14.4h9.6v1.2H7.2z"/><path fill="#69AFE5" fill-rule="evenodd" d="M16.8 6h3.6v3.6h-3.6zm2.4 2.4V7.2H18v1.2z" clip-rule="evenodd"/><\/svg>';case"Archive":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#A6A6A6" d="M1.2 20.4V6H12l2.4-2.4h8.4v16.8z"/><path fill="#666" d="M14.4 3.6 12 6l2.4 2.4h8.4V3.6z"/><path fill="#EAEAEA" d="M4.8 6h3.6v2.4H4.8z"/><path fill="#EAEAEA" d="M4.8 18h3.6v2.4H4.8z"/><path fill="#EAEAEA" fill-rule="evenodd" d="M3.6 9.6h6v7.2h-6zm1.2 6h3.6v-4.8H7.2v2.4H6v-2.4H4.8z" clip-rule="evenodd"/><\/svg>';case"Audio":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 21.6H4.8V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M16.8 1.2H3.6v21.6h16.8v-18zm0 1.8 1.8 1.8h-1.8zm-12 18.6h14.4V6h-3.6V2.4H4.8z" clip-rule="evenodd"/><path fill="#69AFE5" d="M16.524 10.128C15.84 8.4 13.884 8.1 13.2 7.2v-.6a.6.6 0 0 0-1.2 0v8.172a3.47 3.47 0 0 0-2.22-.372 2.736 2.736 0 0 0-2.58 2.916 2.77 2.77 0 0 0 3.42 1.884 2.88 2.88 0 0 0 2.58-2.52V9.6a3.24 3.24 0 0 1 2.232 1.008 2.64 2.64 0 0 1-.288 3.6.108.108 0 0 0 0 .168c.076.05.176.05.252 0a3.6 3.6 0 0 0 1.128-4.248"/><\/svg>';case"Image":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M2.4 4.8h19.2v14.4H2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M1.2 20.4V3.6h21.6v16.8zm1.2-1.2h19.2V4.8H2.4z" clip-rule="evenodd"/><path fill="#7DBAB2" d="M21.6 17.652v-1.704l-5.4-5.4-3.6 3.6-6-6-4.2 4.2v1.704l4.2-4.2 9.348 9.348h1.704l-4.2-4.2 2.748-2.748z"/><path fill="#F5BA9D" d="M18 7.2h1.2v1.2H18z"/><\/svg>';case"ExternalWebPage":case"Web":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#A6A6A6" fill-rule="evenodd" d="M1.2 12C1.2 6.035 6.035 1.2 12 1.2S22.8 6.035 22.8 12 17.965 22.8 12 22.8 1.2 17.965 1.2 12m15.096-4.8h4.008A9.6 9.6 0 0 0 14.4 2.724 12 12 0 0 1 16.296 7.2M15.6 12c0 1.206-.1 2.41-.3 3.6H8.7a22.1 22.1 0 0 1 0-7.2h6.612A21.6 21.6 0 0 1 15.6 12m-6.66 4.8c.72 3.024 2.052 4.8 3.06 4.8s2.34-1.776 3.072-4.8zm0-9.6c.72-3.024 2.052-4.8 3.06-4.8s2.34 1.776 3.06 4.8zm-1.236 0A12 12 0 0 1 9.6 2.724 9.6 9.6 0 0 0 3.696 7.2zM3.108 8.4h4.368a23.4 23.4 0 0 0 0 7.2H3.108a9.53 9.53 0 0 1 0-7.2m4.596 8.4H3.696A9.6 9.6 0 0 0 9.6 21.276 12 12 0 0 1 7.704 16.8m6.792 4.476.02-.03a9.6 9.6 0 0 0 5.788-4.446h-4.008a12 12 0 0 1-1.78 4.445l-.116.031zm2.028-5.676h4.368a9.53 9.53 0 0 0 0-7.2h-4.368c.185 1.191.278 2.395.276 3.6a23 23 0 0 1-.276 3.6" clip-rule="evenodd"/><\/svg>';case"Xml":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 21.6H4.8V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M16.8 1.2H3.6v21.6h16.8v-18zm0 1.8 1.8 1.8h-1.8zm-12 18.6h14.4V6h-3.6V2.4H4.8z" clip-rule="evenodd"/><path fill="#C8C8C8" d="M6 16.8h12V18H6z"/><path fill="#C8C8C8" d="M6 19.2h12v1.2H6z"/><path fill="#A6A6A6" d="M16.8 13.2h-1.2l1.2-2.4-1.2-2.4h1.2l1.2 2.4z"/><path fill="#A6A6A6" d="M7.2 13.2h1.2l-1.2-2.4 1.2-2.4H7.2L6 10.8z"/><path fill="#6CAEDF" d="M12 13.2a2.4 2.4 0 1 0 0-4.8 2.4 2.4 0 0 0 0 4.8"/><path fill="#DEEBF8" d="M10.8 10.632v.168h.084a.12.12 0 0 0 .084 0c.024-.096-.168-.156-.168-.168"/><path fill="#DEEBF8" d="M10.668 10.524c0-.072-.108-.252-.204-.216s.096.216.108.252.168-.024.096-.036"/><path fill="#DEEBF8" d="M13.92 9.36c0 .072 0 .192-.072.18s0 0-.084 0c0 0-.132 0-.144.072s-.096.096-.096.168v.108c0 .036.072.12 0 .132v.228a.7.7 0 0 0 0 .276c0 .072.12.132.096.228s0 .18.096.18l.12.096s0 .072.072.084.084 0 .132 0 .144-.084.132-.108a.18.18 0 0 1 .18-.168v.156l.072.084-.024-.276a2.4 2.4 0 0 0-.48-1.44"/><path fill="#DEEBF8" d="M12.636 8.508a.4.4 0 0 0-.192 0c-.096 0 .144.156.18.18l.072.072h.216c.048 0 0 0 0 .084v-.132c0-.024-.108 0-.144-.084s.096-.06.108 0 .072 0 .108.072v.408c0 .036 0 0 .072 0s.108.084.108.108-.084 0-.096 0 0 .108 0 .12.132.264.192.264h.168q.015-.06 0-.12a1 1 0 0 1 0-.096V9.24c0-.06.144 0 .168.072s0-.072 0-.084-.096 0-.108-.072.168.12.228.084 0 0 0-.096a.2.2 0 0 0 0-.06V9l-.516-.264-.264-.132h-.072s-.168-.12-.228-.096"/><path fill="#DEEBF8" d="m12.9 8.952-.228-.108c-.084 0 .096.12.096.12v.132-.084s.096.084.132 0 .048-.06 0-.06"/><path fill="#DEEBF8" fill-rule="evenodd" d="M11.726 12.718c-.042.06-.084.122-.122.122q-.025.014-.052.043c-.057.057-.144.143-.416.161a2.4 2.4 0 0 1-.444-.168.4.4 0 0 1 0-.108v-.048c.001-.17.003-.466-.084-.564a1.3 1.3 0 0 1-.204-.144.5.5 0 0 0-.108-.192c-.035-.017-.033-.04-.032-.063.002-.025.004-.05-.04-.069-.084-.036-.084-.048-.084-.108v-.12c0-.072.132-.168.132-.168a.4.4 0 0 0 0-.108l-.072-.132a.25.25 0 0 1-.144-.156v-.228a.12.12 0 0 1 0-.072h-.084a1 1 0 0 0 0-.096c-.042-.014-.047-.048-.051-.074-.003-.02-.006-.034-.021-.034h-.096a.6.6 0 0 1 0-.168.55.55 0 0 1 0-.24.3.3 0 0 0 0-.144 2.4 2.4 0 0 1 .996-1.116l.216.036.204-.096a2.4 2.4 0 0 1 .592-.126.4.4 0 0 0 .076.007c.079.001.165.003.148.119-.024.168-.108.168-.216.168-.069 0-.08-.034-.087-.058-.004-.015-.008-.026-.021-.026h-.132a.13.13 0 0 1-.108 0H11.4c-.014.023-.015.021-.022.017-.01-.008-.034-.024-.146.043-.099.06-.05.119-.006.17.035.042.065.079.006.106-.132.06-.012.144 0 .06.006-.044.035-.045.061-.047.025-.001.047-.002.047-.037 0-.036-.003-.033-.005-.032l.005-.04c.012-.084.072-.084.084-.084l.02-.001c.03-.003.088-.008.088.001q0 .004-.007.01c-.014.011-.04.033.007.098.028.04.066.034.1.03.037-.006.068-.01.068.054q.015.073.06.132v.192h-.108l.004-.033c.006-.033.013-.075-.004-.075h-.132s-.084.108 0 .168-.156.144-.156.06.072-.084.072-.084h-.144a.16.16 0 0 0-.07.044c-.027.024-.053.047-.086.04-.039-.008-.097.03-.14.057-.024.015-.043.027-.052.027h-.084a.3.3 0 0 1 0 .084c-.008.058-.062.065-.115.07a.3.3 0 0 0-.065.014c-.06.024-.12.084-.132.12a5 5 0 0 1-.096.216V9.84h-.108l-.12-.06c-.011 0-.028-.01-.046-.02-.04-.021-.086-.046-.086.02 0 .051-.035.082-.067.11-.027.026-.053.049-.053.082a.4.4 0 0 0 0 .192c.012.12.036.12.108.12a.2.2 0 0 0 .063-.015c.034-.012.063-.024.117.015a.43.43 0 0 1-.072.204c.06.012.06.084.06.084a.32.32 0 0 1 0 .228c-.014.048.044.065.102.082.043.012.087.024.102.05.036.06.144.168.144.168.029 0 .025-.004.018-.01-.01-.01-.026-.028.054-.05.132-.036.132.072.132.072a.08.08 0 0 0 0-.084c.06 0 .093.11.124.207.025.08.048.153.08.153h.168c.056-.042.059-.035.064-.022.003.01.007.022.032.022h.06l.096.084h.204l.084.06a1 1 0 0 0 .082.07l.05.038c.034.027.014.067-.001.095-.011.022-.02.037.001.037q.026 0 .05-.006c.029-.005.054-.01.07.006.024.024.132.144.132.144h.312l.056.003c.034.002.064.005.064-.003v.096c0 .06-.036.156-.132.18s-.096.132-.096.132a.2.2 0 0 1-.168.156c-.048.014-.115.043-.177.07-.047.02-.092.04-.123.05-.034.011-.07.065-.107.118m.086-4.18q.045-.005.092-.006s-.18-.036-.108 0zm-.76.546a.084.084 0 0 0-.084.084.3.3 0 0 1-.017.11c-.01.038-.019.07-.007.07h.108l.012.068c.01.07.016.105.072.04.046-.053.062-.04.068-.043.004-.002.004-.01.004-.041a.2.2 0 0 0-.038-.11.2.2 0 0 1-.034-.094.084.084 0 0 0-.084-.084" clip-rule="evenodd"/><\/svg>';case"Folder":return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#A6A6A6" d="M1.2 20.4V6H12l2.4-2.4h8.4v16.8z"/><path fill="#666" d="M14.4 3.6 12 6l2.4 2.4h8.4V3.6z"/><\/svg>';case"Other":case"Story":case"Csv":case"Xps":case"Text":case"Sketch":default:return"<svg ".concat(i," ").concat(r,' xmlns="http://www.w3.org/2000/svg" fill="none" >')+'<path fill="#fff" d="M19.2 21.6H4.8V2.4h12l2.4 2.4z"/><path fill="#A6A6A6" fill-rule="evenodd" d="M16.8 1.2H3.6v21.6h16.8v-18zm0 1.8 1.8 1.8h-1.8zm-12 18.6h14.4V6h-3.6V2.4H4.8z" clip-rule="evenodd"/><path fill="#C8C8C8" d="M6 3.6h4.8v1.2H6z"/><path fill="#C8C8C8" d="M6 7.2h12v1.2H6z"/><path fill="#C8C8C8" d="M6 9.6h12v1.2H6z"/><path fill="#C8C8C8" d="M6 12h12v1.2H6z"/><path fill="#C8C8C8" d="M6 14.4h12v1.2H6z"/><path fill="#C8C8C8" d="M6 16.8h12V18H6z"/><\/svg>'}}n.getFileSvg=t})(t=n.BingAtWorkIconProvider||(n.BingAtWorkIconProvider={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=AutoSuggest.Service.SuggestionAttributes,r="ich",u=function(){function r(){}return r.prototype.init=function(t){if(t.config.removeSuggUrl){var i=new n.EventRegistration(this);i.add(6,this.internalInit);t.registerEvents(i)}},r.prototype.internalInit=function(n){var t=this;return this.searchForm=n,new i(n.autosuggest,function(n,i){return t.getUrl(n,i)},function(n,i,r){return t.handleResult(n,i,r)})},r.prototype.getUrl=function(n,t){return n.getAttribute("href")=="#rm"||typeof n.className=="string"&&(n.className.indexOf("as_hr")!=-1||n.className.indexOf("sa_rm_cr")!=-1)?this.searchForm.config.removeSuggUrl.replace("%7b0%7d",encodeURIComponent(t.query)):undefined},r.prototype.handleResult=function(i,r){var u,e=JSON.parse(i),f;e.success&&(f=r.offsetHeight,r.className="sa_rmvd",((u=r.parentElement.classList)===null||u===void 0?void 0:u.contains(n.suggestionParentClass))&&r.parentElement.classList.add("sa_rmvd"),[t.InstData,t.Url,t.Query,t.AriaLabel].map(function(n){delete r[n];r.removeAttribute(n)}),r.style.paddingTop=r.style.paddingBottom="0",r.style.height=f+"px",this.searchForm.notifyDeleteHistory(f-2))},r}(),i;n.SearchForm.ScopeExtensions.push(new u);i=function(){function i(t,i,r){var u=this,f;this._autosuggest=t;this._getUrl=i;this._handleResponse=r;f=new n.EventRegistration(this);f.add(20,function(n,t){u.isValidLink(t)&&u.process(t,!0)});t.canvas.registerEvents(f);this._container=t.canvas.container;sj_be(this._container,"mousedown",function(n){u.isValidLink(sj_et(n))&&sj_sp(n)},!0);sj_be(this._container,"click",function(n){var t=sj_et(n),i=n.screenX!=0&&n.screenY!=0;u.deleteHistorySuggestion(n,t,i)},!0);sj_be(this._container,"keydown",function(t){var r,i;t.keyCode==13&&(i=sj_et(t),((r=i.parentElement.classList)===null||r===void 0?void 0:r.contains(n.suggestionParentClass))&&(i=i.getElementsByTagName("a")[0]),u.deleteHistorySuggestion(t,i,!1))},!0)}return i.prototype.deleteHistorySuggestion=function(n,t,i){this.isValidLink(t)&&this.process(t,i)&&(sj_sp(n),sj_pd(n))},i.prototype.process=function(n,t){var i,r,u;if(t===void 0&&(t=!1),i=this.getSuggestionContainer(n),!i)throw new Error("Suggestion container not found.");return(r=this._getUrl(n,i),r)?(this.sendRequest(r,i,t),typeof Log!="undefined"&&typeof Log.Log!="undefined"&&(u=this.getGpingData(i),Log.Log("Request","Delete","Click",!1,"ImpressionGuid",this._autosuggest.data.Inst.IG,"AppNS",u.appNs,"K",u.k)),!0):!1},i.prototype.isValidLink=function(n){return n&&(n.tagName=="A"&&!!n.getAttribute(r)||typeof n.className=="string"&&(n.className.indexOf("as_hr")!=-1||n.className.indexOf("sa_rm_cr")!=-1))},i.prototype.sendRequest=function(n,t,i){var u=this,r=sj_gx();r.open("GET",n,!0);r.onreadystatechange=function(){r.readyState==4&&r.status==200&&u._handleResponse(r.responseText,t,i)};r.withCredentials!==undefined&&(r.withCredentials=!0);r.send()},i.prototype.getSuggestionContainer=function(i){for(var r;i&&i!=this._container&&!i[t.Query];)i=i.parentElement,((r=i.classList)===null||r===void 0?void 0:r.contains(n.suggestionParentClass))&&(i=i.firstElementChild);return i[t.Query]?i:undefined},i.prototype.getGpingData=function(n){var i=n.getAttribute("h"),t;if(!i)throw new Error("Missing 'h' attribute on suggestion element.");if(t=i.replace("ID=","").split(","),t.length!=2)throw new Error("Invalid 'h' attribute on suggestion element.");return{appNs:t[0],k:t[1]}},i}()})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(){var n=sa_config,f,e,o,s,h,c,l,a,r,i,u,v,t,p,w;if(!n.asBundleLoaded){for(n.asBundleLoaded=!0,n.aslogtel&&n.asBundleLoaded&&Log.Log("ASBundleLoad","AS","AutoSuggestBootstrap",!1),performance.mark("AutosuggestJSBundleLoaded"),f=Bing.AS.CommonPrefixDataProvider?new Bing.AS.CommonPrefixDataProvider:new Bing.AS.DataProvider,u=0,v=n.enabledDataSources;u<v.length;u++)t=v[u],(t===Bing.AS.DataSources.BingAtWork||t===Bing.AS.DataSources.Substrate||t===Bing.AS.DataSources.MicrosoftSearchInBing)&&(i||(i=AutoSuggest.BingAtWorkWebTelemetry?new AutoSuggest.BingAtWorkWebTelemetry(n,"AS"):null),r||(r=Bing.AS.MSBWebClientInstrumentation?new Bing.AS.MSBWebClientInstrumentation:Bing.AS.WebClientInstrumentation?new Bing.AS.WebClientInstrumentation:null)),t===Bing.AS.DataSources.BingAtWork?(e=Bing.AS.CachingDataProvider?new Bing.AS.CachingDataProvider(t):Bing.AS.BingAtWorkDataProvider?new Bing.AS.BingAtWorkDataProvider:null,c=Bing.AS.BingAtWorkSuggestionsParserV3?new Bing.AS.BingAtWorkSuggestionsParserV3(n):null):t===Bing.AS.DataSources.Substrate?(o=Bing.AS.SubstrateDataProvider?new Bing.AS.SubstrateDataProvider(i):null,l=Bing.AS.SubstrateSuggestionsParser?new Bing.AS.SubstrateSuggestionsParser(n):null):t===Bing.AS.DataSources.MicrosoftSearchInBing?(s=Bing.AS.MsbDataProvider?new Bing.AS.MsbDataProvider:null,a=Bing.AS.MsbSuggestionsParser?new Bing.AS.MsbSuggestionsParser(n):null):t===Bing.AS.DataSources.MSBEngagment&&(h=Bing.AS.MSBEngagementDataProvider?new Bing.AS.MSBEngagementDataProvider:null);if(n.ascsr){var y=new Bing.AS.InternalEventTrigger,p=new Bing.AS.CsrClientState(y),w=new Bing.AS.WebCore(p,f,e,o,s,h,r,c,l,a,i,y);sa_inst=new Bing.AS.SearchForm(n,w,y)}else Bing.AS.Canvas!==null&&typeof Bing.AS.Canvas!="undefined"&&(p=new Bing.AS.Canvas,w=new Bing.AS.WebCore(p,f,e,o,s,h,r,c,l,a,i),sa_inst=new Bing.AS.SearchForm(n,w));sa_inst!==null&&sa_inst!==undefined&&(sa_inst.init("sa_inst"),sa_eL&&sa_inst.show());_w.sj_evt&&sj_evt.fire("autoSugLoaded");sj_evt.bind("ajax.load",function(n){var t=n&&n[1];t&&t.isInstantRequest&&_w.sj_evt&&sj_evt.fire("autoSugLoaded")})}}()