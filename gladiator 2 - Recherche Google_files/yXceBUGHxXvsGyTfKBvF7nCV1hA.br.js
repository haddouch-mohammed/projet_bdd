var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},__assign,BingAtWork;(function(n){function u(t){n.writeSessionStorage("BingAtWorkConversationId",t)}var i=[],r,t;n.isWindow=function(){return typeof window!="undefined"&&!!window};r=function(){function r(){this.signoutEvtHandlerAdded=!1;this.signoutRetentionNotification="SignoutRetention";this.dwell={};this.queryRegex=new RegExp(/[^/](query|((\?|&)(q|pq)))(?:\"?)(?: ?)([:=])/i);this.nameRegex=new RegExp(/name(?:\"?)(?: ?)([:=])/i);this.userRegex=new RegExp(/user(?:\"?)(?: ?)([:=])/i);this.UPNRegex=new RegExp(/((userprincipalname)|(upn))(?:\"?)(?: ?)([:=])/i);this.emailRegex=new RegExp(/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/);this.QueryRule={key:"Query",regex:this.queryRegex};this.NameRule={key:"Name",regex:this.nameRegex};this.UserRule={key:"User",regex:this.userRegex};this.UPNRule={key:"UPN",regex:this.UPNRegex};this.EmailRule={key:"Email",regex:this.emailRegex};this.RuleSet=[this.EmailRule,this.QueryRule,this.NameRule,this.UserRule,this.UPNRule,];this.checkRules=function(n){var t=!0;return this.RuleSet.forEach(function(i){i.regex.test(n)&&(t=!1)}),t};this.dwellOnUnload=this.dwellOnUnload.bind(this)}return r.init=function(n){typeof bfbTel!="undefined"&&bfbTel.initialized||n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&n.cfg.env!=="TEST"&&(bfbTel.setContext(n),bfbTel.regLogPagePerf(),bfbTel.regTenantSettingsUpdate(),sj_evt.fire("bfbWebTelemetryInitReady"))},r.prototype.setContext=function(r){var u=this,s,e,f,a,h;for(this.ctx=r,this.initialized||(this.initialized=!0,this.ariaLogger=AriaTelemetry.getLogger(r.cfg.t),sj_evt.bind("beforeunload",function(){var t=n.context;(t.wsb||n.isWindow()&&!window.MSLog)&&u.ariaLogger.flushAndTeardown()}),e=(s=n.context===null||n.context===void 0?void 0:n.context.mtCfg)===null||s===void 0?void 0:s.flights,e&&(e.indexOf("bfblqost")>-1&&this.logDiag("immediate trigger",{eventId:"qosTest"}),e.indexOf("bfblqost2s")>-1&&setTimeout(function(){return u.logDiag("2 second delay trigger",{eventId:"qosTest"})},2e3)));i.length>0;){var o=i.shift()||{},c=o.s,l=o.n,v=o.kv,y=o.noContextualKV;c&&l&&this.log(c,l,v,y)}f=this.ctx.isHomepage;sj_evt.bind("bfbWebTelemetryInitReady",function(){var i={};i.alreadySignedIn=n.context&&!!n.context.isAadAuthenticatedAtServer;i.ssoSignedIn=n.context&&!!n.context.isAadAuthenticatedBySSO;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",i)},!0,undefined,!0);sj_evt.bind("aad:signedin",function(i){var e,r={},o=(e=i[1])===null||e===void 0?void 0:e.userObjectId;n.context&&(r.alreadySignedIn=!!n.context.isAadAuthenticatedAtServer,n.context.isAadAuthenticatedBySSO=u.lastSSOAttempt!==null,r.ssoSignedIn=n.context.isAadAuthenticatedBySSO);o&&(u.ctx.uid=o,n.context&&(n.context.aadUserId=o));r.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",r)},!0,undefined,!0);sj_evt.bind("aad:signedout",function(){var i={};n.context&&(n.context.isAadAuthenticatedBySSO=!1);i.latency=u.lastSSOAttempt!==undefined?(performance.now()-u.lastSSOAttempt).toFixed(2):"-1";u.lastSSOAttempt=undefined;u.log(f?t.BingAtWorkHomepage:t.BingAtWork,"SsoError_Events",i)},!0,undefined,!0);sj_evt.bind("aad:ssoattempt",function(){u.lastSSOAttempt=performance.now()},!0,undefined,!0);sj_evt.bind("ajax.unload",function(){u.dwellOnUnload("A")});_w.addEventListener("beforeunload",function(){u.dwellOnUnload("W")});a=function(){u.logSignout(f?t.BingAtWorkHomepage:t.BingAtWork)};h=function(){n.poll({condition:function(){var t=_ge("postLink");return!u.signoutEvtHandlerAdded&&t&&(sj_be(t,"click",a),u.signoutEvtHandlerAdded=!0),u.signoutEvtHandlerAdded},maxAttempts:50,baseIntervalInMillis:100,logName:"SignoutButton:polling"})};sj_be(_ge("id_n"),"click",h);sj_be(_ge("id_p"),"click",h);sj_evt.bind("Identity.SignoutNotifShown",function(){u.logShown(n.EventScope.UserNotification,0,undefined,{eventId:"Notification_Impression",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifSignoutClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Dismiss_Click",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifBackgroundClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Hide_BackgroundClick",notificationKind:u.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifCancelClick",function(){u.logClicked(n.EventScope.UserNotification,!1,undefined,undefined,{eventId:"Notification_Engagement_Click",notificationKind:u.signoutRetentionNotification})})},r.prototype.logShown=function(n,t,i,r){t!=null&&(r=r||{},r.T=String(t));i!=null&&(r=r||{},r.S=i);this.log(n,"Shown_Events",r);this.fireImpressionForMipnTelemetry(n,r)},r.prototype.fireImpressionForMipnTelemetry=function(n,i){if(n===t.UserNotification&&i&&i.notificationKind&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.Impression")),i&&i.eventId&&typeof i.eventId=="string"){var f=i.eventId,u=r.conversionLinkImpressionEventMap[f];u&&sj_evt.fire("MIPN.Telemetry.".concat(u,"ConversionLink.Impression"))}},r.prototype.logRanking=function(n,i,r,u){var f=n||{placement:null,treatment:null,rankingRuleId:null,legend:null},e=f.placement,o=f.treatment,s=f.rankingRuleId,h=f.legend,c={P:e,T:o,R:s,L:h,MTHD:i,AUD:r==null?null:r?1:0,ERR:u?"UNEXPCTRL":null};this.log(t.BingAtWork,"Ranking_Events",c)},r.prototype.logQuery=function(n,i){var r;if(n){var u=n.encryptedQuery,f=n.queryCount,e=n.queryFrequency,o=n.bhvr,s=n.webIntentConf,h=n.ssp,c=n.intent,l=n.groupId;r={QRY:u,CNT:f,FRQ:e,BHVR:o,CONF:s,SSP:h,INT:c,GID:l}}else r={NWK:1,QID:i};console.log("*** TEST");this.log(t.BingAtWork,"Query_Events",r)},r.prototype.logClicked=function(n,i,u,f,e){u!=null&&(e=e||{},e.T=u);f!=null&&(e=e||{},e.S=f);this.log(n,"Clicked_Events",e);this.fireClickForMipnTelemetry(n,e);this.ctx&&this.ctx.sci&&(i?this.sendExternalClickRateInst():this.inst(r.instClickEventType,"BfbClick",{BFB_EXT:i?"1":"0",BFB_T:u,BFB_S:f,BFB_SC:t[n]}));var o={scope:n,target:u,source:f,properties:e};sj_evt.fire("BingAtWork:Click",o)},r.prototype.fireClickForMipnTelemetry=function(n,i){var u,f,e;i&&i.eventId&&typeof i.eventId=="string"&&(u=i.eventId,n===t.UserNotification&&i&&i.notificationKind&&(f=r.notificationClickToTelemetryEventMap[u],f&&sj_evt.fire("MIPN.Telemetry.".concat(i.notificationKind,"Notification.").concat(f))),e=r.conversionLinkClickEventMap[u],e&&sj_evt.fire("MIPN.Telemetry.".concat(e,"ConversionLink.EngagementClick")))},r.prototype.logValue=function(n,t,i,r){r=r||{};r.N=t;r.V=i;this.log(n,"Value_Events",r)},r.prototype.logSignout=function(n,t,i,r){this.logClicked(n,!1,t,i,r);this.log(n,"SignedOut_Events",r)},r.prototype.logRtt=function(n,t,i,r){var u=this.getRequestRtt(i,r);if(u&&!(u.getCall<0)&&!(u.startCall<0)){var f=u==null?"NOPERF":u.getCall.toFixed(2),e=u==null?"NOPERF":u.startCall.toFixed(2),o={N:t,V:f,ST:e};this.log(n,"Rtt_Events",o)}},r.prototype.logSerpLinkClick=function(n,i){var r={T:"SERP",DOM:n,SERPID:i};this.log(t.Serp,"Clicked_Events",r)},r.prototype.logDiag=function(n,i){i=i||{};i.MSG=n;this.log(t.Diag,"Diag_Events",i)},r.prototype.logErr=function(n,t,i,r,u,f,e){if(f=f||{},f.eventId=r==="UncaughtError"?r:t,f.message=t,this.checkIfPIIClean(i)&&(f.fullMsg=i),u){var o=this.sanitizeUrls(u);this.checkIfPIIClean(o)&&(f.stackTrace2=o)}this.log(n,"Errors",f,e)},r.prototype.regLogPagePerf=function(){var i=this,t;performance!=null&&performance.getEntries!=null&&(t=function(){i.logPagePerf();sj_evt.unbind("onP1",t)},sj_evt.bind("onP1",t,!0,0,!1))},r.prototype.logPagePerf=function(){for(var n,f,e,i=0,u=performance.getEntries();i<u.length;i++){n=u[i];for(f in r.pagePerfMatchConfig)r.pagePerfMatchConfig[f](n)&&(e={N:f,P:n.name,ET:n.entryType,IT:n.initiatorType,FETCH_S:n.fetchStart,REQ_S:n.requestStart,RES_S:n.responseStart,RES_E:n.responseEnd,D:n.duration,TSZ:n.transferSize},this.log(t.BingAtWork,"Perf_Events",e))}},r.prototype.log=function(n,t,r,u){r===void 0&&(r={});this.ariaLogger!=null?this.logInternal(n,t,r,u):i.push({s:n,n:t,kv:r,noContextualKV:u})},r.prototype.logInternal=function(i,r,u,f){var e,o,s,h,c;if(u===void 0&&(u={}),e={eventType:"Client_Events",name:r||"",properties:{}},f||this.fillContextualKV(i,u),u!=null)for(o=0,s=Object.getOwnPropertyNames(u);o<s.length;o++)h=s[o],c=u[h],e.properties[h]={value:c!=null?c:""};this.ariaLogger.logEvent(e)},r.prototype.fillContextualKV=function(t,i){var r=this.ctx,e=r.cfg,o=r.uid,s=r.ig,h=r.tid,c=r.sid,l=r.muid,a=r.tn,v=r.tnid,y=r.msa,p=r.mkt,w=r.b,b=r.dev,k=r.os,d=r.osver,g=r.dc,nt=r.snrVersion,tt=r.canvas,f=typeof _G=="undefined"?{IG:s,EventID:h}:_G,u=n.context,it=u&&u.isEudbEnforced,rt=u&&u.formCode||"";i.ENV=e.env;i.environment=e.env;i.SC=t;i.IG=f.IG;i.impressionGuid=f.IG;i.SID=c;i.TID=f.EventID;it||(i.UID=o);i.MUID=l;i.F=rt;i.TN=a;i.TNID=v;i.MSA=y;i.MKT=p;i.B=w;i.deviceType=b;i["DeviceInfo.OsName"]=k;i["DeviceInfo.OsVersion"]=d;i.dataCenter=g;i.clientType=this.getClientType(u);i.snrVersion=nt;i.logicalSearchId=u&&u.logicalId;i.conversationId=u&&u.conversationId;i.canvas=tt;i.isSnr=!0},r.prototype.getClientType=function(n){return(n===null||n===void 0?void 0:n.isOnWorkVertical)&&(n===null||n===void 0?void 0:n.wsb)?"WsbBingVertical":(n===null||n===void 0?void 0:n.isOnWorkVertical)?"BingVertical":(n===null||n===void 0?void 0:n.wsb)?"Wsb":"Bing"},r.prototype.getRequestRtt=function(t,i){var e=this,f,u,r;return performance==null||performance.getEntries==null?null:(f=performance.getEntries(),u=f.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=e.getPathName(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))}),u.length<1)?{getCall:-1,startCall:-1}:(r=u[0],{getCall:r.duration,startCall:r.fetchStart||r.startTime})},r.prototype.getPathName=function(n){var t=document.createElement("a");return t.href=n,t.pathname},r.prototype.sendExternalClickRateInst=function(){if(typeof _w.si_ct=="function"){var n=_ge("bfb_ExternalLink")||_ge("bfb_InstrumentationLink");n&&_w.si_ct(n)}},r.prototype.instCommand=function(n){this.inst(r.instEventType,"BfbCommand",n)},r.prototype.instAnswerExpansion=function(n){this.inst(r.instEventType,"BfbAnswerExpanded",{V:"1",P:n})},r.prototype.instGleam=function(n){this.inst(r.instEventType,"BfbGleam",{N:n})},r.prototype.instPLT=function(n){this.inst(r.instEventType,"BawPLT",{V:n})},r.prototype.instUserStatus=function(t){var i={};(t===null||t===void 0?void 0:t.ageInDays)&&(i.AgeInDays=t.ageInDays.toString());n.context.isContributedToBingEnabled&&typeof(t===null||t===void 0?void 0:t.isContributedToBingByMsb)=="boolean"&&(i.IsContributedToBingByMsb=t.isContributedToBingByMsb.toString());i&&this.inst(r.instEventType,"UserStatus",i)},r.prototype.instSubsequentLogicalId=function(n){this.inst(r.instEventType,"SubsequentLogicalId",{logicalId:n})},r.prototype.inst=function(t,i,u){for(var o,f=[],e=0,s=Object.getOwnPropertyNames(u);e<s.length;e++)o=s[e],f.push(o),f.push(u[o]||"");Log.Log.apply(Log,__spreadArray([t,i,r.instEventName,!1],f,!1))},r.prototype.dwellStart=function(i,r){var u=this,f;f={DW_S:Date.now(),S:r};n.poll({condition:function(){return u.ctx!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.dwellStart:polling",callback:function(){u.fillContextualKV(i,f);u.dwell[i]=f}})},r.prototype.dwellEnd=function(i){this.logDwell(i);try{delete this.dwell[i]}catch(r){this.dwell[i]=null}},r.prototype.logDwell=function(n,t){var i=this.dwell[n];if(i&&i.DW_S){var u=i.DW_S,r=Date.now(),f=r-u;i.N="DWELL";i.V=f;i.DW_E=r;i.DW_UL=t;this.log(n,"Value_Events",i,!0)}},r.prototype.dwellOnUnload=function(n){for(var i,t=0,r=Object.getOwnPropertyNames(this.dwell);t<r.length;t++)i=r[t],this.dwell.hasOwnProperty(i)&&this.dwell[i]&&this.logDwell(i,n);this.ariaLogger.flush()},r.prototype.regTenantSettingsUpdate=function(){var t=this;sj_evt.bind("bfbTenantSettings",function(i){var r=i[1];t.ctx.tn=r.tenantDisplayName;t.ctx.tnid=t.ctx.tnid||r.tenantObjectId;n.context&&!n.context.tenantId&&(n.context.tenantId=r.tenantObjectId)},!0,undefined,!0)},r.prototype.sanitizeUrls=function(n){var r=new RegExp(/(?:https?|ftp):\/\/[^ ()]+/g),u=new RegExp(/\/[A-Za-z0-9\_]+.js:[0-9]+:[0-9]+/g),t=n===null||n===void 0?void 0:n.match(r),i=n;return t===null||t===void 0?void 0:t.forEach(function(n){var t,r=(t=n===null||n===void 0?void 0:n.match(u))===null||t===void 0?void 0:t.shift(),f="[URL Removed]".concat(r||"");i=i.replace(n,f)}),i},r.prototype.checkIfPIIClean=function(n){var t=!1;try{t=this.checkRules(n)}catch(i){}return t},r.instEventType="ClientInst",r.instClickEventType="DHTMLClick",r.instEventName="BAW",r.conversionLinkImpressionEventMap={Mainline_SNR_Low_Confidence_See_Results_Impression:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Impression:"TenantToHomepage",Tenant_To_ZQ_Impression:"TenantToZQ",Tenant_To_BackArrow_Impression:"TenantToBackArrow",Tenant_To_Chat_Impression:"TenantToChat",Header_To_ZQ_Impression:"HeaderToZQ"},r.conversionLinkClickEventMap={Mainline_SNR_Low_Confidence_See_Results_Click:"MainlineSNRLowConfidenceSeeResults",Tenant_To_Homepage_Click:"TenantToHomepage",Tenant_To_ZQ_Click:"TenantToZQ",Tenant_To_BackArrow_Click:"TenantToBackArrow",Tenant_To_Chat_Click:"TenantToChat",Header_To_ZQ_Click:"HeaderToZQ"},r.notificationClickToTelemetryEventMap={Notification_Dismiss_Click:"DismissClick",Notification_Engagement_Click:"EngagementClick",Notification_Hide_BackgroundClick:"BackgroundClick"},r.pagePerfMatchConfig={"RMS:BfbCssBundle":function(n){return n.name.match(/\/rms\/BfbCssBundle\//)},"RMS:BfbPreBundle":function(n){return n.name.match(/\/rms\/BfbPreBundle\//)},"RMS:BfbBundle":function(n){return n.name.match(/\/rms\/BfbBundle\//)},"RMS:BfbDependencies":function(n){return n.name.match(/\/rms\/BfbDependencies\//)}},r}();n.WebTelemetry=r,function(n){n[n.Serp=-1]="Serp";n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.BookmarkSuggest=16]="BookmarkSuggest";n[n.ExploreQuery=17]="ExploreQuery";n[n.Carousel=18]="Carousel";n[n.WebResult=19]="WebResult";n[n.PowerApps=20]="PowerApps";n[n.Conversation=21]="Conversation";n[n.EmbeddedController=22]="EmbeddedController";n[n.UserNotification=23]="UserNotification";n[n.SuggestedQueries=24]="SuggestedQueries";n[n.Site=25]="Site";n[n.ExplorePage=26]="ExplorePage";n[n.LandingPage=27]="LandingPage";n[n.Mainline=37]="Mainline";n[n.BingAtWorkHomepage=43]="BingAtWorkHomepage";n[n.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab";n[n.UnconsciousArrivalUpsell=45]="UnconsciousArrivalUpsell";n[n.LowConfidenceGleam=46]="LowConfidenceGleam";n[n.Rewards=47]="Rewards";n[n.RightRail=60]="RightRail";n[n.BingAtWorkNeo=70]="BingAtWorkNeo";n[n.ErrorPage=83]="ErrorPage";n[n.BceAdminControls=90]="BceAdminControls";n[n.Diag=999]="Diag"}(t=n.EventScope||(n.EventScope={}));n.writeConversationId=u;typeof bfbTel=="undefined"&&(bfbTel=new r,sj_evt.fire("bfbWebTelemetryExists"))})(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r,u){return{onSuccess:function(i,f,e){if(i&&(sj_evt.fire(t,i,r,f,e,n.getSucceededEventDetails(i,f,e)),u&&u.onSuccess))u.onSuccess(i)},onError:function(r,f,e){if(sj_evt.fire(i,r,f,e,n.getFailedEventDetails(r,f)),u&&u.onError)u.onError(r,f,e)}}}t.getResponseHandlers=i})(t=n.WebTelemetry||(n.WebTelemetry={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function rt(n,t){var i={},r=n.flights,u;r&&r.length>0&&(i.variants=r.join());for(u in t)i[u]=t[u];return i}function ut(n,t){var i,r;if(t)for(i in t)r=n.indexOf("?")>-1?"&":"?",n+="".concat(r).concat(encodeURIComponent(i),"=").concat(encodeURIComponent(t[i]));return n}function ft(n){var t=7;switch(n){case 500:t=6;break;case 404:t=9;break;case 401:t=4;break;case 504:t=5;break;case 400:t=8}return t}function et(n){for(var r,t,f,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(!n)return n;for(r=n,t=0;t<u.length;t++)f=new RegExp("\\{".concat(t,"\\}"),"gm"),r=r.replace(f,arguments[t+1]);return r}function ot(t,i){try{return JSON.parse(t)}catch(r){return null}}function st(n,t,i){var r,u;for(i===void 0&&(i=7),r=n,u=0;r&&u<i;u++){if(r===t)return!0;r=r.parentElement}return!1}function ht(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function c(n,t,i,r,u){r===void 0&&(r=0);n()||(t>1?setTimeout(function(){return c(n,t-1,i,r,u)},i+r):u&&u())}function o(n){if(typeof bfbTel!="undefined"&&bfbTel){n();return}sj_evt.bind("bfbWebTelemetryExists",n,!0,undefined,!0)}function ct(t){if(typeof n.Strings!="undefined"&&n.Strings){t();return}sj_evt.bind("BingAtWork:LocStrings",t,!0,null,!0)}function r(){try{return!!("localStorage"in _w&&_w.localStorage)}catch(n){return!1}}function l(t){var i=a(t);if(i){var u=s(t),r=i.cacheExpiryNum,f=i.cacheValueStr;if(!r||window.isNaN(r)||r<(new Date).getTime())h(u);else try{return JSON.parse(f)}catch(e){h(u)}}return undefined}function a(n){var r=s(n),t=wt(r);if(t){var i=t.split(";",2),u=i[0],f=i[1],e=Number(u);return{cacheValueStr:f,cacheExpiryNum:e}}return undefined}function lt(t,i,u,f,e,o,s){var c,h,v,y;if(o===void 0&&(o=!1),s===void 0&&(s=!1),!r())return i({onSuccess:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onSuccess.apply(u,t);f.onSuccess.apply(f,t)},onError:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onError.apply(u,t);f.onError.apply(f,t)}});if(n._isEventBind||(n._isEventBind=!0,sj_evt.bind("ajax.unload",function(){n._localStorageAutoRefreshHandlersBacklog={};n._localStorageOneOffHandlersBacklog={}},!0,null,!0)),n._localStoragePendingAutoRefreshes=n._localStoragePendingAutoRefreshes||{},n._localStorageAutoRefreshHandlersBacklog=n._localStorageAutoRefreshHandlersBacklog||{},n._localStorageOneOffHandlersBacklog=n._localStorageOneOffHandlersBacklog||{},u){if(n._localStorageAutoRefreshHandlersBacklog[t]&&n._localStorageAutoRefreshHandlersBacklog[t].length>0){n._localStorageAutoRefreshHandlersBacklog[t].push(u);return}n._localStorageAutoRefreshHandlersBacklog[t]=[u]}if(f){if(n._localStorageOneOffHandlersBacklog[t]&&n._localStorageOneOffHandlersBacklog[t].length>0){n._localStorageOneOffHandlersBacklog[t].push(f);return}n._localStorageOneOffHandlersBacklog[t]=[f]}if(c=l(t),c!=null&&!s){h=a(t);v=new Date(h===null||h===void 0?void 0:h.cacheExpiryNum);w(t,c,v,!0,i,e,o,!0);return}s;y=p(t,i,e,o);i(y)}function p(t,r,u,f){var e=s(t);return{onSuccess:function(i){var o=u&&u(i);o&&(w(t,i,o,!1,r,u,f),setTimeout(function(){return k(e,"".concat(o.getTime(),";").concat(JSON.stringify(i)))},0))},onError:function(){for(var u=[],r=0;r<arguments.length;r++)u[r]=arguments[r];i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onError&&n.onError.apply(n,u)});f||(n._localStorageAutoRefreshHandlersBacklog[t]=[]);n._localStorageOneOffHandlersBacklog[t]=[]}}}function s(t){return"".concat(n.localStorageCacheKeyPrefix).concat(t)}function w(t,r,u,f,e,o,s,h){if(i(n._localStorageAutoRefreshHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),s||(n._localStorageAutoRefreshHandlersBacklog[t]=[]),i(n._localStorageOneOffHandlersBacklog[t],function(n){n.onSuccess(r,undefined,h)}),n._localStorageOneOffHandlersBacklog[t]=[],s&&!n._localStoragePendingAutoRefreshes[t]){var c=Math.max(u.getTime()-(new Date).getTime()+v,f?y:0);n._localStoragePendingAutoRefreshes[t]=!0;setTimeout(function(){var i=p(t,e,o,s);e(i);n._localStoragePendingAutoRefreshes[t]=!1},c)}}function at(t,i,r){var u,f;return(r===void 0&&(r=";"),!((f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u)))?undefined:vt(n.SessionStorage.getItem(t),i,r)}function vt(n,t,i){if(i===void 0&&(i=";"),!n)return undefined;var u=n.split(i,2),f=u[0],e=u[1],r=Number(f);return!r||window.isNaN(r)||r<=(new Date).getTime()-t?undefined:e}function yt(t,i,r){var u,f;(r===void 0&&(r=";"),(f=(u=n.SessionStorage)===null||u===void 0?void 0:u.isSupported)===null||f===void 0?void 0:f.call(u))&&n.SessionStorage.setItem(t,"".concat((new Date).getTime()).concat(r).concat(i))}function pt(t){try{sessionStorage.removeItem(t)}catch(i){}}function i(n,t){if(n)for(var i=0;i<n.length;i++)t(n[i])}function t(n,t){if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function b(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function k(n,t){if(r())try{localStorage.setItem(n,t)}catch(i){}}function wt(n){if(r())try{var t=localStorage.getItem(n);return t===null?undefined:t}catch(i){}return undefined}function h(t){if(r())try{localStorage.removeItem(t)}catch(i){}}function d(t){var c=t.condition,l=t.maxAttempts,u=t.baseIntervalInMillis,r=t.logName,e=t.callback,f=t.additionalIntervalPerAttemptInMillis,i=t.currentAttempt,s=t.timeOutCallback,h;f=f||0;i=i||0;c()?e!=null&&e():(i++,i<l?(h=__assign(__assign({},t),{baseIntervalInMillis:u+f,currentAttempt:i}),setTimeout(function(){return d(h)},u)):(o(function(){return bfbTel.logDiag("".concat(r,"_TimedOut"))}),s!=null&&s()))}function bt(t,i,r,u,f){for(var s,c,a,y,l=[],h=5;h<arguments.length;h++)l[h-5]=arguments[h];s=new Date;n._throttleRecords||(n._throttleRecords={});c=f.id;c||(c=f.id=b());try{a=JSON.stringify(r)}catch(p){return}var v=f.name||"(anonymous)",o="".concat(v,"_").concat(c,"_").concat(a),e=n._throttleRecords[o];if(e){if(e.totalCalls++,e.clusterCalls++,e.clusterCalls>t)if(y=s.getTime()-e.lastRunTime.getTime(),y>=i)e.clusterCalls=1,e.clusters++;else return e.throttledCalls++,e.lastThrottledCallStack=g("Call throttled"),u(),undefined}else n._throttleRecords[o]={totalCalls:1,clusterCalls:1,allowedCalls:0,throttledCalls:0,firstRunTime:s,lastRunTime:s,clusters:1,name:v};return n._throttleRecords[o].allowedCalls++,n._throttleRecords[o].lastRunTime=s,f.apply(void 0,l)}function g(n){return nt(new Error(n).stack)}function nt(n){return n&&n.replace(/\?.*/gi,"?<query string redacted>")}function kt(t){if(t===void 0&&(t=!0),!n._throttleRecords)return undefined;var r=[],u=Object.keys(n._throttleRecords);return i(u,function(i){var u=n._throttleRecords[i];(!t||u.throttledCalls>0)&&r.push(u)}),r}function dt(){n._throttleRecords={}}function gt(n,t){if(!n)return undefined;for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return undefined}function ni(n){return n&&n.length==0}function ti(t){try{return atob(t)}catch(i){}}function ii(t,i){typeof n.Localhost!="undefined"&&typeof n.Localhost.augmentMsbMtAjax=="function"&&n.Localhost.augmentMsbMtAjax(t,i)}function ri(n){if(!n.isOnWorkVertical)return undefined;var t=(window.location.hash||"").replace("#",""),i=t.indexOf("-");return t.substring(0,i>-1?i:t.length).toLocaleLowerCase()||"all"}function ei(t,i,r){var h=n.context.isErrBAbsorbEnabled,f,s;try{return i()}catch(e){if(f=e.name||e,s="Exception '".concat(f,"' caught at '").concat(t,"'")+(r?", called by '".concat(r,"'"):""),(_G.TEST_HOOKS_ENABLED||_G.TestEnv)&&alert(s),f&&(tt<fi&&(typeof u[f]=="undefined"||u[f]<ui)&&(o(function(){return bfbTel.logErr(n.EventScope.BingAtWork,s,e.message,"UncaughtError",e.stack)}),u[f]=typeof u[f]=="undefined"?1:u[f]+1,tt++),!h))throw e;}}function oi(t){if(!t)return{token:undefined,error:"Empty token string"};try{var i=t.split(".")[1],r=i.replace(/-/g,"+").replace(/_/g,"/"),u=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return{token:JSON.parse(u)}}catch(f){return{token:undefined,error:"Failed to parse token"}}}function si(){return/MSIE|Trident/.test(e())}function e(){return window.navigator.userAgent}function hi(){if(!window.performance)return!1;var n=window.performance.getEntriesByType("navigation");return n.length>0&&n[0].type==="back_forward"||window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD}function ci(n){var t=function(){sb_st(n,100);sj_evt.unbind("aad:signedin",t)};sj_evt.bind("aad:signedin",t,!0,undefined,!0)}function it(){var n=e();return t(n,"OPR/")||t(n,"Opera")?"Opera":t(n,"PhantomJS")?"PhantomJS":t(n,"Edg")?"Edge":t(n,"Electron")?"Electron":t(n,"Chrome")?"Chrome":t(n,"Trident")?"MSIE":t(n,"Firefox")?"Firefox":t(n,"Safari")?"Safari":t(n,"SkypeShell")?"SkypeShell":"Unknown"}function li(){var r,n=e(),t=it(),i;return t==="MSIE"?r=ai(n):t==="Edge"?(i=f(n,t),r=i==="Unknown"?f(n,"Edg"):i):t==="Opera"?(i=f(n,t),r=i==="Unknown"?f(n,"OPR"):i):r=f(n,t),r}function ai(n){var i=n.match(new RegExp("MSIE ([\\d,.]+)")),t;return i?i[1]:(t=n.match(new RegExp("rv:([\\d,.]+)")),t?t[1]:"Unknown")}function f(n,t){t==="Safari"&&(t="Version");var i=n.match(new RegExp(t+"/([\\d,.]+)"));return i?i[1]:"Unknown"}var v,y;n.bawSourceName="BingAtWork";n.msPerDay=864e5;n.getRequestMetadata=rt;n.mergeArgsIntoUrl=ut;n.getError=ft;n.strFormat=et;n.tryParseJson=ot;n.hasAncestorElement=st;n.removeElement=ht;n.retryPoll=c;n.whenWebTelemetryExists=o;n.whenLocStringsAvailable=ct;n.isLocalStorageSupported=r;n.getCacheValueIfValid=l;n.localStorageCacheKeyPrefix="MSBLS_";v=18e4;y=3e4;n.withLocalStorageCache=lt;n.getSessionStorage=at;n.writeSessionStorage=yt;n.removeSessionStorageItem=pt;n.forEach=i;n.includes=t;n.generateGuid=b;n.setItemForLocalStorage=k;n.removeItem=h;n.poll=d;n.throttle=bt;n.getSanitizedCallStack=g;n.redactQueryStrings=nt;n.getThrottleRecords=kt;n.resetThrottleRecords=dt;n.find=gt;n.isEmpty=ni;n.decodeBase64=ti;n.augmentMsbMtAjax=ii;n.getStartedEventDetails=function(){return{startTime:new Date,startTimeStartDuration:performance.now()}};n.getSucceededEventDetails=function(n,t,i){return{endTime:new Date,endTimeStartDuration:performance.now(),response:n,headers:t,status:200,isFromCache:i}};n.getFailedEventDetails=function(n,t){return{endTime:new Date,endTimeStartDuration:performance.now(),error:n,status:t}};n.getLoweredWorkSerpVerticalDomain=ri;var u={},tt=0,ui=5,fi=30;n.withErrorBoundary=ei;n.parseJwt=oi;n.isHostIE=si;n.getUserAgent=e;n.isBackForwardNavigation=hi;n.bindForAad=ci;n.getBrowserName=it;n.getBrowserVersion=li}(BingAtWork||(BingAtWork={})),function(n){function o(t,i,f){var e=function(){if(u){var i=[t.url,t.requestType],e=function(){t.onError&&t.onError(7,0,"throttled")};n.throttle(10,1e4,i,e,r,t,f)}else r(t,f)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("sendAjax",e,i):e()}function r(t,r){var y,a,d,g,h,nt;if(t!=null){var tt=t.timeout,p=t.onSuccess,c=t.onError,l=t.url,w=t.body,it=t.tries,ft=t.requestType,b=t.headers,et=t.convertPropertiesToPascalCase,k=t.accessToken,o=window===null||window===void 0?void 0:window.parent;f&&(a=(y=o===null||o===void 0?void 0:o.BingAtWork)===null||y===void 0?void 0:y.wsb,k=t.accessToken||(a===null||a===void 0?void 0:a.wsbAccessToken));var u=e?typeof(o===null||o===void 0?void 0:o.sj_gx)=="function"?o===null||o===void 0?void 0:o.sj_gx():new XMLHttpRequest:sj_gx(),rt=ft||"GET",ut=function(){return u.open(rt,l,!0)},v=n.redactQueryStrings(l);if(ut(),u.withCredentials=!t.disableWithCredentials,d=function(){return c&&c(5,504,null)},u.ontimeout=(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?function(){return n.withErrorBoundary("Ajax.ontimeout",d,"Ajax ".concat(v))}:d,u.timeout=tt==null?0:tt,g=it||1,h=function(t,i,r,u){n.whenWebTelemetryExists(function(){return bfbTel.logDiag(u,{url:l,reason:i})});c!=null&&c(i,t,r)},k!=null&&u.setRequestHeader("Authorization","Bearer ".concat(k)),s()&&rt==="POST"&&u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),b)for(nt in b)u.setRequestHeader(nt,b[nt]);u.onreadystatechange=function(){var t,f,s,c,e,o;if(u.readyState===4)if(u.status===200){if(p!=null){if(t=null,f={},u.responseText!=null&&u.responseText!=="")try{t=r?u.responseText:JSON.parse(u.responseText)}catch(l){(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(-1,10,u.responseText,"Bad data")},"Ajax ".concat(v)):h(-1,10,u.responseText,"Bad data");return}if(u.HEADERS_RECEIVED)try{s=u.getAllResponseHeaders();c=s.trim().split(/[\r\n]+/);c.forEach(function(n){var t=n.split(": "),i=t.shift(),r=t.join(": ");f[i]=r})}catch(a){}t=et?i(t):t;(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onSuccess",function(){return p(t,f)},"Ajax ".concat(v)):p(t,f)}}else--g>0?(u.abort(),ut(),u.send(w)):(e=n.getError(u.status),o="Ajax call failed with status ".concat(u.status,". No retries available."),(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("Ajax.onAjaxError",function(){return h(u.status,e,u.responseText,o)},"Ajax ".concat(v)):h(u.status,e,u.responseText,o))};u.send(w)}}function i(n){return n===null?null:n===undefined?undefined:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:Array.isArray(n)?n.map(i):Object.keys(n).reduce(function(t,r){var u="".concat(r[0].toUpperCase()).concat(r.slice(1));return t[u]=typeof n[r]=="object"?i(n[r]):n[r],t},{})}function s(){return typeof window=="undefined"||!window.navigator||!window.navigator.userAgent?!1:window.navigator.userAgent.indexOf("PhantomJS")>-1}var t=n.context&&n.context,u=t===null||t===void 0?void 0:t.isThrottlingEnabled,f=(t===null||t===void 0?void 0:t.wsb)||(t===null||t===void 0?void 0:t.miniSerp),e=t===null||t===void 0?void 0:t.miniSerp;n.sendAjax=o}(BingAtWork||(BingAtWork={}));BingAtWork.Wsb=BingAtWork.Wsb||{};BingAtWork.Wsb.sendAjax=function(n,t,i){return BingAtWork.sendAjax(n,i,t)},function(n){var t;(function(t){function i(t,i,r){var u=n.getRequestMetadata(t,r);return n.mergeArgsIntoUrl(i,u)}function r(t,i,r,u,f,e,o){var s={url:t,accessToken:e,requestType:"POST",body:JSON.stringify(i),timeout:u,headers:f,onSuccess:r.onSuccess,onError:r.onError};n.augmentMsbMtAjax(s,"caller: sendPostRequest, file: ServiceHelpers");n.sendAjax(s,"caller: sendPostRequest, file: ServiceHelpers",o)}t.addArgsToUrl=i;t.sendPostRequest=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){t.tenantSettingsAjaxBound=n.Service.tenantSettingsAjaxBound;t.SeverSideCachedVerticalConfigExpirationInSeconds=864e5;var i=n.context||{isCacheTenantSettingsEnabled:!1,isForceRefreshTenantSettingsEnabled:!1,isErrorBoundaryEnabled:!1,tenantId:""},r=i.isCacheTenantSettingsEnabled,f=i.isForceRefreshTenantSettingsEnabled,e=i.isErrorBoundaryEnabled,u=i.tenantId,o=i.aadUserId,s=i.authorized,h=function(){function i(i,r,f){var o=this,s;this.config=i;this.onAjaxLoad=function(){u!==(o.cachedTenantSettings&&o.cachedTenantSettings.tenantObjectId)&&(n.isTenantSettingsPrefetchStarted=!1,o.getTenantSettings());o.broadcastImpl()};this.tenantSettingsApiUrl="".concat(i.apiUriBase).concat(i.tenantSettingsApiUri);this.requireM365DataBoundary=i.enableM365DataBoundary;s=function(){o.onResponse=r;t.tenantSettingsAjaxBound||(sj_evt.bind("ajax.load",o.onAjaxLoad,!0,null,!0),t.tenantSettingsAjaxBound=!0)};e&&n.withErrorBoundary?n.withErrorBoundary("TenantSettingsClientCtr",s,f):s()}return i.isValid=function(n){return!!(n&&n.tenantObjectId&&n.tenantDisplayName)},i.prototype.getTenantSettings=function(i,e){var h=this,c={onSuccess:function(t,f,e){var c,a,l,v,y;t.tenantSettings&&(r?(c=t.tenantSettings,h.requireM365DataBoundary&&(a=n.context,a.m365DataBoundary=c.m365DataBoundary==undefined||c.m365DataBoundary.length==0?["EUDB"]:c.m365DataBoundary),(c.verticalConfigs==undefined||c.verticalConfigs.length==0)&&(s&&o&&(l=c.verticalConfigs==undefined?"verticalConfigs is missing.":"verticalConfigs is empty.",n.whenWebTelemetryExists(function(){return bfbTel.logErr(n.EventScope.BingAtWork,"TenantSettingsClient: TenantSettings response missing valid verticalConfigs","".concat(l," - Will remove from localStorage"),"ClientError")})),v="bfbTenantSettings"+u,y="".concat(n.localStorageCacheKeyPrefix).concat(v),n.removeItem(y)),h.broadcast(t.tenantSettings,t.user,f,e)):h.broadcast(t.tenantSettings,t.user,f,!1),h.onResponse&&h.onResponse.onSuccess&&h.onResponse.onSuccess(t),i&&i.onSuccess&&i.onSuccess(t))},onError:function(t,r,u){if(h.requireM365DataBoundary){var f=n.context;f.m365DataBoundary=["EUDB"]}sj_evt.fire("bfbTenantSettingsFailed",t,r,u,n.getFailedEventDetails(t,r));h.onResponse&&h.onResponse.onError&&h.onResponse.onError(t,r);i&&i.onError&&i.onError(t,r);r===404&&(h.isTenantNotProvisioned=!0)}};if(r){if(n.isTenantSettingsPrefetchStarted)return;sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0;n.withLocalStorageCache("bfbTenantSettings"+u,function(n){h.getTenantSettingsImpl(n,e)},undefined,c,function(){return new Date(Date.now()+t.SeverSideCachedVerticalConfigExpirationInSeconds)},!0,f)}else this.getTenantSettingsImpl(c,e)},i.prototype.convertToJson=function(n){if(!n)return"EmptyJSON";var t=__assign({},n);return delete t.adminEmail,delete t.exploreQueries,delete t.iconLarge,delete t.iconLargeChecksum,JSON.stringify(t)},i.prototype.getCachedTenantSettings=function(){return this.cachedTenantSettings},i.prototype.getIsTenantNotProvisioned=function(){return this.isTenantNotProvisioned},i.prototype.getTenantSettingsImpl=function(t,i){if(!r){if(n.isTenantSettingsPrefetchStarted)return;sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0}var u=__assign(__assign({},n.getRequestMetadata(this.config)),{isLokiVerticalConfigRequired:!0}),e=__assign(__assign({},u),{IsDataBoundaryRequired:!0}),o=n.mergeArgsIntoUrl(i||this.tenantSettingsApiUrl,this.requireM365DataBoundary?e:u),f={url:o,requestType:"GET",timeout:this.config.tenantSettingsTimeout,onSuccess:t&&t.onSuccess,onError:t&&t.onError};n.augmentMsbMtAjax(f,"caller: getTenantSettings, file: TenantSettingsClient");n.sendAjax(f,"caller: getTenantSettings, file: TenantSettingsClient")},i.prototype.broadcast=function(t,r,u,f){i.isValid(t)&&(this.cachedTenantSettings=t,this.cachedUserInfo=r,this.cachedTenantConfig=this.convertToTenantConfig(t),this.broadcastImpl(f,u))},i.prototype.convertToTenantConfig=function(n){var t=n.tenantDisplayName,i=n.iconLarge,r=n.iconLargeChecksum,u=n.theme,f=n.adminEmail,e=n.themeColors;return{displayName:t,theme:u,iconLarge:i,iconLargeChecksum:r,adminEmail:f,themeColors:e}},i.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedTenantSettings&&sj_evt.fire("bfbTenantSettings",this.cachedTenantSettings,this.cachedUserInfo,i,t,n.getSucceededEventDetails(this.cachedTenantSettings,i,t));this.cachedTenantConfig&&sj_evt.fire("bfbtcfg",this.cachedTenantConfig);this.cachedUserInfo&&this.cachedUserInfo.displayName&&this.cachedUserInfo.userPrincipalName?sj_evt.fire("bfbTenantSettingsUserInfo"):this.isUserInfoRetried||(this.isUserInfoRetried=!0,sj_evt.bind("aad:signedin",function(){n.isTenantSettingsPrefetchStarted=!1;r.getTenantSettings()},!0))},i}();t.TenantSettingsClient=h})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i;(function(i){i.userConfigsAjaxBound=n.Service.Midgard.userConfigsAjaxBound;var r=function(){function r(t,r,u){var f=this,e;this.onAjaxLoad=function(){var t=n.context,r=t.tenantId,u=t.aadUserId,i=function(){(r!==(f.cachedUserConfigs&&f.cachedUserConfigs.tenant&&f.cachedUserConfigs.tenant.id)||u!==(f.cachedUserConfigs&&f.cachedUserConfigs.user&&f.cachedUserConfigs.user.id))&&(n.isUserConfigsPrefetchStarted=!1,f.loadUserConfigs());f.broadcastImpl()};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("onAjaxLoad",i,"UserConfigsClient"):i()};this.config=t;this.userConfigsApiUrl="".concat(t.apiUriBase).concat(t.userConfigsApiUri);this.cachedRequest=r;this.cvid=typeof _G!="undefined"?_G.IG:undefined;e=function(){i.userConfigsAjaxBound||(sj_evt.bind("ajax.load",f.onAjaxLoad,!0,null,!0),i.userConfigsAjaxBound=!0)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("UserConfigsClientCtr",e,u):e()}return r.prototype.loadUserConfigs=function(t){var i=this,r={onSuccess:function(t,r){t&&i.broadcast(t,r)},onError:function(t,i,r){sj_evt.fire("bfbUserConfigsFailed",t,i,r,n.getFailedEventDetails(t,i))}};sj_evt.fire("bfbUserConfigsStarted",n.getStartedEventDetails());this.getUserConfigs(r,t);n.isUserConfigsPrefetchStarted=!0},r.prototype.getUserConfigs=function(n,i){var r={},u;this.cvid!==undefined&&(r.cvid=this.cvid);u=t.addArgsToUrl(this.config,i||this.userConfigsApiUrl,r);t.sendPostRequest(u,this.cachedRequest,n,this.config.userConfigsTimeout)},r.prototype.broadcast=function(t,i){var u=this,r;this.cachedUserConfigs=t;r=function(){return u.broadcastImpl(!1,i)};(n.context===null||n.context===void 0?void 0:n.context.isErrorBoundaryEnabled)&&n.withErrorBoundary?n.withErrorBoundary("broadcast",r,"UserConfigsClient"):r()},r.prototype.getCachedUserConfigs=function(){return this.cachedUserConfigs},r.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedUserConfigs&&(sj_evt.fire("bfbUserConfigs",this.cachedUserConfigs,this.cachedRequest,i,t,n.getSucceededEventDetails(this.cachedUserConfigs,i,t)),this.cachedUserConfigs.userStatus&&n.whenWebTelemetryExists(function(){bfbTel.instUserStatus(r.cachedUserConfigs.userStatus)}))},r}();i.UserConfigsClient=r})(i=t.Midgard||(t.Midgard={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t="ms-search-popup",i=function(){function i(i,r){var u=this;(this.show=function(){if(!u.element.parentElement){var t=_ge("b_bfb");if(!t)return;t.appendChild(u.element);_d.body.removeEventListener("click",u.hideIfClickedElsewhere);_d.body.addEventListener("click",u.hideIfClickedElsewhere)}u.updatePosition();u.isBoundToPage||(u.isBoundToPage=!0,sj_be(_w,"resize",u.updatePosition));u.element.style.display="block"},this.hide=function(){u.element.style.display="none"},this.getElement=function(){return u.element},this.hideIfClickedElsewhere=function(t){var i=t.target;i===u.targetElement||n.hasAncestorElement(i,u.getElement())||n.hasAncestorElement(i,u.targetElement)||u.hide()},this.render=function(){u.element||(u.element=sj_ce("div"),u.element.className=t,u.element.style.display="none",u.element.appendChild(u.content))},this.updatePosition=function(){var t=u.element.parentElement.getBoundingClientRect(),n=u.targetElement.getBoundingClientRect(),i=t.right-n.right,r=n.top-t.top+n.height;u.element.style.right="".concat(i,"px");u.element.style.top="".concat(r,"px")},i&&r)&&(this.targetElement=i,this.content=r,this.render())}return i}();n.PopUp=i}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(t,i,r,u){var f=sj_ce("img",null,r);return i&&(f.src=i.iconLarge?"data:image/".concat(u?"svg+xml":"png",";base64,").concat(i.iconLarge):n.strFormat(t.logoUrlFmt,i.iconLargeChecksum),f.title=i.tenantDisplayName,f.setAttribute("aria-label",f.title)),f}function u(t,i,r){var u=sj_ce("a",null,t);return u.target="_self",u.href=i,u.setAttribute("role","button"),u.addEventListener("click",function(){r==!0?bfbTel.logClicked(n.EventScope.Gleam,!1,"UPSL","PGLM",{eventId:"Gleam_Click"}):bfbTel.logClicked(n.EventScope.Gleam,!1,null,"PGLM",{eventId:"Gleam_Click"})}),u}function f(t,i){var r=new n.PopUp(t,i);return t.addEventListener("click",r.show),r}function e(t,i,r){var f=sj_ce("div"),e=t.strings,s=t.learnMoreLinkUrl,o=sj_ce("p"),u;return o.innerText=n.strFormat(e.learnMoreTip,i.tenantDisplayName),f.appendChild(o),u=sj_ce("a"),u.href=s,u.target="_blank",u.innerText=e.learnMoreLinkLabel,u.addEventListener("click",function(n){r(n)}),f.appendChild(u),f}function o(t,i){var e=t.strings,o=t.dismissForDays,s=t.dismissForMaxDays,u=sj_ce("div"),f=sj_ce("button"),r;return f.innerText=n.strFormat(e.dismissForDays,o),f.addEventListener("click",function(){i(o)}),r=sj_ce("button"),r.innerText=e.dismissAlways,r.addEventListener("click",function(){i(s)}),u.appendChild(f),u.appendChild(r),u}function s(n){var t=document.createElementNS(i,"svg");return n&&t.setAttribute("class",n),t}function h(n,t){var r=document.createElementNS(i,"path");return r.setAttribute("d",n),t&&r.setAttribute("fill",t),r}function c(n,t,r,u,f,e,o){var s=document.createElementNS(i,"rect");return s.setAttribute("x",n),s.setAttribute("y",t),s.setAttribute("rx",r),s.setAttribute("width",u),s.setAttribute("height",f),s.setAttribute("fill",e),s.setAttribute("stroke",o),s}t.createTenantLogo=r;t.createSignInButton=u;t.createPopUp=f;t.createLearnMoreInfo=e;t.createDismissButtons=o;var i="http://www.w3.org/2000/svg";t.createSvg=s;t.createSvgPath=h;t.createSvgRect=c})(t=n.Midgard||(n.Midgard={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(r){if(!t.controller)if(r.length===3){var e=r[0],u=r[1],f=r[2];t.controller=new i(u,f)}else return;t.controller.start()}var i=function(){function t(t,i){var r=this;this.start=function(){r.mtCfg&&(r.tenantSettingsClient||(r.tenantSettingsClient=new n.Service.TenantSettingsClient(r.mtCfg,undefined,"caller: start, file: MsbContentOfflineController")),r.tenantSettingsClient.getTenantSettings({onSuccess:r.handleTenantSettingsReceived,onError:function(t){}}),sj_evt.bind("bfbTenantSettings",r.onReceiveTenantSettingsFromEvent,!0,null,!0))};this.onReceiveTenantSettingsFromEvent=function(n){r.handleTenantSettingsReceived(n)};this.handleTenantSettingsReceived=function(t){var i=t.tenantSettings;(sj_evt.unbind("bfbTenantSettings",r.onReceiveTenantSettingsFromEvent),n.Service.TenantSettingsClient.isValid(i))&&(r.tenantSettings=i)};this.mtCfg=t;this.tenantSettings=i;!t}return t}();t.MsbContentOfflineController=i;sj_evt.bind("bfbMsbContentOfflineExists",r,!0,null,!0);sj_evt.bind("ajax.load",r,!0,null,!0)})(t=n.MsbContentOffline||(n.MsbContentOffline={}))}(BingAtWork||(BingAtWork={}))